<title>Application of complex-step derivative method for k-eigenvalue sensitivity calculation in neutron transport models</title>
<author>1,ZeyunWu,2,James C.NewmanIII</author>
<Affiliation>1,Department of Mechanical and Nuclear Engineering, Virginia Commonwealth University, Richmond, VA 23284, United States;2,Department of Mechanical Engineering, University of Tennessee Chattanooga, Chattanooga, TN 37403, United States</Affiliation>
<year>2020</year>
<Jounral>Annals of Nuclear Energy</Journal>
<Publishing_house>ELSEVIER</Publishing_house>
<Text_Collector>XiaFan，HEU</Text_Collector>
<DOI>10.1016/j.anucene.2020.107975</DOI>
<URL>https://www.sciencedirect.com/science/article/pii/S030645492030671</URL>
Application of complex-step derivative method for k-eigenvalue sensitivity calculation in neutron transport models
ZeyunWu,James C.NewmanIII
Department of Mechanical and Nuclear Engineering, Virginia Commonwealth University, Richmond, VA 23284, United States
Department of Mechanical Engineering, University of Tennessee Chattanooga, Chattanooga, TN 37403, United States
<Section>Highlights</Section>
Solve the complex variable multigroup discrete ordinates transport equation.
Apply the complex-step derivative method for k-eigenvalue sensitivity calculations.
Demonstrate the method with one-group and multigroup neutron transport problems.
<Section>Abstract</Section>
This paper paves the way to numerically solve the k-eigenvalue neutron transport equation with complex variable arguments, and then employs the developed complex variable transport solver to calculate the k-eigenvalue sensitivities with respect to nuclear cross sections using the complex-step derivative method (CDM). CDM utilizes the Taylor series expansion in the complex plane whereby the imaginary component of the complex solution space can be directly used to represent the sensitivity derivative. CDM offers a robust numerical avenue to calculate accurate sensitivities not susceptible to subtractive cancellation errors. Numerical examples with one-dimensional k-eigenvalue neutron transport models in both one-group and multigroup formulations were employed to demonstrate the feasibility of CDM in reactor problems. The CDM sensitivity results received good agreements to the reference solutions from the conventional forward-based and adjoint-based sensitivity methods. These preliminary results confirmed the viability and accuracy of CDM for k-eigenvalue sensitivity calculation in neutron transport models.
Keywords：Sensitivity analysis;Complex-step derivative method;K-eigenvalue transport problem
<Section>1. Introduction</Section>
Sensitivity analysis investigates the variation of the system responses to the changes of the system parameters. The sensitivity of k-eigenvalue with respect to nuclear data (i.e., nuclear cross sections) has been of interest to researchers in nuclear reactor physics community for decades. Many methods in this regard have been developed (McClarren, 2018, Stacey, 2007, Cacuci, 2003, Saltelli, 2004, Williams, 1986, Gandini, 1967). These sensitivity methods can be simply summarized into two categories. One is the forward-based sensitivity method, which approximates the sensitivity into a finite difference formulation and has limited order of accuracy (McClarren, 2018, Stacey, 2007, Cacuci, 2003). Partly due to this reason, the forward-based sensitivity calculation approaches typically restrict the permissible perturbation range of the sensitivity parameter, and thereby are subject to significant variability between responses of interest and selected parameters. Another sensitivity method is the adjoint-based sensitivity method, which generally utilizes the adjoint solution to form the sensitivity based on the first order perturbation theory (Cacuci, 2003, Saltelli, 2004, Williams, 1986, Gandini, 1967). The adjoint-based sensitivity method can offer accurate solutions for sensitivities, but it possesses a completely different computational paradigm as the forward-based method and requires additional calculations of the adjoint solution that is response dependent.
The paper presents a different method to obtain accurate sensitivities of the k-eigenvalue in neutron transport problems based on the complex variable Taylor series expansion. The complex variable method for the computation of sensitivity derivatives was pioneered by Newman in aerodynamic, structural, and aero-structural analyses (Newman et al., 1998), and later revisited in the literature by numerous researchers in many other fields (De Pauw and Vanrolleghem, 2006). For clarification, the term sensitivity derivative used herein through the paper means the derivative needed to represent the sensitivity information. In the current work, the complex variable method is applied to the k-eigenvlaue neutron transport model to calculate the k-eigenvalue sensitivities with respect to nuclear cross sections. The feasibility and accuracy of the complex variable method for calculation of k-eigenvalue sensitivities are justified by comparing the results to the forward-based finite difference approximations as well as reference solutions from an existing sensitivity analysis tool developed by the adjoint-based sensitivity method.
This paper first paves the way to numerically solve the complex variable neutron transport equation. The traditional neutron transport solver must be extended to handle the complex inputs and outputs in order to enable the complex variable based sensitivity calculations in neutron transport problems. The standard computational methods for neutron transport problems employed a sophisticated nested iteration paradigm to solve the neutron transport equation (which is the primary mathematical model for nuclear reactor calculation) because of the inherent complexity of the equation (Lewis and Miller, 1984). It is likely owing to this sophisticated iteration procedure, existing neutron transport solvers cannot generate correct complex solutions if they are blindly loaded with complex inputs. To overcome this difficulty and to obtain correct complex answers for sensitivity calculations, mathematical derivations and computational treatments have been exercised in this paper to make the transport solver capable of handling the complex variable conditions. With the complex solutions of the transport problems available, the way to calculate the sensitivity of k-eigenvalue is articulated afterwards.
In the current work, a Matlab code was developed to solve the one-dimensional multigroup discrete ordinates k-eigenvalue transport equation with complex variable arguments. The code was then adopted to compute the k-eigenvalue sensitivities with respect to nuclear cross section by the complex variable bases sensitivity method. Numerical examples with respective one energy group and multigroup conditions were tested with the developed code to confirm the successful implementation of the complex variable method as well as the feasibility of the proposed method for sensitivity calculations. A preliminary version of this paper has been previously presented in the recent American Nuclear Society (ANS) Mathematics and Computation (M&C) topical conference (Wu et al., 2019). However, substantial extensions have been exercised since then. In particular, the method has been extended to the multigroup case with more numerical examples and results included in this paper.
The rest of the paper is organized as follows: A generic background introduction of sensitivity analysis and complex variable method is outlined in Section 2, followed by Section 3 with a detailed description of mathematical derivations and numerical implementations of the complex variable method to the k-eigenvalue neutron transport models. The one-dimensional multigroup discrete-ordinates transport code was developed based materials in Section 3. Computational examples encompassing one-group and multigroup transport case problems are respectively demonstrated in Section 4, with numerical results presented and discussed to verify the feasibility and accuracy of the complex variable method. Conclusions and future research efforts related to the current work are provided at the end of the paper.
<Section>2. Sensitivity analysis and complex-step derivative method<Section>
2.1. Sensitivity analysis
In general, any function of interest may be expressed in a functional form as @. Here the function is assumed to have explicit as well as implicit dependencies on the system parameter x. For the implicit dependency, the functional form of Q(x) typically is not known and usually represents the solution to a disciplinary state equation. Hence, Q is often referred to as the state vector. In reactor calculations, for example, the effective multiplication factor (i.e., the k-eigenvalue) can be taken as the general function f, the nuclear data (i.e., cross sections) are the parameter x, and the neutron flux is akin to the implicit state vector Q(x).
The sensitivity derivatives of the general function may be obtained by a direct differentiation to the implicit and explicit dependencies as
@(1)
The approach to sensitivity analysis based on Eq. (1) is normally referred to as the forward-based sensitivity analysis method. As can be seen from the equation, the forward-based sensitive analysis method needs to calculate the sensitivities of the state vector, namely , in order to compute the sensitivity derivatives of the general function.
Depending on the number of functions of interest that is desired and the number of parameters or independent variables in which sensitivity information is required, a more efficient alternative approach can be formulated. This method is usually referred to as the adjoint-based sensitivity analysis method (McClarren, 2018, Stacey, 2007), and may be written as
@(2)
where @ is the adjoint vector defined in such a way as to eliminate the dependence of the functions on the sensitivity of the state vector, R represents the disciplinary state equation that will be discussed below,
In the forward-based sensitivity method, the sensitivity of the state vector@is required, and for the adjoint-based sensitivity method, the adjoint vector@is needed. To obtain these required vectors, the state equation can be generally defined as a residual vector R symbolically written as
@(3)
where the explicit and implicit dependencies of the residual on the state vector Q and the system parameter x are asserted. In the forward-based sensitivity method, Eq.(3) is directly differentiated with respect to the independent variables (i.e., the parameter x) to produce the following linear equation
@(4)
or rearranged as
@(5)
where @ is the Jacobian matrix evaluated with the state vector given the current value of the parameters of interest. The required sensitivity of state vector@can thus be calculated from Eq. (5).
In the adjoint-based sensitivity method, a little bit more manipulation is needed to obtain the required adjoint vectors ,which is response dependent. Combining Eq. (4) from the direct differentiation method with the sensitivity derivatives in Eq. (1), the adjoint vector@may be conveniently defined such that the sensitivity of the state vector@is no longer needed. Nevertheless, the end result requires the solution of the following linear system for the adjoint vector
(6)
Eq. (6) is known as the adjoint equation to the state equation Eq. (3), and the source term in the right side of the equation contains the response information. This is the reason that the adjoint-based sensitivity method is known to be response dependent. In Section 4, the results of complex variable method for the second example were compared to adjoint-based sensitivity solutions obtained from an existing sensitivity analysis tool to verify the accuracy of the complex variable method. It should be pointed out here that the complex variable method introduced in this paper is essentially a forward-based sensitivity approach, therefore a thorough discussion of the complex variable method over the adjoint-based sensitivity approach will not be offered in the current paper, but rather be deferred in our future research endeavors.
2.2. Complex-step derivative method
As can be seen from the discussion above, the main computation effort required in the forward-based sensitivity calculation are the estimations of the derivatives of the response to the parameters of sensitivity analysis interest. For illustration, we assume@is a general response function of the investigator’s interest with a single input parameter x. Calculating the sensitivity of with respect to a variable x is essentially to compute the derivative of@at a certain nominal value of x. This task may appear to be simple at the first glance. However, for a realistic engineering problem, the task of constructing the derivative using either the forward-based or the adjoint-based sensitivity method, and then building the software for evaluating these terms can be tedious.
One solution to this problem has been found in the use of a technique known as automatic differentiation (AD), which determines the derivative of a response to a parameter by applying the chain rules of derivatives at each step in the source code that produces the numerical results (McClarren, 2018). Using AD method, a FOTRAN language based pre-compiler software tool, called ADIFOR (Bischof et al., 1992), has been developed and utilized with much success to obtain complicated derivatives from advanced simulation and grid generation codes (Green et al., 1996, Taylor et al., 1997). The AD approach requires differentiation of the simulation software, either by hand or with a pre-compiler software. Besides AD, all other methods to obtain sensitivity derivatives are based on numerical techniques, which is the topic focused in this paper. The simplest numerical technique in this regard is the direct forward perturbation based forward finite difference method (FFDM), which is straightforward and well accepted as outlined in Section 2.1. Another alternative forward based numerical technique is a complex variable based approach evaluating the derivatives of real functions with explicit and implicit dependencies on the independent variable. This technique, referred to herein as the complex-step derivative method (CDM), has been given various names in the literature, such as the Complex Taylor Series Expansion method among others (Newman et al., July 1998, Newman et al., (May-June 2003)., Burg and Newman, March 2003, Anderson et al., 2001). The CDM was demonstrated via the computation of aerodynamic, structural, and multidisciplinary sensitivity derivatives with respect to independent variables appropriate for aerodynamic and structural design optimizations (Newman et al., (May-June 2003)., Burg and Newman, March 2003), as well as turbulent flow problems (Anderson et al., 2001). Furthermore, CDM is commonly used for linearization and Jacobian evaluation in implicit schemes that involve complicated flux functions. As a testament to the ease of implementation, and accuracy of the approach, this method has been widely adopted and exploited by many researchers at various universities and government laboratories. A complete list of references is extensive and prohibitive to include within this paper. For demonstration and comparison, the finite difference based direct perturbation method and complex variable based step derivative method noted above are further discussed below.
The finite difference approximation to the derivative with a desired truncation error can be obtained using the Taylor series expansion approach. For example, the derivative with the first order approximation can be estimated with a FFDM scheme as follows
@(7)
which apparently shows the first order accuracy – it has a truncation error of . To achieve the second order accurate approximation to the derivative, the forward and backward finite difference approximations may be combined to have the central finite difference method (CFDM) scheme to the derivative as follows
@(8)
which indicates the derivative has a truncation error of , the second order of accurate with respect to the parameter change.
Using the Taylor series expansion based finite difference approximation to obtain sensitivity derivatives is advantageous because it can be readily applied to any existing code with nearly no modification to the code. On the other hand, the disadvantages of the conventional FFDM method are well recognized. First, the computational time required may become prohibitive when the number of input parameters of interest become large. For the FFDM with the first order accuracy, as shown in Eq. (7), N + 1 evaluations are needed for a problem with N parameters. It is worthy of noting the number of calculations estimated above does not include the trial and error tests that are normally needed for choosing the appropriate perturbation step size in these methods. Second, the choice of step size always causes inaccuracies in the FFDM type derivative. Because of this, a smaller step size is usually desired in FFDM schemes. However, significant subtractive cancellation errors will be produced and contaminate the difference of the two evaluations if a tiny step size is used in the FFDM scheme. Thus, additional computational efforts are mostly needed to identify an optimal step size in FFDM type sensitivity calculation.
The CDM scheme mentioned earlier can overcome the disadvantages inherently associated with conventional forward-based sensitivity calculations. The CDM scheme also takes the advantages of Taylor series expansion for the evaluation of derivatives. However, rather than expanding the function in the real variable domain as that of the conventional FFDM, the CDM expands the function of interest in a Taylor series formulation in the complex variable domain as follows
@(9)
where , and the imaginary component of the complex variable is purposely set as the perturbation step size. Focusing on the imaginary part of Eq. (9) and solving for the first derivative from the equation, we get
@(10)
where the terms with higher order errors are omitted. Eq. (10) essentially defines the CDM scheme to evaluate the first order derivative of the function with respect to the parameter x. As can be clearly seen in Eq. (10), the CDM estimation of the derivative has a truncation error of , and the CDM scheme has no subtractive terms as those in FFDM or CFDM, thus the cancellation errors are precluded. Because of this feature, CDM is not sensitive to step size selection and only requires step size to avoid excessive truncation error, which is advantageous to the conventional finite difference schemes.
Many additional numerical advantages can be realized by CDM. First, CDM falls into the category of the forward-based sensitiviy analysis for the derivative evaluations, therefore it may require very minor modification when applying the method to an existing software. Many salient features and capabilities of the original software can be retained, which is way superior to hand differentiation or AD based sensitivity analysis approaches. Second, CDM is equivalent to the hand differentiation or AD approaches in the regard of state vector or state equation, in which the state vector and its derivatives are being solved for simultaneously. With this feature, the fully converged evaluations of the state equation, which is generally required by the conventional FFDM schemes, are avoided in order to obtain the sufficient accuracy of derivatives for analysis. Third, CDM is a numerical scheme that is ideally suited for parallel computing because each complex perturbation is independent. This feature becomes paramount important when the method is applied to practical engineering problems with large size of input parameters of interest. Last, it is worthy of mentioning the CDM is not a new method and has been invented for a long time. The CDM is originated from the ideas of Lyness and Moler (Newman et al., July 1998, Lyness and Moler, 1967), who explored these methods to demonstrate the use of complex-variables to extract derivatives from simple explicit functions over five decades ago, and many work has previously shown that CDM indeed demonstrates true second order accuracy (Newman et al., July 1998, Newman et al., (May-June 2003)., Burg and Newman, March 2003, Anderson et al., 2001).
Furthermore, the CDM technique [see Eq. (9)] can be readily extended to calculate the second- order derivatives using available data with nearly no additional computational cost as follows:
@(11)
which apparently has the second order truncation error as the CDM-based first order derivative. However, as indicated by Eq. (11), the approximation to the second-order derivative is still subject to subtractive cancellation, thus the perturbed step size must be chosen with cautious for the second-order derivative calculations. The features of the second-order derivative evaluations using CDM in the application of reactor problems will not be pursued in this paper but will be explored in our future endeavors.
The aforementioned salient features of the CDM in estimating first order derivatives than the forward-based finite difference methods can be demonstrated with a simple analytic example as follows. The partial derivatives of the two variable function@at a certain point can be analytically evaluated with no errors. The partials can also be numerically generated by FFDM and CDM, respectively. Fig. 1 illustrates the partial results ( and ) at the point (x = 3, y = 1.5) generated by these methods. As a reference solution, the exact partial derivatives at the point are also shown in the figure.
Fig. 1. The partial derivatives of@at x@= 3, y = 1.5.
As shown in Fig. 1, when the perturbed step size becomes large, the results yielded from the FFDM deviate from the exact solution when the perturbation, whereas results from the CDM agree well with the exact solution. This phenomena indicates the truncation error associated with the FFDM dominates when the step size becomes large, but it does not affect the CDM results because those two methods have the second order of accuracy with respect to the perturbed parameters. On the other hand, when the perturbed step size becomes small, the FFDM result deviates because the subtractive cancellation errors pollute the derivative approximation. In contrast, the CDM results are not subjected to subtractive cancellations errors.
It should be noted that this simple analytic example is based on a benign two variable explicit function. As such, the perturbation range over which the finite difference method also gives acceptable results for both variables is substantial. This case is not a typical one, particularly when implicit dependencies that require the iterative solution to nonlinear state equations are required for the function evaluations. In those cases, there may only exist a very small perturbation range for finite difference method to produce an acceptable derivative approximation, and this range could be different for each function of interest and parameter combination. On the other hand, the CDM method, as described above and found in the cited literature, has been demonstrated not to suffer from these drawbacks and is step size independent, regardless of function or parameter selection.
<Section>3. Application to k-Eigenvalue transport problems</Section>
This section outlines the mathematical derivations needed for applying the CDM to the k-eigenvalue neutron transport problems. It also provides some numerical implementation details of the method to generate the k-eigenvalue sensitives. For illustration, the derivation starts with a simple one energy group formulation of the transport equation, and then extends it to the multiple energy group case. The focus of the derivation is given to the k-eigenvalue mode transport equation as the primary objective of the current work is to use CDM to calculate the sensitivity of k-eigenvalue with respect to nuclear data (i.e., cross sections).
3.1. One-group case
With standard notations, the one-group one-dimensional (1-D) k-eigenvalue neutron transport problem with the isotropic scattering source and uniform materials may be described by the following equation
@(12)
Defining the fission source
@(13)
Eq. (12) is reduced to
@(14)
In the FFDM-based sensitivity calculation, the transport forward model [Eq. (14)] is first used to compute the reference k-eigenvalue, denoted as@thereafter. Then the sensitivity parameter of interest, the fission cross section for example, is perturbed with a small scale such as , where h is the relative value of the perturbation or viewed as a scaling factor of the perturbation, namely .
The perturbed k-eigenvalue, denoted as@thereafter, can be computed by running the transport forward model one more time with the perturbed cross section. The FFDM-based k-eigenvalue sensitivity coefficient is then approximated as follows
@(15)
To enable the CDM-based sensitivity calculation for k-eigenvalue using the transport model, the transport equation needs to be re-casted by considering the following quantities consisting of both real (subscript r) and imaginary (subscript i) components of the solution space:
@(16)
It is worthy of noting here that since only the imaginary component of the perturbed parameter will later be used in the calculation of the CDM-based derivatives, as indicated in Eqs. (9), (10), in the practice of CDM, the imaginary component of the perturbed parameter will be purposely defined as a fraction of the real component to ease the calculation. This practical trick will be more clearly demonstrated in Eq. (23) later.
Substituting Eq. (16) into Eq. (14) yields the complex variable transport equation as
@(17)
Following a similar definition as Eq. (13), the fission source now can be expressed as
@(18)
Thus we get
@(19a)
@(19b)
The last term on the right hand side of Eq. (17) can be further arranged as follows
@(20)
By equating the real and imaginary components on both sides of Eq. (17), we obtain the following two coupled transport equations for real and imaginary flux solution , respectively
@(21a)
@(21b)
where
@(22a)
@(22b)
With the calculation of the imaginary component of the k-eigenvalue (i.e., ), the CDM-based k-eigenvalue sensitivity coefficient can be estimated as follows (use fission cross section as an example sensitivity parameter)
@(23)
where@is the user defined imaginary component of the perturbed fission cross section for the complex solution calculation, and thus here we have . Note the definition of h in Eq. (23) is different from the one shown in Eq. (15).
As indicated in Eq. (23), the CDM-based sensitivity calculation requires to know the reference as well as the imaginary component of the k-eigenvalue solution. Since the imaginary solution essentially requires to perform forward transport calculation twice to resolve the flux coupling mechanism indicated in Eq. (21), the total computational cost for CDM is really 2 N + 1 forward transport calculations for the case of N parameters, which is actually the same as the CFDM described in Section 2.2. However, if only the derivative information (rather than the sensitivity coefficient) is needed, the forward transport calculation for the reference solution can be skipped in the CDM procedure because the reference solution may not need for the derivative calculation as indicated in Eq. (10) and Eq. (23). Similar situation is encountered in the CFDM approach. In this regard, the CDM requires exactly the same computational burden as the CFDM, however other benefits such as accurate second-order derivative calculations can be achieved in CDM without additional computational cost, which will be demonstrated with our future research endeavors.
3.2. Multigroup case
Most of the derivations for the one-group case described in Section 3.1 can be straightforwardly extended to apply the CDM to a multigroup (MG) case, However, some additional care needs to paid to the in-between energy group in-scattering source term appeared in the MG formulation of the transport equation.
With standard notations, the k-eigenvalue mode MG transport equation for the 1-D slab geometry considering only isotropic scattering considered may be given as
@(24)
where the subscript g stands for the group number,@is fission spectrum in the energy group g.
Compared to the one-group formulation in Eq. (12), the streaming term , total collision term , within-group in-scattering term , and fission term@remain no significant changes except they are all tagged with a specific group number, besides the fission term is constructed with a summation sign that accounts for fission contributions from all energy groups, therefore these terms can be naturally extended to the complex variable version following the derivation procedure for the one-group equation outlined in Section 3.1.
For the in-between group in-scattering source term , however, some special treatments have to be executed to properly account for the scattering contributions from both real and imaginary flux. Denote the in-scattering source for group g from the other group g’ as
@(25)
In the case of the complex variable, this source will be expanded as
@(26)
where
@(27a)
@(27b)
With these considerations, the original MG equation [Eq. (24)] can be casted into the following two coupled MG transport equations for the real portion and imaginary flux, respectively
@(28a)
@(28b)
where the in-between group in-scattering sources are defined as follows
@(29a)
@(29b)
and the sources ,@appeared in the fission terms are defined exactly identical as those in Eq. (22), but the fission sources ,@included in the definitions will bear some differences from those in Eq. (19) because here they need to account for all energy group contributions in the MG case. The new formulations for@and@are
@(30a)
@(30b)
3.3. More details in numerical implementation
A couple of numerical implementation details are worthy to be offered when applying standard computational neutron transport methods (Lewis and Miller, 1984) to solve the coupled transport equations yielded from the complex variable transport model shown in Eq. (21). The first one is pertaining to the source iteration technique in the flux solver. After the discretization of these two coupled equations, the real and imaginary component of the flux can be solved simultaneously by an direct inversion of a local matrix within the source iteration framework, which will save some computational cost. Another caveat for the CDM implementation is on the k-eigenvalue update scheme in the power iteration framework. The fission contributions from both the real and imaginary flux component need to be taken into account when updating the complex k-eigenvalue for the next iteration.
Following the standard source iteration framework with the discrete ordinates method to handle the angular variable, Eq. (21) may be re-written as (for simplicity, the subscript for the angular direction is omitted from the angular flux notation)
@(31a)
@(31b)
where and can be considered as known sources in a given source iteration step. Note that many spatial discretization methods (Lewis and Miller, 1984) can be applied to solve Eq. (31) numerically. Herein the classic diamond difference (DD) method is used for illustration.
With a standard discretized mesh setting in 1-D slab geometry, Eq. (31) can be expressed in a spatial discretized form as follows
@(32a)
@(32b)
where the subscript j denotes the mesh number,@are mesh-edge flux, and@is mesh-center flux. Without loss of generality, only the transport scheme for the@> 0 case is shown here.
The DD method states
@(33a)
@(33b)
Substituting Eq. (33) into Eq. (32) yields
@(34a)
@(34b)
During the transport sweep, the incoming angular fluxes (i.e.,@and ) are known, thus Eqs. (34a), (34b) can work conjunctionally to solve for the real and imaginary portion of the angular flux (i.e., and ) simultaneously. A direct two by two matrix inversion technique can be used here to solve for the unknowns.
Standard power iteration algorithm can be applied to solve for the k-eigenvalue of the complex variable transport equation, however, the eigenvalue updating scheme inside each iteration should be revised to take into account of the fission contributions from both the real and the imaginary flux components. Denoting n as the current power iteration number, the complex k-eigenvalue for the next iteration can be updated as (after the flux for the next iteration was calculated):
@(35)
where is the k-eigenvalue in the current iteration. For simplicity, Eq. (35) is expressed based on the one-group case only.
<Section>4. Numerical experiments</Section>
Based on the mathematics derivations and numerical schemes outlined in Section 3, A Matlab code was developed to solve the one-dimensional multigroup discrete ordinates k-eigenvalue neutron transport equation with complex variable arguments. The code was then employed to demonstrate the capability of calculating k-eigenvalue sensitivities with respect to nuclear cross section using the CDM. Two numerical experiments, focusing on one-group and multigroup cases respectively, were conducted in this section to verify the success implementation of the CDM and confirm the accuracy of CDM in calculating the k-eigenvalue sensitivities.
4.1. One-group example
For a demonstration of the CDM application to the one-group case, a three-region 1-D slab geometry reactor is used as the test example. The thickness of Region 1 through Region 3 are 4 cm, 8 cm, and 4 cm, respectively. Vacuum boundary is imposed on the left side of the slab and reflective boundary on the right. In the current CDM practice, the boundary conditions for the imaginary flux are assumed to be identical to those for the real flux. Table 1 summarized the geometric and material properties of the one-group k-eigenvalue problem.
Table 1. Geometric and Material Properties of the One-group Test Problem.
The one-group 1-D slab geometry transport equation was numerically solved using the standard discrete-ordinates method (i.e., SN) for angular discretization and standard DD method for the spatial discretization. For this oversimplified example, no negative flux is observed, and thus no zero flux fixed approach is applied in the code. In order to sufficiently reduce the numerical truncation errors due to both angular and spatial discretizations in the calculations, S8 Gauss-Legendre quadrature set was used for the angular variable and a uniform small mesh size of 0.2 cm was used for the spatial variable. Source iteration method is performed to obtain the converged the flux and power iteration method is operated for seek the converged k-eigenvalue. Adequately tight iteration convergence criteria (1E−6 for the flux and 1E−16 for the k-eigenvalue) are used to minimize the iteration errors. The calculated k-eigenvalue for the one-group example problem is 1.38525.
Following the methodologies described in Section 3, the derivatives of k-eigenvalue with respect to the material cross sections in Region 2 for FFDM and CDM were calculated and compared in Fig. 2. Note the cross sections are perturbed with different percentage amount from 10% to ~0.0003% for both methods. For the case of total cross section perturbations, we treated the total cross section as an independent parameter and kept all other cross sections intact during the perturbations. As seen in Fig. 2, the k-eigenvalue sensitivity derivatives exhibit a similar behavior pattern as that shown in Fig. 1 for the simple analytic function case. The advantageous features of the CDM are clearly verified by these results. For the derivative either to the fission cross section or the total cross section, the FFDM result can reach the correct solution when the perturbation step size is less than 0.1%, whereas the CDM result can go beyond the small perturbation limit remarkably, the correct derivative can be produced even for the case with the perturbation step size goes over 5%.
Fig. 2. The comparison of k-eigenvalue derivative with respect to the fission cross section (left) and total cross section (right) with the FFDM and CDM.
4.2. Multigroup example
For the MG case, the 1-D slab problem from Cho and Park’s technical report (Cho and Park, 2003) was adopted as an example to test the CDM-based sensitivity calculations. This problem is composed of two regions (fuel region and reflector region) with seven energy group cross sections for both materials. Each region has a thickness of 10 cm. The cross section data of the materials are given in Table 2 and the scattering matrices of fuel and reflector are given in Tables 3 and 4, respectively. Please note there were a couple of typos identified in the nuclear data provided in the Cho and Park’s original report published in 2003. These typos are corrected after email communications with the authors of the report. The cross section data used in this paper are the corrected ones.
Table 2. Cross Sections for MG k-Eigenvalue Problem.
Table 3. Scattering Matrix for Fuel Region.
Table 4. Scattering Matrix for Reflector Region.
Table 5. Sensitivity Coefficients Produced by FFDM and CDM.
Reference solution was obtained from the adjoint-based sensitivity tool SENSMG (Favorite, 2018).
To better demonstrate the advantages of the CDM over the conventional FFDM, Fig. 3 depicts the energy group dependent sensitivity coefficients of the k-eigenvalue with respect to the total cross section of the fuel with different level of cross section perturbations in both FFDM and CDM: 0.5%, 1.0%, and 5.0% variations of the nominal values.
Fig. 3. Comparison of the Group-wise k-eigenvalue sensitivity coefficients to the fuel total cross sections by FFDM and CDM.
The advantages of the CDM sensitivity solutions can be better explained with the results shown in Fig. 3. When the perturbation scale is limited in a very small range like 0.5%, both FFDM and CDM can both produce acceptable sensitivity solutions in a similar level of accuracy, particularly for those groups who are not sensitivity to the k-eigenvalue (in this case they are group 1, 4, and 5). However for the cases with larger perturbation, and particularly for those groups who have large sensitivities (in this example they are group 2 and 7), the FFDM solution diverges rapidly from the correct answers while CDM stays robustly with the right solutions in an acceptable range. These features can be better demonstrated in Fig. 4, in which the errors in the sensitivity coefficients estimated with larger perturbations are explicitly presented. Here we used the sensitivity solutions obtained with 0.1% perturbations in center finite difference method as the reference solutions to estimate the errors.
Fig. 4. The errors existing in sensitivity coefficients evaluated by FFDM and CDM with different levels of perturbations.
<Section>5. Conclusions and future work</Section>
In this paper, the complex variable version one-dimensional MG SN k-eigenvalue neutron transport code was developed. This code is utilized as the forward transport solver for the application of CDM sensitivity analysis. The CDM utilizes the Taylor series expansion in the complex plane whereby the imaginary component of the complex solution space is used to represent the sensitivity derivative information. The CDM is applied to k-eigenvalue neutron transport models to calculate the k-eigenvalue sensitivities with respect to the nuclear cross sections. The success implementation of the complex variable neutron transport model and the feasibility of the CDM in calculating k-eigenvalue sensitivities in transport problems are verified by one-group and multigroup case problems. The accuracy of the CDM sensitivity results is confirmed by comparing to the conventional FFDM solutions, as well as adjoint-based sensitivity solutions provided by SENSMG (Favorite, 2018). It is noteworthy to point out the research work carried out in the paper are only preliminary, the CDM sensitivity analysis in neutron transport and nuclear reactor applications requires many further investigations.
The level of accuracy and computational cost of the CDM solution are merely compared to the FFDM performance in neutron transport applications as demonstrated by the case problems in the paper. Although being attempted to have a brief discussion, the advantages of CDM over CFDM (i.e., the center finite difference method) in terms of accuracy and computational efforts on sensitivity analysis are not apparent at this moment, and thus further justifications are needed in this regard. However, some unique features exhibited by the CDM method, including its invulnerability to the subtraction cancellation errors that are inherently associated with conventional finite difference methods, make the CDM a promising approach for sensitivity calculations. Moreover, the CDM can calculate the second-order sensitivity derivatives with nearly no additional computational cost. This feature is clearly demonstrated by Eq. (11) as the real component of the response function is readily available after the governing equation is solved with complex variables. The CDM on second and higher order derivative evaluations will be pursued in our future research.
With the current demonstration, it may seem that the CDM does not have significant advantages over the adjoint-based sensitivity method, which is more commonly used in nuclear community. The primary benefit of the adjoint method in sensitivity calculation is that it can generate sensitivities for a given response for any number of parameters without additional forward transport solutions. Forward-based methods like CDM have the number of calculations scaled linearly with the number of parameters. This is the benefit of the adjoint-based method that cannot be matched by the CDM. However, on the other side of the story, the adjoint-based method is notoriously difficult and expensive when applied to time-dependent and nonlinear problems (e.g., neutronics calculations including temperature feedback). In addition, the adjoint-based method becomes cumbersome and computational inefficient for problems with a large number of responses of interest, because the adjoint solution associated with each response is different and needs to be calculated individually by solving the corresponding adjoint equation. In other words, the adjoint-based method is a response specific method. The forward-based methods like CDM presented in this paper can, however, be readily extended to these cases and overcome the shortcomings emerged in the adjoint-based method.
Many topics can be explored with respect to future efforts on the CDM applications in k-eigenvalue sensitivity calculation. In the current work, the CDM results are only compared to the forward-based sensitivities (i.e., the finite difference formulation under a direct perturbation). More comparisons can be further made to verify the benefits that can be achieved by CDM over the perturbation theory based adjoint sensitivities. In that regard, the CDM itself can be formulated in an adjoint framework to compete with conventional adjoint sensitivity analysis, as well as handling nonlinear effects in the sensitivities. As far as more realistic applications concerned, the current transport model can be readily extended to multi-dimensional problems with anisotropic scattering conditions, as well as time-dependent problems. Moreover, the advantages of the CDM in evaluating the second and even higher order sensitivity derivatives can be pursued in the reactor physics applications where higher order sensitivities are sometimes desired.
<Section>CRediT authorship contribution statement</Section>
Zeyun Wu: Conceptualization, Data curation, Formal analysis, Investigation, Methodology, Validation, Writing - original draft. James Newman: Resources, Writing - review & editing.
<Section>Declaration of Competing Interest</Section>
The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.
<Section>Acknowledgement</Section>
The authors are grateful to Arthur C. Taylor at Old Dominion University for initiating fruitful discussions on complex variable method. The authors are also grateful to Dr. Nam Zin Cho at Korea Advanced Institute of Science and Technology for providing updated nuclear cross section data for the MG test problem. The first author thanks Dr. Jeff Favorite at Los Alamos National Laboratory for providing SENSMG results and Mr. Tao Liu at Virginia Commonwealth University for the assistance in the multigroup case development.
<Section>Appendix A. Supplementary data</Section>
The following are the Supplementary data to this article:
Download : Download XML file (312B)
Supplementary data 1.
<Section>Research data for this article</Section>
Data not available / Data will be made available on request
About research data
<Section>References</Section>
McClarren, 2018
R.G. McClarren
Uncertainty Quantification and Predictive Computational Science: A Foundation for Physical Scientists and Engineers
Springer (2018), 10.1007/978-3-319-99525-0
Google Scholar
Stacey, 2007
Stacey, W., 2007. Nuclear Reactor Physics, Wiley, Weinheim. https://doi.org/10.1002/9783527611041
Google Scholar
Cacuci, 2003
D.G. Cacuci
Sensitivity and Uncertainty Analysis – Theory, vol. I
Chapman & Hall/CRC (2003), 10.1201/9780203498798
Google Scholar
Saltelli, 2004
A. Saltelli
Sensitivity Analysis in Practice: A Guide to Assessing Scientific Models
John Wiley & Sons (2004)
Google Scholar
Williams, 1986
M. Williams
Handbook of Nuclear Reactor Calculations—Perturbation Theory for Nuclear Reactor Analysis
CRC Press, III (1986)
Google Scholar
Gandini, 1967
A. Gandini
A Generalized Perturbation Method for Bi-Linear Functionals of the Real and Adjoint Neutron Fluxes
J. Nucl. Eng., 21 (1967), p. 755, 10.1016/0022-3107(67)90086-X
ArticleDownload PDFView Record in ScopusGoogle Scholar
Newman et al., July 1998
J.C. Newman III, W.K. Anderson, D.L. Whitfield
Multidisciplinary Sensitivity Derivatives Using Complex Variables
Mississippi State University Report MSSU-COE-ERC-98-08 (1998)
Google Scholar
De Pauw and Vanrolleghem, July 2006
De Pauw, D.J.W., Vanrolleghem, P.A., 2006. Avoiding the Finite difference sensitivity analysis deathtrap by using the complex-step derivative approximation technique. In: the 3rd International Congress on Environmental Modelling and Software, Burlington, Vermont, U.S. (July 2006).
Google Scholar
Lewis and Miller, 1984
E.E. Lewis, W.F. Miller Jr.
Computational Methods of Neutron Transport
John Wiley & Sons (1984)
Google Scholar
Wu et al., 2019
Z. Wu, J.C. Newman III, A.C. Taylor III
Higher order accurate k-eigenvalue sensitivity estimation using the complex-step derivative method
the International Conference on Mathematics and Computation Methods applied to Nuclear Science and Engineering (M&C 2019) (2019)
Google Scholar
Bischof et al., 1992
C. Bischof, A. Carle, G. Corliss, A. Grienwank, P. Hovland
ADIFOR: Generating derivative codes from Fortran programs
Sci. Programm., 1 (1) (1992), pp. 11-29, 10.1155/1992/717832
CrossRefView Record in ScopusGoogle Scholar
Green et al., 1996
L.L. Green, P.A. Newman, K.J. Haigler
Sensitivity derivatives for advanced cfd algorithms and viscous modeling parameters via automatic differentiation
J. Comput. Phys., 125 (2) (1996), pp. 313-324, 10.1006/jcph.1996.0096
ArticleDownload PDFView Record in ScopusGoogle Scholar
Taylor et al., 1997
Taylor III, A.C., Oloso, A., Newman III, J.C., 1997. CFL3D.ADII (version 2.0): an efficient, accurate, general-purpose code for flow shape-sensitivity analysis. In: AIAA 1997-2204, 15th AIAA Applied Aerodynamics Conference, Atlanta, GA (June 1997). https://doi.org/10.2514/6.1997-2204
Google Scholar
Newman et al., (May-June 2003).
Newman III, J.C., Whitfield, D.L., Anderson, W.K., 2003. Step-size independent approach for multidisciplinary sensitivity analysis. J. Aircraft 40(3), 566–573 https://doi.org/10.2514/2.3131
Google Scholar
Burg and Newman, March 2003
C.O.E. Burg, J.C. Newman III
Computationally efficient, numerically exact design space derivatives via the complex Taylor's series expansion method
Comput. Fluids, 32 (3) (2003), pp. 373-383, 10.1016/S0045-7930(01)00044-5
ArticleDownload PDFView Record in ScopusGoogle Scholar
Anderson et al., 2001
W.K. Anderson, J.C. Newman III, D.L. Whitfield, E.J. Nielsen
Sensitivity analysis for the Navier-Stokes equations on unstructured meshes using complex variables
AIAA J., 39 (1) (2001), pp. 56-63, 10.2514/2.1270
CrossRefGoogle Scholar
Lyness and Moler, 1967
J.N. Lyness, C.B. Moler
Numerical differentiation of analytic functions
SIAM J. Numer. Anal., 4 (2) (1967), pp. 202-210, 10.1137/0704019
CrossRefGoogle Scholar
Cho and Park, 2003
Cho, N.Z., Park, C.J., 2003. A Comparison of Coarse Mesh Rebalance (CMR) and Coarse Mesh Finite Difference (CMFD) Acceleration Methods for the Neutron Transport Calculations. In: NURAPT-2002 (Rev3 2020), Nuclear Reactor Analysis and Particle Transport Laboratory, Korea Advanced Institute of Science and Technology.
Google Scholar
Favorite, 2018
J.A. Favorite
SENSMG: first-order sensitivities of neutron reaction rates, reaction-rate ratios, leakage, keff, and α using PARTISN
Nucl. Sci. Eng., 192 (1) (2018), pp. 80-114, 10.1080/00295639.2018.1471296
CrossRefView Record in ScopusGoogle Scholar
Alcouffe, et al., 2017
Alcouffe, R.E., et al., 2017. PARTISN: a time-dependent, parallel neutral particle transport code system. LA-UR-08-7258 (revised Sep. 2017), Los Alamos National Laboratory.
Google Scholar