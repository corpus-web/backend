<title>Analysis of the PHWR benchmark transient using a high-order spherical harmonics-nodal collocation method and treatment of rod cusping effect</title>
<author>1,M.T.Capilla,2,C.F.Talavera,3,D.Ginestar,4,G.Verdú</author>
<Affiliation>1,Departamento de Matemática Aplicada, Universitat Politècnica de València, Camino de Vera 14, E-46022 Valencia, Spain;2,Instituto de Seguridad Industrial, Radiofísica y Medioambiental, Universitat Politècnica de València, Camino de Vera 14, E-46022 Valencia, Spain</Affiliation>
<year>2021</year>
<Jounral>Progress in Nuclear Energy</Journal>
<Publishing_house>ELSEVIER</Publishing_house>
<Text_Collector>XiaFan，HEU</Text_Collector>
<DOI>10.1016/j.pnucene.2021.103701</DOI>
<URL>https://www.sciencedirect.com/science/article/pii/S0149197021000676</URL>
Analysis of the PHWR benchmark transient using a high-order spherical harmonics-nodal collocation method and treatment of rod cusping effect
M.T.Capilla,C.F.Talavera,D.Ginestar,G.Verdú
Departamento de Matemática Aplicada, Universitat Politècnica de València, Camino de Vera 14, E-46022 Valencia, Spain
Instituto de Seguridad Industrial, Radiofísica y Medioambiental, Universitat Politècnica de València, Camino de Vera 14, E-46022 Valencia, Spain
<Section>Highlights</Section>
We develop node homogenization methods based on 1D and 3D node equivalent problems.
Numerical implementation is based on spherical-harmonics nodal collocation method.
The method is verified on the AECL-7236 PHWR benchmark for P1 and P3 approximations.
Results show the accuracy for coarse spatial mesh and advance homogenization techniques.
<Section>Abstract</Section>
We develop and validate node homogenization methods, based on one and three-dimensional node equivalent problems, that improve the volume weighted method for the treatment of the rod cusping effect. The numerical implementation of these techniques in a numerical approach based on general spherical harmonics, nodal collocation method, for arbitrary odd order , and fully implicit time discretization, is verified on the AECL-7236 PHWR benchmark transient, showing the validity and convergence of the@and@approximations and the ability of the method to give accurate results for the relative power and scalar flux when a coarse spatial mesh combined with advanced homogenization techniques is used.
Keywords:Time-dependent neutron transport equation;Multidimensional PL equations;Spherical harmonics method;Nodal collocation method;Rod cusping effect
<Section>1. Introduction</Section>
The modeling of traditional nuclear reactors has been mostly based on the diffusion approximation to the time dependent Boltzmann neutron transport equation, but their results may not be as accurate with the new generations of reactor designs and new fuel elements. This motivates the need of high order approximations to the neutron transport equation that overcomes the limitations of the diffusion equation.
In previous works, we have developed a numerical approximation to the time-dependent neutron transport equation, coupled to the delayed neutron precursors equations, that is based on the expansion of the angular dependence of the neutronic flux in terms of spherical harmonics (Davison, 1957), resulting into the so-called@equations, for arbitrary odd order , and on a fully implicit discretization of time given by the backward Euler method. In this way, when the odd-parity spherical harmonics coefficients of the flux are inserted into the even-parity equations, the resulting problem can be rewritten as a set of stationary diffusive second order@equations. The advantage of this approach is two-fold: the reduction by half of the number of unknowns, and the use of a nodal collocation method for the spatial discretization of the problem, using coarse spatial grids to reduce memory requirements. These numerical developments have been implemented into a code called Spherical Harmonics-Nodal Collocation (SHNC) (Capilla et al., 2008, Capilla et al., 2020).
In the present work we extend the previous approximation by considering different methodologies to treat the rod cusping problem, that appears in the study of transients involving movement of control rods. In nodal methods, where the nuclear cross-sections are assumed to be constant in each node, the partial insertion of a control rod into a node divides the node into two regions: a rodded part where the nuclear cross-sections are modified due to the effect of the control rod and an unrodded part where the cross-sections are unaltered. This requires an homogenization of the cross-sections of the whole node by means of an interpolating procedure. The basic volume weighting method interpolates cross-sections based on the volume occupied by the control rod in the node. But this approach gives unphysical behavior of the@and the neutron fluxes, and the observed anomalies are known as rod cusping effects.
Different strategies (Dall’osso, 2002, Schunert et al., 2019) have been proposed to reduce this effect. In González-Pintor et al. (2011), a correction is introduced by using a flux weighted interpolation method based on high order finite elements. In the work of Yamamoto (2004), a new approach derived from the inverse of the spectral index from the assembly calculations is used to estimate the flux distribution inside the partially rodded mesh. This method is applied only to three-dimensional static pin-by-pin calculations and not to transient analysis. Also, the solutions implemented into the MPACT transport code for correcting the rod cusping effect are several decusping techniques such as a polynomial decusping method, a subplane decusping method and a method based on using the collision probabilities method to correct the homogenized cross-sections (Graham et al., 2017).
In the work of Gehin (1992), the averaged fluxes are interpolated by using the neutron flux in three nodes, the partially rodded node, the previous node and the next node along the rod insertion direction, estimating a weight factor. Following Gehin’s work, in Dall’osso (2002) the analytical flux weighting method with axial discontinuity factors is described. The bilinear weighting method and the equivalent node methods, where the node containing the tip of a control rod is divided into two parts (rodded and unrodded) and a nodal expansion method is applied to a one-dimensional problem integrating the neutron diffusion equations in the transverse directions@and . Pursuing this approach, in the PARCS code (Downar et al., 2009) an axial three-node transverse-integrated neutron balance equation is solved by using a fine-mesh finite difference scheme. To solve the one-dimensional second order differential equation two boundary conditions are needed. These are specified in terms of the neutron current available from the previous finite difference computation.
Otherwise, in Vidal-Ferrándiz (2018) and Vidal-Ferrándiz et al. (2016) the rod cusping problem is treated by using a moving mesh strategy based on a high order finite element method and interpolating the neutron flux solution in different meshes that change with different time steps, following the movement of the control rod.
To incorporate the rod cusping effect into our SHNC code, we have first considered that the largest part of this effect occurs along the direction of motion of the control rod and that lateral leakages are neglected. Then the flux redistribution in the heterogeneous regions can be modeled by a one-dimensional two-region problem, where the partially inserted node is split into two nodes (rodded and unrodded) with constant cross-sections each and boundary conditions given by the averaged incoming flux from the neighbor nodes at previous time steps. This problem is then solved using the 1D-SHNC code for any given@angular order with odd . To better model the flux shape along the rod insertion direction, we consider an equivalent four-nodes one-dimensional problem consisting of the rodded and unrodded nodes together with two neighboring nodes along the rod insertion direction, again with the boundary conditions given by the node averaged incoming flux from the neighboring nodes at previous time steps. The 1D-SHNC code is then used to compute the@approximation to the neutronic flux at each node and this allows to estimate the weighting factor in Gehin’s interpolation formula.
The flexibility of this approach allows us to consider finally an enhanced 3D model of four rectangular nodes that incorporates lateral leakages along their boundary surfaces, that is again solved using the 3D-SHNC code with the corresponding@approximation. The results will quantify the validity of the 1D models and the contribution of the surface leakage.
The enhancements introduced to the SHNC code have been tested with the AECL-7236 benchmark problem (Judd and Rouben, 1981). This problem is a realistic representation of a Pressurized Heavy Water Reactor (PHWR) and describes a super-delayed critical transient by simulating a hypothetical loss of coolant accident (LOCA) followed by an asymmetric insertion of reactivity. The rod cusping effect is produced in this case in a radial direction instead of the typical axial direction for transients involving the movement of control rods. This effect and the asymmetry of the benchmark problem provide a good experiment to validate our 3D neutron transport code for transient analysis. As the SHNC code is able to compute accurate enough solutions using large spatial nodes, a coarse non-uniform spatial mesh will be used first for a fast and memory-efficient evaluation of the rod-cusping effect. Computations will also be performed with a refined mesh that will minimize the influence of partially inserted nodes and the cusping effect, so we can distinguish the errors caused by the transport calculations and the errors caused by the rod-cusping treatment, showing also the convergence of the procedure.
The rest of the paper is organized as follows. In Section 2 we briefly review the numerical approximations used on the Boltzmann neutron transport equation together with the neutron precursor equations, that give a system of second order stationary differential equations for the even order fields in the spherical harmonics expansion of the angular flux. Section 3 develops the homogenization techniques that will be used to correct the rod cusping effect by taking into account intranodal flux variations. The methods described in these sections will be validated in Section 4, where stationary and transient computations of the three-dimensional PHWR benchmark problem are obtained and compared with reference data. The conclusions are finally established in Section 5.
<Section>2. Theoretical model and numerical methods</Section>
2.1. The Boltzmann transport equation
The dynamics of the neutron angular flux and delayed neutron precursor concentration in a nuclear system of volume@can be described by the Boltzmann transport equation (Stacey, 2007)
@(1)
together with the neutron precursor equations
@(2)
where@is the angular flux, that depends on the position , angular direction , and energy@of the neutron, being@the (effective) neutron velocity and@the neutron speed.@is the delayed neutron precursor concentration for precursor group@and@delayed neutron groups. @are, respectively, the total, scattering and fission macroscopic cross-sections.@is the (average) number of neutrons emitted per fission;@and@are the prompt and delayed neutron spectra;@and@are the decay constant and precursor fraction for precursor group , with@the total delayed neutron fraction and@is any internal fixed source.
The solution of Eqs. (1), (2) requires boundary conditions and initial values for the angular flux and precursor concentrations. In this paper we will consider external source boundary conditions, where the incoming angular flux to the reactor is given by a known function@at the reactor boundary@and
with@the (outward pointing) normal vector to the boundary surface. Vacuum boundary conditions correspond to zero value for . The approximation of zero flux boundary conditions@at@will also be considered.
The initial state will be taken from the solution of the stationary state where@and @, . The stationary state is a critical configuration of the reactor core obtained from the initial configuration dividing the fission cross-section by the@eigenvalue.
2.2. Numerical approach
The dependence on seven continuous variables in the transport equation will be approximated using the methods that will be briefly described in the next paragraphs. A detailed description of these methods can be found in the references to previous works.
The continuous dependence on energy@will be replaced by a dependence on a discrete number@of energy groups each one spanning an energy interval , obtaining the so-called multi-group approximation. To keep the notation simple in the following we will assume one energy group.
The angular dependence of the flux@(and the internal source) will be, in the spherical harmonics method (see, for example, Henry, 1975) and for general 3D geometry, expressed as a sum
@(3)
of (complex) spherical harmonics , where@are the associated Legendre polynomials, , and@and@are the azimuthal and polar angles respectively. The angular dependence of the macroscopic scattering cross-section will also be assumed to be on the relative angle@between incident and scattered directions, and will be expanded as the Legendre polynomial series
@(4)
A finite approximation is obtained when the infinite series (3), (4) are truncated to a finite order , obtaining the@approximation. The unknowns are then the (complex) coefficients@in (3), that must satisfy the constraint@in order to obtain a real angular flux function . If we define the real coefficients
and the vectors@and@of coefficients of even/odd order@then, using the orthogonality properties of the spherical harmonics, it can be shown (Capilla et al., 2008) that the flux coefficients and the precursor concentrations satisfy the following set of first order@differential equations
@(5)
@(6)
@(7)
with @,@ , and@and@are numerical matrices that come from the integration with the spherical harmonics, see Capilla et al., 2008, Capilla et al., 2012, Capilla et al., 2016 for an explicit representation. We mention also that the vectors of even/odd order@are in correspondence with the even-parity and odd-parity neutronic flux defined in the formulation of the even-parity transport equation (Morel et al., 2006).
From now on, we will consider@equations with odd order . This implies continuity of vector@of even order coefficients and, in particular, of the neutronic scalar flux@along the reactor volume (Capilla et al., 2016).
The time discretization of@Eqs. (5), (6), (7) will be carried out by a first order backward Euler method with constant time step . The use of an unconditionally stable, fully implicit method is suggested by the large relative difference between the speeds of the fast and thermal neutron groups. If , , is the discrete time, and we denote with the superindex@the variables at time , then the@equations can be rewritten as (Capilla et al., 2020)
@(8)
@(9)
@(10)
where we have defined@and the following effective magnitudes
The th time iteration described by these equations proceeds by computing the even order fields@using the implicit formula (8) from previous time step vectors ,@and . The explicit formulas (9), (10) update then the values of@and .
The reformulation of the@equations as a second order effective form of stationary differential equation (8) for the even order fields (Capilla et al., 2008, Capilla et al., 2012, Morel et al., 2006) reduces the dimension of the computational expensive implicit problem by half and, additionally, allows the use of already developed efficient methods of spatial discretization for differential equations of diffusive nature. We will consider multi-dimensional rectangular geometries, where an structured rectilinear mesh in Cartesian coordinates can be defined. A nodal collocation method (Hébert, 1987, Verdú et al., 1994, Capilla et al., 2012) will be used for the spatial discretization and, as we will see, this method allows the use of large rectangular nodes giving accurate enough results, thus reducing memory and computational time.
The reactor volume@will be discretized in@adjacent rectangular nodes where the physical properties (speed, cross-sections, etc.) are set constant along the node. If@is the node index and@is a node in Cartesian coordinates ( are the node vertices with@the node indices), the change of variables , with , scales@to the canonical node . The spatial dependence in the unknowns in Eqs. (8), (9), (10) is then approximated by a finite sum up to order@of orthonormal Legendre polynomials. The even order vector , for example, at node@and as a function of the canonical variables , is expressed as
@(11)
where@( are the Legendre polynomials) satisfy .
The finite Legendre series (11) is used in Eq. (8), together with the orthonormality properties of the Legendre polynomials, to obtain a linear system for the coefficients@(Capilla et al., 2008, Capilla et al., 2012). The corresponding sparse matrix is real and non-symmetric, and an efficient solution for large problems requires an iterative solver.
<Section>3. Treatment of the rod cusping effect</Section>
In numerical problems involving a moving control rod, the assignment of a constant cross-section to each spatial node, imposed by a nodal collocation method with fixed spatial mesh, requires an homogenization procedure for the cross-sections associated to a partially inserted control rod into a node. Some methods have been developed to obtain the homogenized nodal cross-sections, usually based on averaging physical conditions on the node. One of the first works is Joo (1984). A discussion of some common approaches can be found in Dall’osso (2002) and Schunert et al. (2019).
The basic homogenization method is of pure geometric nature and computes averages based on the fraction of volume occupied by the control rod in the node. For a partially inserted rod that moves in the -direction, see Fig. 1, the assigned cross-section of this simple volume weighted (VWG) method is then
where , ,@and@are the cross-section and volume of the rodded and unrodded portion, respectively,@is the total volume, , and the weight factor
is the nodal insertion fraction of the rod.
It is known that this purely geometrical approach suffers from cusping effects, that introduces significative errors in cross-section calculations because it does not take into account the intranodal flux variations. An approach to mitigate this problem is to estimate the angular averaged scalar flux@on each of the two regions (rodded/unrodded) of the node and to incorporate this information into the so called flux volume weighted (FWG) cross-sections
where the weight factor is now given by
@(12)
The estimation of the averaged fluxes@and@in the above equation, on the rodded and unrodded segments of the node, has given rise to some approaches (Schunert et al., 2019). Some of these methods, and a new 3D technique that incorporates lateral leakages along each node boundary surface, have been implemented into our transport code:
Fig. 1. Partially inserted control rod along the@axis. The points ,@correspond to the fixed spatial mesh that discretizes the problem.
1.
Gehin (1992) interpolates the averaged fluxes by using the fluxes in three nodes: the rodded node, the previous node and then next node along the rod insertion direction, according to Fig. 2 and the formulas
(13)
where the averaged flux@on the spatial node@is obtained from the previous time step of the transport code computation. These estimates, when inserted into Eq. (12), computes a weight factor@that results into smooth time evolution of the core flux.
2.
If we consider that most of the rod cusping effect occurs along the direction of motion and neglect radial leakage, the flux redistribution in the heterogeneous regions can be modeled by the one-dimensional two-region problem shown in Fig. 3, where the partially inserted node is split into two nodes (rodded/unrodded) with constant cross-sections each, and with boundary conditions given by the node averaged incoming flux@from the neighboring nodes at previous time step (or by external boundary conditions, otherwise), see Appendix for explicit formulas, that will be solved by using the SHNC code with given@approximation. For this small two node problem the associated linear system has dimension@for the@approximation with@and@energy groups, and has dimension@for the@approximation. The averaged fluxes@and@computed from the numerical solution of this equivalent nodal two-nodes (E2N) method allows us to compute the corresponding weight factor from Eq. (12), that will be denoted as .
3.
To better model the flux shape along the direction of the rod insertion, we will now consider an equivalent nodal four-nodes (E4N) one-dimensional problem consisting in the partially inserted node split into two nodes (rodded and unrodded) and the two neighboring nodes along the insertion direction, again with boundary conditions given by the node averaged incoming flux from the neighboring nodes at previous time step (or by external boundary conditions, otherwise). The problem is described in Fig. 4. Because the number of spatial nodes has doubled, the dimension of the corresponding linear system is two times the dimension of the E2N method. The SHNC code with given@approximation is then used to compute the flux@at each node that, inserted into Gehin’s formulas (13), allows us to estimate the weight factor from Eq. (12), that will be denoted as .
4.
A natural extension of the previous models that accounts for the 3D nature of the problem and incorporates surface leakages consists on replacing each one-dimensional node of the E4N model by 3D rectangular nodes, where again two nodes are assigned to the rodded and unrodded regions, respectively. The node averaged incoming fluxes from neighboring nodes will model the leakage along boundary surfaces. This equivalent nodal four-nodes 3D (E4N3D) method will be solved, at a given@approximation, with the SHNC code resulting as in previous items into a weighting factor .
Fig. 2. Three node region used to estimate averaged fluxes in Gehin’s method.
Fig. 3. Equivalent one-dimensional two-region problem.
Fig. 4. Equivalent one-dimensional four-region problem.
<Section>4. Numerical results</Section>
The methods described in Sections 2 Theoretical model and numerical methods, 3 Treatment of the rod cusping effect have been implemented into the FORTRAN 90 computer code SHNC, that was developed by the authors for the solution of stationary transport problems with internal and external neutron source (Capilla et al., 2008, Capilla et al., 2012) and later extended to time dependent transport problems (Capilla et al., 2020), for multidimensional space in general rectangular geometries. There are no restrictions to the@approximation order, for odd , to the number of energy groups and to the number of delayed neutron families. The formalism also deals, in a natural way, with isotropic and anisotropic scattering and source terms.
The validity of the various rod cusping treatments has been demonstrated for the three-dimensional kinetics benchmark problem in a pressurized heavy water reactor (PHWR) (Judd and Rouben, 1981). This problem simulates a hypothetical loss-of-coolant accident followed by an asymmetric reactivity insertion in a square 3D configuration.
The reactor has dimensions 780 × 780 × 800 cm and the geometry and configuration are shown in Fig. 5, Fig. 6. The model consists of two energy groups and six delayed neutron families, with zero flux boundary conditions on external surfaces and initial conditions described by a critical configuration for the steady state. The physical parameters of the problem (cross-sections, group speeds, delayed neutron data) and descriptions of the materials used in reflector, inner core and outer core are detailed in Judd and Rouben (1981).
The benchmark describes a super delayed critical transient that results from two perturbations: a linear time decrease in the thermal absorption cross-section with slope change at , in the pink colored regions in Fig. 5, Fig. 6, and an asymmetric control rods insertion at constant velocity of@in the@direction, beginning at , in regions corresponding to the blue zones in the Figures. The transient ends at time .
Computations have been performed with the SHNC code using@and@approximations with fixed Legendre polynomial order@in Eq. (11) (motivated by the static computations in Section 4.1; see previous works in Capilla et al., 2008, Capilla et al., 2012 for a convergence analysis with respect to the angular order@of the@approximation and the order ). Two non-uniform spatial discretizations have been chosen in the calculations:
1.
A coarse spatial mesh consisting on 10 × 10 × 2 nodes in ,@and@directions respectively, depicted by dashed lines in Fig. 5, Fig. 6. This grid mesh corresponds to a large discretization compatible with the geometry of the reactor, resulting in a total of@rectangular material nodes with side lengths@or@in@and@directions, and side length@in@direction.
2.
A fine spatial mesh described in Judd and Rouben (1981, pp. 11,12 and Figs. 4-1,2) is considered, with 18 × 18 × 10 nodes in ,@and@directions respectively, giving a total of@rectangular material nodes with side lengths@or .
Fig. 6. Horizontal cross section at@cm. Regions affected by perturbations are colored. The dashed lines describe the coarse spatial mesh.
4.1. Static computations
As the benchmark steady state is set to the critical state, a previous computation of the@eigenvalue is performed for each@approximation and each spatial mesh, considering increasing values of the Legendre polynomial order@in Eq. (11). In Table 1,@results are shown together with the reference value (Judd and Rouben, 1981). We observe that the criticality of the problem is well described by a coarse mesh@approximation, corresponding to a diffusive regime and that the choice@for the spatial approximation in further calculations is a good compromise between accuracy and computational work (third row in Table 1). In the transient calculations the initial state will be made critical using the@corresponding to each computed@approximation.
Table 1. Computed fundamental eigenvalue@for PHWR problem, with@approximations and reference value.
Given a fixed time step, the tip of the inserted rods may not coincide at each discrete time with the spatial mesh grid. To deal with the possible rod cusping effect, the averaging techniques described in Section 3 and modeled by an equivalent one-dimensional problem have been used. The effectiveness of each method has been checked by computing the time dependent relative total power and comparing with the most favorable case from all proposed SHNC solution methods and also with the reference result (Judd and Rouben, 1981).
The relative total power (RTP) for a given time@is defined as
@(14)
where the normalization factor@is the total power computed at@ ;@is the core volume;@is the number of energy groups and@is the scalar flux for energy group .
First, to investigate the influence of the time step size, Fig. 7 shows the RTP computed with the SHNC method, for the@approximation, using the coarse spatial grid and two constant time steps, for each rod cusping treatment. Also, the continuous line corresponds to the reference value (Judd and Rouben, 1981 p. 14) for time step . If the@approximation is also computed, results are close to@approximation as we will see later from a study of the relative errors. From Fig. 7 we observe that:
Fig. 7. Relative total power computed with@approximation, coarse spatial mesh and time steps@(left) and@(right). The vertical line corresponds to the rod insertion time .
1.
A constant time step@achieves convergence for the time discretized backward Euler method.
2.
A volume weighted homogenization method underestimates the relative total power. The other methods that reduce the rod cusping effect give similar results, being the flux volume weighted Gehin’s method the computationally least expensive method. Among the equivalent nodal methods, the four-nodes method E4N is more accurate with similar computational effort.
3.
The agreement between the computed RTP and the reference value is very good before the rod insertion, but after the introduction of this perturbation the SHNC results are below the benchmark. This discrepancy has been reported by other authors (Keresztúri et al., 2003, Srivastava et al., 2018). We suggest that the cause of this deviation comes from the different spatial discretizations schemes used by the computer codes to simulate the transient. This also originates that small differences in the scalar flux accumulate with time evolution.
The effect of the spatial mesh on the rod cusping effect is shown in Fig. 8, for the fine spatial mesh with constant time steps@and , obtained with@approximation. We observe from the Figure the convergence of the volume weighted method to the other homogenization methods, that almost overlap.
Now we study in detail the numerical accuracy of the@and@results for the RTP, for different time steps and varying the spatial mesh. To show a measure of the discrepancy between the methods used, in Table 2, Table 3 we display the maximum relative errors in the RTP with respect to two different reference values. Table 2 shows maximum relative errors from SHNC@() RTP with respect to results from the benchmark Judd and Rouben (1981, p. 14) with time step . In Table 3, the SHNC@computed RTP with fine spatial mesh, time step@and E4N homogenization method is taken as the reference value. In all cases, the maximum relative error@has been computed as follows:
where@is the reference relative total power at time .
We observe from Table 2, Table 3 that the error decreases and therefore convergence increases when the spatial mesh is refined, the constant time step is reduced and also when the@approximation order increases. The@approximation gives a small improvement over the@approximation, showing that the benchmark is well approximated by a diffusive model. As commented in previous observations to Fig. 7, there appears a bias from the reference solution with every approximation and homogenization method. The convergence of all homogenization techniques is clear and among these techniques, the E4N method introduces the least maximum relative error. Nevertheless, the FWG method is a computationally cheap alternative to deal with the rod cusping effect.
Table 2. Maximum percent relative error for@and@relative total power with respect to the benchmark value.
Table 4 shows a comparison of point values of the RTP for a particular choice of numerical parameters in the SHNC code together with the reference values. It can be seen that a better treatment of the rod cusping effect can affect the second significant figure and, on the other hand, the jump from@to@angular approximation modifies at most the fourth significant figure in the relative total power, confirming again the diffusive nature of the problem.
Fig. 9 shows the change in criticality of the reactor with time due to the introduction of perturbations, as computed by the SHNC code with two homogenization methods. Vertical lines correspond to times@and , where perturbations change. Computations were performed with coarse mesh@approximation and Legendre order .
Table 4. Relative total power results for the SHNC@and@approximations with time step@and coarse spatial mesh, and benchmark solution.
To quantify the performance of the method, Table 5 shows the computer running times of the SHNC code with@approximation, , on an AMD Phenom 2.8 GHz computer, with sequential (single-core) compiled FORTRAN code. At each time step the ILUT/BiCGSTAB iterative solver was used with tolerance 10−12. The computation of rod cusping corrections for the equivalent node methods are performed by spanning, at each time step, a subprocess for the SHNC code. This accounts for higher computational times for these methods. It is also seen that computational times doubles, in general, when time step halves.
Fig. 9. Variation of@eigenvalue with time for PHWR problem.@approximation, coarse mesh, .
Flux shape has been compared in Fig. 10, Fig. 11, where the@scalar flux distribution computed with the E4N homogenization method is plotted together with the reference solution at different transient times in@direction at@and . The flux distributions are normalized to the Ref. (Judd and Rouben, 1981) total power@at each time, see Eq. (14). The SHNC@values have been computed with constant time step , for the coarse and fine mesh discretizations, and the data from the reference solution corresponds to the time step . We observe a good agreement of the SHNC E4N results with benchmark data for both spatial discretizations, with discrepancies at the interval of fast changing slope when the coarse mesh is used.
Table 5. SHNC@running CPU times (in seconds), with@and tolerance .
Finally, Fig. 12 compares the influence of the different homogenization techniques on the flux shape. The@thermal group scalar flux, computed with constant time step , is plotted along the@axis (the moving rod direction), at@and , at times@(start of rod insertion),@and@(rod inserted at half reactor length). The flux distribution is normalized, in all cases, to the computed total power@at initial time . In Fig. 12, the left column of the plots corresponds to the coarse mesh spatial discretization and shows that the VWG method underestimates the thermal flux shape during rod insertion, thus requiring more advanced techniques to accurately track this transient. This rod cusping effect is reduced by the choice of a fine spatial mesh (right column in the Figure), showing also the convergence of the homogenization methods when the spatial discretization is refined.
Fig. 10. Thermal group scalar flux at@and , for@approximation with time step , at@(left) and@(right).
Fig. 11. Scalar flux at@and , for@approximation with time step , at@(transient end): Fast group (left) and thermal group (right).
The previous results show the convergence of the numerical method, the smoothness of the flux when the spatial mesh is refined and that the rod cusping modeling methods effectively improve, in the same order of magnitude, the purely geometrical volume weighted method.
Fig. 12. Thermal group scalar flux at@and , for@approximation with time step , at times@using coarse spatial mesh (left) and fine spatial mesh (right). The vertical line denotes the moving rod tip position at that particular time.
4.3. Transient results for equivalent nodal four-nodes 3D technique
The accuracy of the simplifying assumptions of previous homogenization methods (no lateral leakages and the largest effect occurs along the direction of motion) can be finally estimated with the equivalent nodal four-nodes 3D (E4N3D) method that incorporates the spatial (3D) nature of the transient with surface boundary leakages simulated by external sources computed from formulas given in Appendix.
Table 6 shows the computed RTP for the time interval , that corresponds to the asymmetric control rods insertion, using a coarse spatial mesh and different time step sizes, for@and@angular approximations. For brevity, we omit the spatial convergence of the method with the fine spatial mesh, that has been verified before in Section 4.2.
It can be seen that the computed values in Table 6 are below the values in Table 4 for the 1D interpolatory homogenization techniques, with discrepancies at the third decimal digit. We observe that@and@RTP results with E4N3D method and@differ from the second decimal digit in some cases when , while for@the differences between@and@are less significant. Also, the difference between E4N3D@and@results in Table 6 is somewhat larger than in the 1D techniques because the angular dependence is more relevant in 3D geometry.
Table 6.@and@relative total power results for E4N3D method, coarse spatial mesh and different time steps, and benchmark solution.
To compare the E4N3D method with the 1D homogenization techniques, Fig. 13 shows the maximum relative errors@for@relative total power, calculated with the coarse mesh and different time steps and methods, with respect to the@solution with the E4N3D method for@We observe that the maximum error of the@E4N3D technique increases almost linearly with the time step and it is smaller than that obtained with other methods.
The computation times needed to obtain the E4N3D@results, using the coarse mesh for , are approximately double compared to the CPU times needed for E4N@calculations with the same parameters (see last column of Table 5, entries 2nd to 4th). This difference in running times is due to the overhead of the computation of lateral leakages and the use of a 3D code.
Fig. 13. Maximum relative error for@RTP coarse mesh results with respect to the reference@E4N3D solution (coarse mesh and ).
<Section>5. Conclusions</Section>
An accurate analysis of transient modes in reactor models involving control rod insertion requires advanced homogenization techniques for the cross-sections corresponding to partially inserted nodes. Our approach is based on estimates of the averaged scalar flux on each region (rodded/unrodded) of the node, computed either by interpolation (Gehin’s approach) or by the numerical solution of an equivalent nodal problem that can be one-dimensional or three-dimensional incorporating lateral leakages.
These techniques have been implemented for arbitrary@approximation and Legendre polynomial order . The adoption of a spatial discretization based on a nodal collocation method and the use of node averaged values for the scalar flux give a relative total power curve that smoothly varies with time for each choice of spatial mesh and homogenization technique. Among these, the E4N method, using the physical information of the one-dimensional node neighborhood, improves the FWG method with little extra computational effort, especially for large numerical problems. The geometry of the E4N method is adapted to the rod insertion and so it is free of any rod cusping effect. The influence of the surrounding volume is modeled by computed averaged incoming scalar fluxes. Also, for problems where the effects of lateral leakages or strong angular anisotropies cannot be neglected, the proposed E4N3D method, combined with a@or@angular approximation, is a natural replacement.
The computed results show the validity of the code to evaluate high order@approximations for each of the implemented homogenization methods, and that in this particular problem the@approximation gives minor corrections to the@case, confirming thus the diffusive character of the benchmark. The nodal collocation spatial discretization with high polynomial order@allows the use of a coarse spatial mesh and gives a numerical problem of small memory footprint that allows fast computations while maintaining accurate enough results.
Finally, the choice of an implicit time discretization scheme allows consistent calculations along all time steps and shows the validity of relatively large time steps (when compared with typical neutron speeds) to faithfully reproduce the transient evolution.
<Section>Declaration of Competing Interest</Section>
The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.
<Section>Acknowledgments</Section>
Partial support to perform this work has been received by the Spanish Agencia Estatal de Investigación under project ENE2017-89029-P-AR. The authors thank the anonymous reviewers for their comments and suggestions.
<Section>Appendix. Computation of the node averaged incoming scalar flux</Section>
For a fixed spatial node , the volume averaged angular flux at left adjacent node@is given by
where@are the coefficients from the orthonormal Legendre polynomial expansion (11) at node . The incoming flux to node , along left boundary surface with normal vector@pointing outwards, see Fig. A.14, is
(A.1)
that, using expansion (3) in terms of spherical harmonics for the angular dependence of@(with ), gives
(A.2)
where@and the integrals@are bounded by . The incoming flux for the rest of boundary surfaces can be obtained in a similar fashion:
(A.3)
where . For example, in the particular case of the@approximation,
(A.4)
Fig. A.14. Incoming flux along left@axis boundary surface at spatial node .
<Section>References</Section>
Capilla et al., 2008
Capilla M., Talavera C.F., Ginestar D., Verdú G.
A nodal collocation approximation for the multidimensional@equations - 2D applications
Ann. Nucl. Energy, 35 (2008), pp. 1820-1830
ArticleDownload PDFView Record in ScopusGoogle Scholar
Capilla et al., 2012
Capilla M., Talavera C.F., Ginestar D., Verdú G.
Application of a nodal collocation approximation for the multidimensional@equations to the 3D Takeda benchmark problems
Ann. Nucl. Energy, 40 (2012), pp. 1-13
ArticleDownload PDFView Record in ScopusGoogle Scholar
Capilla et al., 2016
Capilla M.T., Talavera C.F., Ginestar D., Verdú G.
Nodal collocation method for the multidimensional@equations applied to neutron transport source problems
Ann. Nucl. Energy, 87 (2016), pp. 89-100
ArticleDownload PDFView Record in ScopusGoogle Scholar
Capilla et al., 2020
Capilla M.T., Talavera C.F., Ginestar D., Verdú G.
Validation of the SHNC time-dependent transport code based on the spherical harmonics method for complex nuclear fuel assemblies
J. Comput. Appl. Math, 375 (2020), Article 112814, 10.1016/j.cam.2020.112814
ArticleDownload PDFView Record in ScopusGoogle Scholar
Dall’osso, 2002
Dall’osso A.
Reducing rod cusping effect in nodal expansion method calculations
Proceedings Int. Conf. New Frontiers of Nuclear Technology: Reactor Physics, Safety and High-Performance Computing, American Nuclear Society (2002)
Google Scholar
Davison, 1957
Davison B.
Neutron Transport Theory
Oxford University Press, London (1957)
Google Scholar
Downar et al., 2009
Downar T., Xu Y., Seker V.
PARCSv3.0 theory manual, UM-NERS-09-001
(2009)
Google Scholar
Gehin, 1992
Gehin J.C.
A Quasi-Static Polynomial Nodal Method for Nuclear Reactor Analysis
(Ph.D. thesis)
Dept. of Nuclear Engineering, Massachusetts Institute of Technology, Cambridge, MA (1992)
Google Scholar
González-Pintor et al., 2011
González-Pintor S., Verdú G., Ginestar D.
Correction of the rod cusping effect for a high order finite element method
International Conference on Mathematics and Computational Methods Applied to Nuclear Science and Engineering, M & C 2011, Rio de Janeiro, Brazil, May 8–12, Latin American Section (LAS)/ American Nuclear Society (ANS) (2011)
Google Scholar
Graham et al., 2017
Graham, A.A., Collins, B.S., Downar, T., 2017. Subplane-based control rod decusping techniques for 2D/1D method in MPACT. In: International Conference on Mathematics and Computational Methods Applied to Nuclear Science and Engineering, M & C 2017, Jeju, Korea, April 16–20.
Google Scholar
Hébert, 1987
Hébert A.
Development of the nodal collocation method for solving the neutron diffusion equation
Ann. Nucl. Energy, 14 (10) (1987), pp. 527-541
ArticleDownload PDFView Record in ScopusGoogle Scholar
Henry, 1975
Henry A.F.
Nuclear-Reactor Analysis
MIT Press, Cambridge (1975)
Google Scholar
Joo, 1984
Joo H.S.
Resolution of the Control Rod Cusping Problem for Nodal Methods
(Ph.D. thesis)
Department of Nuclear Engineering, MIT, Cambridge, MA, USA (1984)
Google Scholar
Judd and Rouben, 1981
Judd R.A., Rouben B.
Three Dimensional Kinetics Benchmark Problem in a Heavy Water Reactor
Atomic Energy of Canada Limited, AECL-7236 (1981)
Google Scholar
Keresztúri et al., 2003
Keresztúri A., Hegyi Gy., Marázcy Cs., Panka I., Telbisz M., Trosztel I., Hegedüs Cs.
Development and validation of the three-dimensional dynamic code–KIKO3D
Ann. Nucl. Energy, 30 (1) (2003), pp. 93-120
ArticleDownload PDFView Record in ScopusGoogle Scholar
Morel et al., 2006
Morel J.E., Adams B.T., Noh T., McGhee J.M., Evans T.M., Urbatsch T.J.
Spatial discretizations for self-adjoint forms of the radiative transfer equations
J. Comput. Phys., 214 (2006), pp. 12-40
ArticleDownload PDFView Record in ScopusGoogle Scholar
Schunert et al., 2019
Schunert S., Wang Y., Ortensi J., Laboure V., Gleicher F., DeHart M., Martineau R.
Control rod treatment for FEM based radiation transport methods
Ann. Nucl. Energy, 127 (2019), pp. 293-302
ArticleDownload PDFView Record in ScopusGoogle Scholar
Srivastava et al., 2018
Srivastava A., Singh K.P., Degweker S.B.
Monte Carlo methods for reactor kinetics simulations
Nucl. Sci. Eng., 189 (2) (2018), pp. 152-170
CrossRefView Record in ScopusGoogle Scholar
Stacey, 2007
Stacey W.M.
Nuclear Reactor Physics
WILEY-VCH Verlag GmbH & Co. KGaA, Weinheim (2007)
Google Scholar
Verdú et al., 1994
Verdú G., Ginestar D., Vidal V., Muñoz-Cobo J.L.
3D@modes of the neutron diffusion equation
Ann. Nucl. Energy, 21 (7) (1994), pp. 405-421
ArticleDownload PDFView Record in ScopusGoogle Scholar
Vidal-Ferrándiz, 2018
Vidal-Ferrándiz A.
Development of a Finite Element Method for Neutron Transport Equation Approximations
(Ph.D. thesis)
Universitat Politécnica de València (2018), 10.4995/Thesis/10251/98522
Google Scholar
Vidal-Ferrándiz et al., 2016
Vidal-Ferrándiz A., Fayez R., Ginestar D., Verdú G.
Moving meshes to solve the time-dependent neutron diffusion equation in hexagonal geometry
J. Comput. Appl. Math., 291 (2016), pp. 197-208
ArticleDownload PDFView Record in ScopusGoogle Scholar
Yamamoto, 2004
Yamamoto A.
A simple and efficient control rod cusping model for three-dimensional pin-by-pin core calculations
Nucl. Technol., 145 (1) (2004), pp. 11-17
View Record in ScopusGoogle Scholar