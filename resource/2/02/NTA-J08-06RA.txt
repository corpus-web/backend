<title>Applicability of a set of tomographic reconstruction algorithms for quantitative SPECT on irradiated nuclear fuel assemblies</title>
<Affiliation>Department Physics and Astronomy, Uppsala University, Box 516, SE-751 20 Uppsala, Sweden</Affiliation>
<author>Staffan Jacobsson Svärd, Scott Holcombe, Sophie Grape</author>
<year>2015</year>
<Jounral>Nuclear Instruments and Methods in Physics Research A</Journal>
<Publishing_house> Elsevier </Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.nima.2015.02.035</DOI>
<URL>http://dx.doi.org/10.1016/j.nima.2015.02.035</URL>
a b s t r a c t
A fuel assembly operated in a nuclear power plant typically contains 100–300 fuel rods, depending on fuel type, which become strongly radioactive during irradiation in the reactor core. For operational and security reasons, it is of interest to experimentally deduce rod-wise information from the fuel, preferably by means of non-destructive measurements. The tomographic SPECT technique offers such possibilities through its two-step application; (1) recording the gamma-ray ﬂux distribution around the fuel assembly, and (2) reconstructing the assembly's internal source distribution, based on the recorded radiation ﬁeld. In this paper, algorithms for performing the latter step and extracting quantitative relative rod-by-rod data are accounted for.
As compared to application of SPECT in nuclear medicine, nuclear fuel assemblies present a much more heterogeneous distribution of internal attenuation to gamma radiation than the human body, typically with rods containing pellets of heavy uranium dioxide surrounded by cladding of a zirconium alloy placed in water or air. This inhomogeneity severely complicates the tomographic quantiﬁcation of the rod-wise relative source content, and the deduction of conclusive data requires detailed modelling of the attenuation to be introduced in the reconstructions. However, as shown in this paper, simpliﬁed models may still produce valuable information about the fuel.
Here, a set of reconstruction algorithms for SPECT on nuclear fuel assemblies are described and discussed in terms of their quantitative performance for two applications; veriﬁcation of fuel assemblies' completeness in nuclear safeguards, and rod-wise fuel characterization. It is argued that a request not to base the former assessment on any a priori information brings constraints to which reconstruction methods that may be used in that case, whereas the use of a priori information on geometry and material content enables highly accurate quantitative assessment, which may be particularly useful in the latter application.
Two main classes of algorithms are covered; (1) analytic ﬁltered back-projection algorithms, and (2) a group of model-based or algebraic algorithms. For the former class, a basic algorithm has been implemented, which does not take attenuation in the materials of the fuel assemblies into account     and which assumes an idealized imaging geometry. In addition, a novel methodology has been presented for introducing a ﬁrst-order correction to the obtained images for these deﬁcits; in particular, the effects of attenuation are taken into account by modelling the response for an object with a homogeneous mix of fuel materials in the image area. Neither the basic algorithm, nor the correction method requires prior knowledge of the fuel geometry, but they result in images of the assembly's internal activity distribution. Image analysis is then applied to deduce quantitative information.
Two algebraic algorithms are also presented, which model attenuation in the fuel assemblies to different degrees; either assuming a homogenous mix of materials in the image area without a priori information or utilizing known information of the assembly geometry and of its position in the measuring setup for modelling the gamma-ray attenuation in detail. Both algorithms model the detection system in detail. The former algorithm returns an image of the cross-section of the object, from which quantitative information is extracted, whereas the latter returns conclusive relative rod-by- rod data.
Here, all reconstruction methods are demonstrated on simulated data of a 96-rod fuel assembly in a tomographic measurement setup. The assembly was simulated with the same activity content in all rods for evaluation purposes. Based on the results, it is argued that the choice of algorithm to a large degree depends  on  application,  and  also  that  a  combination  of  reconstruction  methods  may  be  useful.  A discussion on alternative analysis methods is also included.
Keywords: Tomography Nuclear fuel Reconstruction Radon transform Analytic algorithm Algebraic algorithm
1.Applications for emission tomography on nuclear fuel assemblies
Emission tomography provides a means to obtain cross- sectional images of the interior of objects by performing external measurements of radiation being emitted from the objects under study. In this paper the utilization of emission tomography to determine important parameters of irradiated nuclear fuel assem- blies is discussed. The tomographic technique considered here is called SPECT (Single Photon Emission Computed Tomography), and it includes two basic steps: (1) the measurements of emitted gamma rays from the object and, (2) the mathematical reconstruc- tion of the internal source distribution in the object. This report focuses on the second step, the reconstructions.
A nuclear fuel assembly constitutes a very special type of object for tomographic measurements, with a highly  inhomogeneous  mix of strongly and less strongly attenuating materials, which has strong inﬂuence on the recorded data and its processing. There are several alternatives for the reconstruction of  cross-sectional  images and internal fuel properties. The purpose of this paper is    to present some of the different options that can be used to deduce quantitative rod-wise data, apply them on simulated data from a nuclear fuel assembly, and to ﬁnally discuss their respective advantages and disadvantages.
Two applications of SPECT on irradiated nuclear fuel assemblies are discussed in this paper; (1) nuclear safeguards veriﬁcations,  and (2) rod-level fuel characterization, with prerequisites that also affect the choice of reconstruction algorithm. These  applications are further described below.
1.1.Properties of nuclear fuel assemblies
The utilization of SPECT for investigation of nuclear fuel assemblies presents signiﬁcant differences and difﬁculties as compared to the medical applications, where the technique is well established. For medical applications, the objects of interest are often relatively homogenous (as compared to nuclear fuel assemblies) and have a comparatively low activity, typically in the order of 10 mCi (3.7 108 Bq). Fuel assemblies, on the other hand, are highly inhomogeneous and contain substantial amounts of radioactive material, with activities in the order  of  1 MCi (3.7 ~ 1016 Bq), i.e. about 8 orders of magnitude higher.
There are a variety of nuclear power plants in the world, each type with fuel assemblies of different sizes, which  contain  fuel rods in quadratic, hexagonal or circular conﬁgurations. This study is limited to Boiling Water Reactor (BWR) fuel. A  conventional BWR core includes typically 500–800 individual fuel assemblies, each weighing about 200 kg. Also for BWRs, there is a multitude of fuel types available on the commercial market, with various numbers of fuel rods in different quadratic conﬁgurations. An example of a BWR assembly is the SVEA96-S type illustrated in  Fig. 1. This speciﬁc fuel type consists of 96 fuel rods placed in four sub-assemblies  in a square regular pattern. Each fuel rod is about  4 m long and has a diameter of about 1 cm. The fuel is made of sintered uranium pellets (UO2) stacked into cladding tubes made of a zirconium alloy called Zircaloy. Water is guided through a Zircaloy fuel channel surrounding the rods.
Gamma-ray attenuation coefﬁcients for the main constituents of the fuel are presented in Table 1 for the two gamma energies of
Fig. 1. A nuclear fuel assembly of the SVEA96-S type and its somewhat simpliﬁed axial cross-section. This fuel type contains 96 fuel rods arranged in four sub- bundles, surrounded by a quadratic fuel channel and additional metallic structures separating the sub-bundles. The assembly has a length of about 4 m and the cross- section is about 15 ~ 15 cm2. (Left part of image presented courtesy of Westing- house Electric Sweden AB.)
Table 1
Attenuation coefﬁcients [m—1] for the two dominant nuclear fuel constituents and water for two gamma-ray energies of relevance for tomographic measurements.
137Cs and 140Ba,  which are of relevance for SPECT measurements,  as discussed below. (Depending on fuel property under study, there is a multitude of other gamma-ray energies of relevance as well.) Irradiated fuel assemblies are often stored in water for cooling and radiation shielding, and under such storage condi- tions, the volume surrounding the fuel rods is water. The large differences in attenuation in different materials imply a large contrast in attenuation proﬁles for gamma rays having different paths through the fuel assembly.
The strong attenuation of the fuel rods prevents, to a large extent, gamma quanta from escaping the fuel assembly. This  means that radiation emitted from central parts of the fuel contributes only weakly to a signal measured outside the fuel assembly, and the importance of this effect increases with decreasing gamma-ray energy and with increasing size of the fuel cross-section. Accordingly, one may expect accurate inclusion of the attenuation in the reconstruction algorithms to be required to obtain results with high precision.
1.2.Veriﬁcation of fuel assemblies' completeness
In many countries today, the management of spent nuclear fuel is based on an open fuel cycle, in which no part of the spent fuel is recycled. The current plan in e.g. Finland and Sweden is to encapsulate and dispose of the  spent  fuel  assemblies,  as  they are, in copper canisters in a deep underground geological repository.
In connection to this type of storage, safety and safeguards issues are highly important, and experimental veriﬁcations of the fuel are considered; the operator has a need to verify e.g. the residual heat and burnup [1] and the International Atomic Energy Agency (IAEA) must be assured that the information on the nuclear material is correct before the encapsulation  since it will  not be easily accessible afterwards [2]. At present, the IAEA has identiﬁed a need for new measuring techniques [3], e.g. with respect to verifying the completeness of a nuclear fuel assembly,
i.e. to ensure that all fuel rods are present. In this respect, tomography has been identiﬁed as a strong candidate,  and ongoing work addresses the expected performance of this techni- que for this purpose [4].
One constraint on the tomographic technique with respect to verifying assembly completeness in connection to encapsulation and ﬁnal disposal is that authorities may request stand-alone measurement and analysis, without any use of operator-declared information. Accordingly, there should be routines and algorithms available that do not require any detailed information on the fuel. However, the authorities may also request veriﬁcation of operator- declared data, in which case such data may be used in the analysis. As discussed in this paper, the former case, stand-alone veriﬁca- tion, poses particular challenges when it comes to quantitative assessment of fuel-rod activities and discrimination of fuel rods from background.
An important consideration is what gamma energies to mea- sure. 137Cs is an abundant isotope in the fuel, and it has a long half- life of 30.2 years. Accordingly, the 662 keV gamma radiation from 137Cs decay will be readily available for tomographic measure- ments in preparation for encapsulation, and it has been used in the demonstration of the reconstruction algorithms in this work. For fuel with shorter cooling time, there is also a multitude of other energies that may be used, and there are numerous fuel geome- tries available in the commercial nuclear power community, other than the SVEA-96 type presented in Fig. 1. The results presented here should thus not be interpreted in absolute terms, but rather as a survey of some algorithms that may be used for quantitative assessment and as an example of what results can be expected when applying them.
1.3.Rod-wise fuel characterization
Investigating the in-core behavior of nuclear fuel is relevant in commercial reactors, e.g. in cases where the mechanical or nuclear design of the fuel has been modiﬁed or when new or unexpected operating conditions have been applied to the fuel. Investigations are also performed in research reactors where experimental fuel and operating conditions are tested prior to their implementation in commercial reactors. The results are used to gain a better understanding of the fuel behavior for the relevant fuel design and operating conditions, and the correlations found are typically incorporated into core simulation and fuel design codes.
Fuel behavior is veriﬁed and/or investigated in-part through non-destructive methods, including gamma spectroscopy mea- surements, which are applied on-site at commercial nuclear power plants [5–7] as well as at research reactors [8]. However, in order to obtain rod-wise information of the contents of gamma- emitting isotopes in the fuel using gamma spectroscopy, it is
necessary to remove fuel rods for individual measurements – a time consuming process which risks damage to the fuel. As a less intrusive alternative, gamma tomography obtains rod-wise infor- mation without the need to dismantle the fuel. The relevance of  this technique for the nuclear technology community is demon- strated by the fact that a gamma tomography instrument for characterization of experimental fuel assemblies has just been taken into service at the Halden Boiling Water Reactor (HBWR) – a fuel and materials research reactor operated within the realm of  the OECD Halden Reactor Project [9,10]. Using this device, experi- mental  fuel  may  be  characterized  more  often   since   it   does not have to be dismantled  for  characterization,  and  it  may also be re-introduced into the core after assessment.  Of  primary interest are measurements of gamma-emitting isotopes such as  137Cs and 140Ba, which are markers for fuel burnup and power, respectively, and ﬁssion-gas isotopes such as 85Kr to assess the rod-wise ﬁssion gas release fraction. In all cases, quantitative assessment is requested, if available.
Quantitative tomographic measurements have previously also been applied for assessing the power distribution in a commercial nuclear fuel assembly, measuring the distribution of 140Ba on the individual fuel rod level [11]. As compared to gamma scanning [6], no dismantling of the fuel was required and hazardous handling of the fuel could be avoided. In these measurements, a quantitative tomographic algorithm was used that involves modelling of the gamma-ray transport using a priori information of the fuel geometry, similar to the algorithm presented in Section 3.2.4. The predicted distribution of 140Ba, obtained using the operator's core simulator, could be veriﬁed within the precision of the core
simulator,  which was  stated  to be  4%  (1σ).  Considering  that the
actual pin-wise source distribution was not known to a higher precision than the core simulator provided, it was not possible to state the actual precision of the tomographic measurement tech- nique itself.
2.Instrumentation for SPECT on nuclear fuel assemblies
2.1.General instrumentation features
The ﬁrst step in applying SPECT on a nuclear fuel assembly is to collect data from the gamma radiation around it. Collimators are used to deﬁne volumes in the assembly that contribute to the gamma-ray intensity in a speciﬁc detector position. Typically 1000–20,000 detector positions  distributed  on  30–120  angular  and 30–200 lateral positions are used for reconstructing one cross- sectional image of the fuel [12]. Each data point contains informa- tion on the number of counts registered in the detector in that particular position. Depending on detector type and data- acquisition system used, certain gamma-ray energy may be selected to enable analysis of a particular isotope's distribution.
The properties of irradiated nuclear fuel assemblies put high demands on the measuring equipment. The intense radiation requires adequate shielding of sensitive equipment, and thus collimators are relatively long and heavy. Moreover, the inhomo- geneous fuel assemblies require high precision in the positioning  of the detectors to be able to accurately interpret the data. Simulations have shown [12] that a positioning  uncertainty  of  only a few tenths of a mm would give unacceptably high uncertainties in the measured data for the case of evaluating the rod-wise power distribution.
2.2.Speciﬁc instrument design considered in this work
A cross-section view of the measurement instrument consid- ered in this work is schematically illustrated in Fig. 2. This
prototype device was used to demonstrate the applicability of the A(w ,w ) tomographic technique through experimental measurements on commercial  fuel  at  the  Forsmark  Nuclear  Power  Plant (NPP) in	RT
Sweden [11]. The device itself is described in detail in [13].
In the measurements presented in Ref. [11], the device was placed at the bottom of a fuel handling pool and a fuel assembly was placed in the water-ﬁlled axial fuel channel. Four gamma-ray detectors of the BGO scintillation type were used to record the gamma radiation around the fuel assembly by rotating (R) and translating (T) them into various positions relative to the fuel.
A heavy collimator package made of a tungsten alloy was used, where the slit opening for each detector was 300 mm long, 1 mm wide and 10 mm high. The detector-collimator system could be positioned at various axial levels so that tomographic data could be recorded at selected axial nodes of the fuel assembly. A spectroscopic measuring system was used for data collection and from recorded gamma-ray spectra it was possible to perform spectroscopic peak analysis. In the measurements presented in Ref. [11], the 1596 keV peak of 140Ba/La was selected, as it is representative for the power distribution in the fuel.
3.Algorithms for tomographic reconstruction
A set of reconstructions algorithm from two main classes are covered in this work: analytic and algebraic [14]. Algebraic reconstruction algorithms are in general computationally demanding, whereas they allow for a larger ﬂexibility in the level  of detail of information that is taken into account about  the  internal geometry of the actual object under study and other measurement conditions. Analytic reconstruction  algorithms  are in general more efﬁcient and faster, but allow for less ﬂexibility in
Fig. 2. Schematic illustration of the measurement set up, seen from above. The collimator and detector package could be rotated (R) and translated (T) to various positions around the fuel assembly.
Fig. 3. The Radon transform of an object is formed by taking a series of line integrals of a function through the object.Fig. 4. Relationship between the object function a(x,y), the measured projections
p(s,θ), their Fourier transforms and the Central Slice Theorem.
terms of modelling of exact measurement conditions. Further alternatives, other than the algorithms presented here, are dis- cussed in Section 6.
3.1.Analytic algorithms
3.1.1.General description
Analytic reconstructions algorithms are based on the Radon transform, presented in the beginning of the 20th century. The Radon transform (RT), also referred to as a projection, is a series of line integrals of some property of an object, as illustrated in Fig. 3.
The Fourier transform (FT) of the projection, P(w,θ), is related
to the Fourier transform of the object function along a central line through the object (i.e. the S axis in Fig. 3) through the  Fourier Slice Theorem. The Fourier Slice Theorem is also called the Central Slice Theorem since the Fourier transform of the object along a central line (i.e. along the S axis) is a slice of the object function's two-dimensional  Fourier transform, A(wx,wy), along that  line  [14].
Using these relationships the object function, a(x,y), can be estimated by obtaining projections at a series of angles, θ, around the  object,  performing   Fourier  transforms  of   the  projections  to
determine the values of the object's two-dimensional FT along the central lines, and ﬁnally by performing an inverse  two- dimensional FT to obtain the object function a(x,y). The relation- ships are illustrated in Fig. 4.
For the SPECT technique applied here, the sought-after object function is the gamma-ray source distribution within the object, and the measured projections (i.e. the Radon transform, p(s,θ)) are
the gamma-ray intensities measured by the detection system. Based on the measured intensities, the source distribution can be reconstructed by means of a variety of back-projection techni- ques [15], as illustrated in Fig. 4 and further described below.
One may note that the gamma radiation is subject to various physical processes in its transport from the source to the detection system, such as scattering and absorption, causing a loss of intensity, which is referred to as attenuation. To a ﬁrst approxima- tion, these effects may be excluded, and an image may be  produced by reconstructing the source term directly from its  Radon transform (i.e. the measured intensities). However, for a more accurate description, attenuation in the object needs to be included, and in this case the imaging problem concerns inverting the so-called attenuated Radon transform [16]. There are various solutions to these two problems, some of which are further discussed in the sections below.
3.1.2.Deﬁning the geometry for the case of SPECT on nuclear fuel assemblies
For the analytic reconstruction algorithms, we consider two different coordinate systems (X,Y) and (S,T) as illustrated in Fig. 5 as they correspond to the measurement device and measurements on nuclear fuel presented in Section 2.2. The two coordinate systems are used for deﬁning the tomographic projections and the image area.
The two coordinate systems shown in Fig. 3 are related via the angular coordinate θ as shown in the following equations:
@1
Fig. 5. Illustration of the coordinate systems superimposed over the measurement geometry for the device and measurements described in Section 2.2. (Here, only one detector element is illustrated.) The quadratic fuel channel is shown with circularly shaped UO2 fuel rods inside. Water surrounds the fuel rods inside the fuel channel, and water also ﬁlls the gap between the channel and the circular wall of the measurement device considered in this work.
Fig. 6. Illustration of the ﬁltered backprojection (FBP) process (BP¼ Backprojection).
@2
@3
@4
The intensity measured in the rotated coordinate system at position (s,θ) is denoted I(s,θ) and the activity distribution in the image is denoted a(x,y). The line parallel to the coordinate-axis T,
from the detector through the collimator slit, is called the line of sight.
3.1.3.Basic analytic reconstruction without attenuation
The simplest inversion of the Radon transform for SPECT involves the simpliﬁcations of excluding attenuation and solid angle effects (in reality, gamma rays emitted close to the detector are more likely to be emitted in the direction of the detector element) and not taking the ﬁnite width of the collimator slits into account. Solutions to the inverted Radon transform for this basic case are widespread and can be explained as following.
For a given angle θ, Eq. (5) describes the projection of the
source activity under these assumptions. The measured intensity, in the case of gamma-ray measurements, is simply assumed to constitute of the integrated source activity a(x,y) along the line of sight.
@5
The Fourier transform of this projection can, for the same angle
θ, be given as:
@6
where the variable w denotes the Fourier coordinate associated to the spatial variable s.
To deduce the source activity a(x,y), one needs to invert the Radon transform. There are several ways to do this; one of them is to base the inversion on the Fourier Slice Theorem, another is to use the ﬁltered backprojection (FBP) technique, as illustrated in Fig. 6.
According to the FBP method, the inversion of the Radon transform is  commonly written in two parts: a  ﬁltering part and  an integration part. The inversion formula (including both of these parts) is shown in the following equation:
@7
The inﬁnite integral over w in Eq. (7) assumes inﬁnitely small spatial sampling steps, but in reality the integration limits are determined by the sampling frequency. The function F(w) repre- sents a ﬁltering function that is generally applied to improve the image quality. A number of ﬁlter functions may be applied, including Windowed ramp, Hamming, Hann, and the Notched ramp ﬁlter suggested in [16]. In Section 4, examples of images obtained when applying different ﬁlters are presented.
In practice, the ﬁltering can either be done before or aftercalculation of the inverse Fourier transform, IFT. However,  the ﬁlter is more straightforward to apply in the frequency domain  and here we perform it before the inversion.
One may note that the solution in Eq. (7) assumes perfect collimation, i.e. that only activity along a line t, the line of sight, contributes to the detected intensity.  The experimentally measured
contributions, however, are determined by the device design and in particular the dimensions of the collimator slit(s). In addition, when using Eq. (7), the contributions to the intensity are weighted equally along the line of sight, ignoring the isotropic emission of the gamma quanta. Furthermore, gamma-ray attenuation inﬂuences the mea- sured intensities, which is particularly important for objects com- prising heavy materials such as nuclear fuel. Of these effects, the gamma-ray attenuation is considered to have the strongest effect on the results for nuclear fuel assemblies and possible methods to account for attenuation are discussed below.
3.1.4.Implementation of the basic analytic algorithm
Regarding implementation of the basic analytic algorithm, it should be noted that Eq. (7) is valid for the continuous case of inﬁnite sampling; however, in the numerical implementation, a discrete Fourier transform must instead be applied due to  the  ﬁnite number of lateral and angular measurement positions. It should also be pointed out that the application of a discrete pixel pattern in the reconstructions implies that interpolation must be applied between adjacent data points in the  intensity projections. In this work, linear interpolation is applied.
3.1.5.Taking attenuation into account in analytic reconstructions
In many SPECT applications, attenuation inﬂuences the recorded gamma-ray intensities signiﬁcantly, and image quality may be enhanced by taking attenuation into account. In this context, one should   acknowledge   the   very   strong   attenuation   in  the   case of
measurements on nuclear fuel, as discussed above. There are several analytic methods available for attenuation correction in SPECT. The initial efforts from the late 1970s and early 1980s included homo-geneous and constant attenuation inside convex  objects  [16,17],  and an often-applied algorithm is the attenuated or exponential Radon transform. Several inversion formulae are suggested, such as the original formula proposed by Tretiak and Metz [16] and the one proposed by Novikov [18]. In addition, iterative methodologies have also been proposed, such as Chang's method [19]. One may also consider utilizing the FBP image as an initial guess of the activity
distribution and subsequently processing the image with a statistical algorithm during which the attenuation matrix is implemented [20].
3.1.6.Implementation of a ﬁrst-order correction for attenuation to fuel images from analytic reconstructions
In this paper, we suggest a novel approach to make a ﬁrst-order correction for attenuation in cases when no a priori information is available on the internal fuel geometry, which is relevant in measurements where the completeness of nuclear fuel assemblies is to be veriﬁed (see Section 1.2). We conclude that objects of similar dimension and materials composition, such as a family of different nuclear fuel assembly types belonging to  one  reactor type, will give a similar response to measurement data obtained using the same measurement setup and the same reconstruction algorithms and settings. Accordingly, the response of the measure- ment and analysis system can be characterized and a posteriori corrections made to the reconstructed images. This approach is relevant in case the internal structure of the object is to be considered unknown, but yet a ﬁrst-order correction based on general object properties is desired.
The correction method implemented in this work is based on the simulation of a virtual object, which covers the same cross-section as the fuel assemblies and which contains a homogeneous mix of fuel materials of the same composition as authentic assemblies. A homo- geneous source distribution is simulated in this virtual object, and the response of the measurement system is studied. Due to attenuation, basic analytic algorithms will return lower reconstructed activities in the central sections of this object, similar to the response to authentic fuel assemblies. The deviation of the reconstructed distribution from the simulated, homogeneous, distribution in this virtual object is interpreted in terms of a systematic error that occurs when assessing fuel-assembly-type objects. Consequently, a ﬁrst-order correction can be applied a posteriori to the reconstructed images, based on these deviations. One should note that the simulation of the virtual object must be executed for the same gamma-ray energy as the authentic object, and the same analysis must be applied on the virtual and authentic data for the correction to be valid.
Once a set of tomographic images have been reconstructed based on measured (or simulated) gamma-ray intensities from nuclear fuel assemblies, the correction is introduced according to the following procedure; (1) the detector response of the  measurement  system under consideration to the gamma-ray emission from a virtual object consisting of a homogeneous mix of fuel material is mapped by means of Monte Carlo simulations. Referring to the measurement geometry under study in this work, illustrated in Fig. 5, this virtual object covers the same area as the fuel  assembly  in the image,  and  just like in this setup, the simulation includes a water-ﬁlled steel cylinder surrounding the object; (2) a reconstruction is performed based on the simulated data from the virtual object using the same algorithm, ﬁlter and pixel pattern as for the reconstructions of data from nuclear fuel assemblies. Due to gamma-ray attenuation, the reconstructed activity concentration in the central parts of the virtual
object   will  be  lower   than   in  its  peripheral   parts,   in  spite   of the
homogeneity of the simulated distribution; (3) the deviations of the reconstructed activity distribution from the simulated, homogeneous, distribution is analyzed, and a correction matrix is deﬁned that returns the homogeneous distribution when applied to the recon- structed image; (4) in the analyses of the fuel assembly data, the same correction matrix is applied a posteriori to the reconstructed images, to provide a ﬁrst-order correction to attenuation. This procedure is exempliﬁed in Section 4.2.2.
One may particularly note that when no a priori information of the assembly geometry is available, the deduction of quantitative rod-by-rod data from a reconstructed image of a fuel assembly requires that the fuel rods can be identiﬁed in the image, preferably using automated analysis. In this work, automated image analysis techniques have been used, and in this procedure the suggested a posteriori correction enables more straight-forward identiﬁcation of fuel rods in the image and a ﬁrst-order estimation of their relative source contents.
3.2.Algebraic algorithms
As discussed in Section 2.1, a nuclear fuel assembly is a well- known object with respect to geometry and composition, and its inhomogeneity has a large impact on the measured gamma-ray intensities. Using algebraic algorithms, the geometry and compo- sition may be taken into account in the tomographic reconstruc- tion procedure to model the gamma-ray transport through the fuel in detail and thereby to improve the precision in the reconstructed relative source distribution. However, as discussed above, such information may not be available for all applications.
In this section, two algebraic algorithms are presented; one where images are reconstructed making use only of knowledge of the general material composition of nuclear fuel, and; one where detailed information on the fuel geometry is taken into account to reconstruct conclusive rod-by-rod data. Of these two, the former may be the only option in cases when no a priori information can be taken into account, such as the application described in Section 1.2, whereas the latter may be used in cases when detailed geometric and composition information is readily available, which may be expected in the applications described in Section 1.3.
3.2.1.The algebraic approach
In this approach, the sought-after activity distribution is represented by the activities in N picture elements (pixels) in an axial cross-section of the fuel assembly. The gamma-ray intensity measured in a detector position m can then be mathematically deﬁned as:
@8a
where Im is the measured intensity, An is the sought-after quantity, i.e. the activity in each pixel element n, and ωmn is the probability that gamma radiation emitted from pixel n will be detected in detector position m. ωmn are here called contribution coefﬁcients and these are calculated or estimated using known information about the measurement setup.
For measured intensities in a large number of positions, m A 1,
M, an equation system is obtained:
@8b
@8c
Accordingly, after calculating the contribution coefﬁcients and measuring the gamma-ray intensities, the activity distribution can be reconstructed by solving the equation system. In this work an iterative solution technique called ASIRT (Additive Simultaneous Iterative Reconstruction Technique) [21], [22] has been adopted. The algorithm updating the activities from an iterative step, k, to the next is shown in the following equation:
@9b
ASIRT is judged appropriate for the purpose considered here, but several other solution techniques may also be used [23]. Still, the most sensitive part in reconstruction is considered to be the calcula-tion of the contribution coefﬁcient matrix W. For an informative reconstruction to be possible, the application of a relevant represen- tation of the coefﬁcient matrix is crucial.
3.2.2.Calculating the contribution coefﬁcients
The calculations of the contribution coefﬁcients can be very complex, depending on the gamma-ray source spectrum, the geometry of  the measured object and the detection system used. To decrease the level of complexity, only full-energy transport of mono-energetic gamma rays is considered in this work and elastic scattering is also neglected. To justify these assumptions, measur- ing equipment that is conforming to these considerations must be used, i.e. having spectroscopic capabilities so that a full-energy peak can be selected, such as that employed in Ref. [11].
In a ﬁrst-approximation, the two-dimensional approach, the coefﬁcients depend on the solid angle covered by the detector, as seen from the pixel, and on the attenuation of the gamma-rays at the selected energy, Eq. (10). The collimator is assumed to be ideal,
i.e. no gamma rays are transmitted through the collimator mate- rial, only through the slits. In this relatively simple approach, the contribution coefﬁcients ωmn are calculated as:
@10b
where Adet,mn is the detector area that is exposed through the collimator slit for pixel n and detector position m, whereas Rmn is the distance between the detector and the pixel, μi is the attenuation coefﬁcient for material i and di,mn is the distance a
gamma-ray travels in that material from pixel n to the detector in position m.
Somewhat more detail is introduced by integrating and aver- aging over the pixel area according to the following equation:
@11b
where Sn is the area of pixel n, R(x,y) is the distance from point (x,y) in the fuel to the detector in position m and di(x,y) is the gamma-ray distance in material i from point (x,y) in the fuel to the detector in position m. An implementation of Eq. (11) has pre- viously been used for analyzing experimental SPECT data from nuclear fuel [24], showing promising results for the safeguards application discussed in Section 1.1.
In order to further enhance the precision of the technique for tomographic measurements on nuclear fuel assemblies, more rigor- ous calculations of the coefﬁcients have been performed [12], also involving (1) a three-dimensional approach, taking into account also the axial dimension of the fuel, while making use of its uniform geometry in the axial direction, and (2) gamma-ray transmission through the collimator material. The importance of the last point has been investigated in simulations of the gamma-ray transport in the device described in Section 2.2. For the gamma-ray energy simu- lated; 1596 keV, 16% of the gamma rays reaching the detector had been transmitted some distance through the collimator material, implying that this contribution is signiﬁcant. In this more detailed
approach, the coefﬁcients ωmn  are given by the expressions in the
following equations. For a full derivation, we refer to [12]:
@12a
@12b
where
hc¼ height of collimator slit
lc¼ length of collimator slit
b(x,y) exposed width of the detector in position m from position (x,y) in the fuel
μcoll ¼ attenuation coefﬁcient of the collimator material
The double integral of Eq. (12.b) covers the detector  area  that is not directly exposed through the collimator slit, whereas the outer integral relates to the z-coordinate in the  fuel.  It can  be noted  that Eq. (12.b) can be calculated separately as it does not include any properties of the measured object. Setting Eq. (12.b) to zero  implies that Eq. (12.a returns the ideal Line–Spread Function (LSF), without any gamma-ray transmission through the collimator material, which may provide a decent approximation in cases when the gamma-ray energy is low and the collimation is highly efﬁcient.
The integrations of Eqs. (12.a) and (12.b) are in practice performed numerically over a large number of gamma-ray emis- sion points in the pixels and detection points on the detector,respectively. However, for practical reasons, the gamma-ray trans- port distances di through the fuel are only modelled for one gamma-ray per emission point, which is a relevant approximation for detection systems where the detector is situated far from the fuel behind a narrow collimator slit, which is typically the case for measurements on irradiated nuclear fuel assemblies.
If available, details on the object and measurement geometry can be introduced for modelling the gamma-ray transport through the fuel matrix when calculating ωmn, as accounted for in Section 3.2.4.
However, if such information is not readily available, a more simpliﬁed representation of the contribution coefﬁcients can be used, e.g. as described in Section 3.2.3.
3.2.3.Algorithm assuming homogeneous attenuation in image area
A measurement situation where tomographic data is recorded on a nuclear fuel assembly where the internal composition is unknown may occur e.g. at an authority inspection of a fuel assembly for which no fuel declaration is available. (See Section 1.2.) In such a case, one can still take the strong gamma-ray attenuation into account in a simpliﬁed manner in the reconstructions by assuming the fuel contents to be a mix of the structural elements constituting a typical nuclear fuel assembly, i.e. uranium dioxide and Zircaloy. (If the measurement is performed under wet conditions, water should also be added to the mix.) This procedure is based on similar assumptions as the suggested a posteriori correction method for analytic images presented in Section 3.1.6, albeit in this case, attenuation is included already in the reconstruction, as part of the calculation of the contribution coefﬁcients using Eqs. (10), (11) or (12).
In the examples presented in this work, a quadratic pixel pattern is applied over the fuel cross-section, as illustrated in the left part of Fig. 7. The gamma-ray transport through a homo- geneous mix of materials, which is included when calculating the contribution coefﬁcients, is illustrated in right part of Fig. 7.
3.2.4.Algorithm modelling detailed measurement conditions
In  cases  where  the  fuel  geometry  can  be  considered known,
which is typically the case for the applications discussed in Section
1.3,  detailed  modelling  of  the  geometry can  be  incorporated into
Fig. 7. In cases where the actual fuel geometry is unknown, a quadratic pixel pattern can be applied over the fuel cross-section (left), and the gamma ray attenuation in the fuel area can be taken into account by assuming a homogeneous mix of fuel materials in the cross-section (right). The reconstruction will then yield a qualitative image of the internal source distribution, which may be used to identify fuel rods and draw rough quantitative conclusions of the rod-by-rod relative source contents, as further discussed in Section 4.3.1.
Fig. 8. For fuel assemblies with well-known geometry, one may use a priori information to improve the algebraic reconstructions, enabling the measurement of highly accurate, quantitative rod-by-rod data, as demonstrated in Section 4.3.2. Left: The pixel pattern can be adapted to ﬁt the regions containing gamma-ray emitting materials. Here, each of the 96 fuel rods in the studied SVEA-96 assembly is covered by 5 pixels and no pixels are assigned to other regions in the assembly. Right: The gamma ray attenuation in the fuel area can be taken into account in detail when calculating the contribution coefﬁcients by introducing exact estimates of the travel distances di through different materials in the fuel. In particular, the uranium dioxide of the fuel pellets, illustrated in grey shade, attenuates the gamma rays signiﬁcantly.
the calculation of the contribution coefﬁcients (Eqs. (10), (11) or (12)). First, one can make use of the a priori knowledge to assign pixels only to regions in the fuel that may contain gamma-ray emitting materials. (If the direct gamma rays from a solid ﬁssion product are measured, and the fuel is intact, only the fuel rods may contain the measured activity.) This assignment is equivalent to forcing the background in the image to be zero, which is justiﬁed if the background in measured data is negligible, a prerequisite that was considered valid for the measurements in Ref. [11]. Second,  the gamma-ray transport through the fuel can be modelled in detail. (It is a well-known fact that an accurate implementation of the attenuation improves the efﬁciency of the reconstruction, and detailed modelling enables better capabilities in terms of quanti- ﬁcation of relative rod-by-rod source contents.)
In this work, a pixel pattern with ﬁve pixels covering each fuel rod in a SVEA-96 assembly has been suggested, as illustrated in the left part of Fig. 8. No pixels are assigned to regions that do not contain any fuel. The selection of one central and four peripheral pixels per rod was made considering that there may be a radial distribution of ﬁssion products in the rods in actual fuel [20], and it also makes the reconstruction less sensitive to possible dislocations of individual fuel rods as compared to deﬁning only one pixel per
rod. In the demonstration presented in Section 4.3.2, the contribu- tion coefﬁcients have been calculated using Eq. (12), and in this procedure the detailed geometry has been taken into account to use the exact travel length of the gamma rays from each pixel through different materials on the way to the detector, as illustrated in the right part of Fig. 8 (cf. the right part of Fig. 7).
One should note that apart from the fuel geometry, the current position of the fuel assembly in the equipment is required for this detailed modelling to be performed. This information can be pro- vided by performing separate positioning measurements. However, it has also been shown that the position can be provided by means of image analysis [25] on a tomographic image, e.g. reconstructed the way described in Section 3.1 or Section 3.2.3.
4.Demonstration of the reconstruction algorithms
4.1.Simulated data set
Simulations of gamma-ray intensities in a tomography mea- surement have been performed using the Monte Carlo particle transport code MCNP [26]. The simulations correspond to
Fig. 9. The modelled geometry for the simulated gamma tomography measurements.
measurement of 662 keV gamma rays emitted in the decay of 137Cs in the fuel stack region of a SVEA-96 fuel assembly, in a measure- ment geometry based on the device described in Section 2.2. The fuel assembly consisted of 96 fuel rods with Zircaloy-2 cladding and UO2 pellets, as well as a Zircaloy-2 fuel channel and the assembly was located inside a water-ﬁlled pipe, corresponding to the centre opening of the measurement device  described  in Section 2.2. The pipe was modelled as stainless steel, and the volume outside the water-ﬁlled pipe and in the  collimator  slits was modelled as air.
Several simpliﬁcations in the geometry were implemented in order to reduce simulation time. Speciﬁcally, the height of the fuel assembly was truncated to 6 cm and the collimator material surrounding the collimator slits was truncated such that all lateral measurement positions for each angular position could be simulated simultaneously. 99 collimator slits were modelled where each slit was 1 mm wide and 10 mm high, and the lateral step was 2 mm. The length of each collimator was 30 cm, and the distance from the centre of the fuel to the collimator slit opening closest to the fuel was 18.45 cm. The gamma-ray intensities were extracted from the simulations using the gamma-ray ﬂux at the rear opening of each collimator slit. Fig. 9 shows the modelled geometry where the front end of the collimator slits can be seen to the right of the fuel (the slits extend to the right, albeit not illustrated in the ﬁgure), and the intensities obtained from the pictured measurement position are illustrated to the far right in the ﬁgure. The relative angle between the fuel assembly and the detectors was simulated at a step of 31.
The gamma-ray source was modelled as mono-energetic 662 keV gamma rays, and an energy cut-off was introduced at 661 keV, corres- ponding to measurements with high-energy-resolution gamma-ray detectors. The rod-wise source distribution was uniform and a homo- geneous internal source distribution in each rod was used. In order to reduce simulation time, a variance reduction technique called Source Biasing was used in MCNP to direct the emitted gamma rays pre- ferentially within a narrow conical volume towards the collimator slit openings and detectors. Uncertainties in the simulated measurements (i.e. in the MCNP tally results) depended on the measured intensity at the detector surface. The uncertainty in the higher intensity positions was generally about 3%.
In order to obtain a matrix for attenuation  corrections,  to  be applied on reconstructed images according to the procedure described in Section 3.1.6, a similar set of simulations was also performed for an object consisting of a homogeneous mix of radioactive fuel materials, covering the same cross-section as the fuel assembly in Fig. 9. The resulting correction matrix is presented in Section 4.2.2.
4.2.Analytic reconstructions
4.2.1.Basic image reconstructions
When the basic analytic reconstruction (i.e. FBP without attenuation compensation, Eq. (7)) is applied to the  simulated  data, the selection of ﬁlter affects the results in a very prominent way. In Fig. 10, three examples of images obtained using different ﬁlters are presented. The reconstructed images have been created using a square pattern of 55 ~ 55 pixels covering the simulated SVEA-96 fuel cross-section as illustrated in Fig. 7 (left).
One can conclude from Fig. 10 that a ﬁlter should be selected that brings forward the characteristic features of the particular object under study, while keeping noise at a low level. In this work, we have intentionally limited the number of ﬁlters and applied only a few standard ﬁlters described in the literature [27], and of these, we propose to use the Ramp ﬁlter, for which the contrast between rods and background is relatively strong and noise is well suppressed.
However, this ﬁlter returns an image that is strongly inﬂuenced by gamma-ray attenuation, which is not taken into account in this basic analytic reconstruction. This is manifested by lower reconstructed activities in the centre of the image, and it may be taken into account according to Section 4.2.2 below.
It is worth noting that since the analytic method is not based on prior knowledge of the fuel or measurement geometry, activity is also assumed to emanate from the space between fuel rods. Another notable feature of the FBP methods is that they typically return both positive and negative activity values, complicating the quantiﬁcation of activities. Here, we have selected to transform the reconstructed values linearly to a scale ranging from 0 (illustrated in white) to 1 (illustrated in black).
4.2.2.Correcting for attenuation
The capabilities to quantify activities in SPECT reconstructions generally improve when taking gamma-ray attenuation into account. However, as described in Section 1.2, there are applica- tions on nuclear fuel assemblies where there is a request not to assume any a priori knowledge of the object under study. Accord- ingly, taking detailed information about gamma-ray attenuation is not always possible.
As described in Section 3.1.6, we propose the introduction of a general a posteriori correction matrix in order to take attenuation into account in a ﬁrst-order  approximation.  Here,  simulated  intensities from a virtual object consisting of a homogenous mix of radioactive  fuel materials (see Section 4.1) were introduced in the FBP reconstruc- tion with Ramp ﬁlter, resulting in the reconstructed source distribution presented in the left part of Fig. 11. Based on this distribution, a correction matrix was deﬁned, which when applied to the recon- structed image, returns a homogeneous source distribution, as was simulated. This correction matrix is illustrated in the middle of Fig. 11. When this correction matrix is applied on the Ramp ﬁltered FBP reconstruction of intensities from a SVEA96-S fuel assembly (middle image in Fig. 10), it returns the image in the right part of Fig. 11.
At a ﬁrst glance, the corrected image (Fig. 11, right) does not differ signiﬁcantly from the original image (Fig. 10, middle). However, when it comes to quantiﬁcation of the relative source content in fuel rods identiﬁed in the image, there are signiﬁcant changes. This is further described in Section 4.2.3 below.
One may note that the object with a homogeneous mix of materials differs signiﬁcantly from the fuel assembly with its heterogeneous conﬁguration of fuel rods surrounded by water. Still, to a ﬁrst-order approximation it is relevant to introduce this type of correction in order to reduce the inﬂuence of gamma-ray attenuation. It can also be noted that with the FBP methods, much activity is assigned to the space between the fuel rods, which may complicate the identiﬁcation of fuel rods in the image.
4.2.3.Quantifying relative rod activities based on reconstructed images
The images presented in Sections 4.2.1 and 4.2.2 may be further processed using automated image-analysis techniques to identify fuel rods and extract quantitative rod-wise data. In this work, circular, fuel-rod-sized regions have been sought in the images,
Fig. 10. Images obtained when applying the basic analytic reconstruction algorithm on simulated data from a SVEA-96 fuel assembly using three different ﬁlters. A linear grayscale has been applied where the minimum reconstructed value is illustrated in white and the maximum value in black.
Fig. 11. Left: Image obtained when applying the FBP reconstruction on simulated data from a homogeneous mix of radioactive fuel materials, using the Ramp ﬁlter. Middle: Correction matrix that returns the homogeneous source distribution when applied to the left image, with white representing the smallest correction factor and black representing the largest. (Here, black represents a factor 2.16 times larger than white.) Right: Resulting image when applying the correction matrix on the reconstruction of data from a SVEA96-S fuel assembly. In all three images, the maximum pixel value is represented in black and minimum in white.
based on a maximized activity content using the techniques presented in [25].
Considering that it is  relevant  for  the  application  presented in Section 1.2 to assume no a priori information on the number of fuel rods in the assembly, the seeking algorithm was in this example instructed to continue until the whole image area was ﬁlled, i.e. one must expect that some regions analyzed comprise only background. For this application, the distribution of deduced activities in the actual fuel rods should be separated from regions in the background. Here, automated image analysis was performed to quantify activ- ities in the image from the basic reconstruction (Fig. 10, middle) respectively in the ﬁrst-order attenuation-corrected image (Fig. 11, right), resulting in the histogram of relative activities presented in Fig. 12. Here, areas corresponding to actual fuel rods are illustrated
using blue bars and non-rod areas using red bars.
When no correction for attenuation is applied, the relative standard deviation of activities in the identiﬁed regions that corre- spond to fuel rods (blue bars) is 17.8%. When attenuation correction is applied according to the method described in Section 4.2.2, the relative standard deviation in these regions is improved to 5.4%; however, the separation between activities in regions corresponding to actual fuel rods (blue bars) and non-rod regions (red bars) is less distinct. This is consistent with a visual interpretation of the image in Fig. 11 (right) where there is relatively little contrast between the fuel rods and non-fuel rod regions.
4.3.Algebraic reconstructions
Algebraic reconstructions of the simulated data set of SVEA96-S fuel have also been performed, using the algorithms presented
in Section 3.2. As accounted for in Sections 3.2.3 and 3.2.4, two modes of reconstructions have been executed: (i) image recon- structions based on a simpliﬁed, homogenized gamma-ray attenuation model, and (ii) rod-activity reconstruction based on detailed modelling of the actual fuel geometry. The former is relevant when no a priori information in fuel geometry may be used (according to the application described in Section 1.2), and the latter is relevant for applications where such information may be considered readily available (see Section 1.3).
4.3.1.Image reconstructions assuming homogeneous attenuation in image area
The image reconstructions presented below have been executed using a square pattern of 55 ~ 55 pixels, which is illustrated in Fig. 7 (left) superimposed on the simulated SVEA-96 fuel geometry. The contribution coefﬁcients were calculated using Eq. (12), assuming a region of homogeneous attenuation according to Fig. 7 (right). In order to illustrate the effect of incorporating gamma-ray attenua- tion in the reconstructions, one image was reconstructed where the attenuation value of the homogenized fuel material was set to zero and one where it was set to its nominal value, weighted by volume
fraction; μhom ¼ 0.451 cm—1. The images are presented in Fig. 13
using a grey-scale scheme where the maximum activity is repre- sented in black and zero activity in white.
Automated image analysis has been used to identify areas that may correspond to fuel rods in the image and extract quantitative data from the right image of Fig. 13, similar to what was done on the analytic reconstructions in Section 4.2.3. Again, the search for possible rods continued until the whole image area was ﬁlled. A
Fig. 12. Quantitative results in terms of relative activity contents in rod-sized areas in the Ramp ﬁlter FBP reconstructed image presented in Fig. 10 (middle) and the attenuation-corrected image in Fig. 11 (right), obtained using the automated image analysis techniques presented in Ref. [25]. For illustrative purposes, areas corresponding to actual fuel rods are illustrated with blue bars and non-rod areas with red bars.
Fig. 13. Reconstructed images using the algebraic algorithm where homogeneous attenuation is modelled in the fuel cross-section. The reconstructions are based on a square pattern of 55 ~ 55 pixels, and the effect of the gamma-ray attenuation is illustrated in a comparison between a reconstruction with zero attenuation (left) respectively with the nominal value of the homogenized attenuation coefﬁcient, μhom ¼ 0.451 cm—1 (right). In both images, the assembly cross-section is identiﬁable, but the right image's incorporation of attenuation is required to obtain a relevant representation of the assembly's inner parts.
histogram of relative activities is presented in Fig. 14, where identiﬁed areas corresponding to actual fuel rods are illustrated using blue bars and non-rod areas using red bars.
The results show that informative images may be obtained, provided that gamma-ray attenuation is taken into account, which may be used to identify fuel rods and extract quantitative relative rod-by-rod activities. Compared to the quantitative results obtained when performing analytic reconstruction, presented in Section 4.2.3, there is larger contrast between extracted  activities  in  actual  fuel  rods as compared to non-rod areas, i.e. image background is lower in the algebraic reconstruction, which is beneﬁcial for the identiﬁcation of fuel rods. One reason for the lower image background may be found in the inclusion of the actual measurement geometry in the algebraic reconstruction, modelling a collimator of ﬁnite size rather than assuming an ideal line-of-sight.
However, there are limitations when it comes to quantitative studies of rod-activity contents, which is exhibited by the relative standard deviation of rod activities of 16.7% in spite of all rods being simulated with equal activity. The variation in deduced activities occurs mainly due to the simpliﬁed approach of incor- porating homogeneous gamma-ray attenuation, which affects different regions in the image in different ways. In order to
improve precision, more detailed models must be introduced, as exempliﬁed in Section 4.3.2 below.
Another example of how these images can be used is determining the position of the fuel assembly in the measurement device, which has been demonstrated on experimental data in [25], yielding an accuracy within 0.11 in angular and 0.1 mm in lateral position.
4.3.2.Rod-activity reconstruction based on detailed modelling
As described in Section 3.2.4, in cases where the fuel geometry is known, via operator-declared information and/or analysis of tomo- graphic images, the fuel geometry can be modelled in detail when calculating the gamma-ray attenuation through the fuel matrix. Furthermore, the pixel pattern can also be adapted to the object geometry, so that pixels are only assigned to areas where the gamma- ray emitting isotopes measured are located, i.e. to the fuel rods.
When applying the algebraic reconstruction comprising detailed modelling to the simulated SVEA96-S data set in this example, a pixel pattern was selected where each fuel rod is covered by 5 pixels, as illustrated in Fig. 8 (left), making a total of 480 pixels. One may note that no pixels were assigned to regions in between the fuel rods. Here, the detailed modelling presented
Fig. 14. Relative activity contents in rod-sized areas in the right image of Fig. 13, obtained using the image analysis techniques presented in [25]. For illustrative purposes, areas corresponding to actual fuel rods are illustrated with blue bars and non-rod areas with red bars. The standard deviation of the rod activities (blue bars) is 16.7%.
Fig. 15. Reconstructed relative activity contents in each fuel rod, obtained in an algebraic reconstruction based on detailed modelling of the fuel geometry. The average value is one. For demonstration purposes, all fuel rods were simulated with the same activity content, and the standard deviation of the resulting rod activities is 0.87%.
in Eq. (12a) and (12b) was applied for calculating the contribution coefﬁcients.
A reconstruction was performed, which resulted in calculated activities in the 480 pixels covering the fuel rods. To get the relative activity in a certain fuel rod, the ﬁve pixels covering the rod were summed. The resulting relative values of the source contents in each fuel rod, obtained in this procedure are presented in Fig. 15.
These results support the conclusion from the experimental work in Ref. [11], that the tomographic measurement precision is on the per cent level. The results also indicate that the measure- ment precision is signiﬁcantly higher than the predictive capabil-
ity for pin power, stated to be 4% (1σ) for the fuel studied in [11],
and thus tomographic measurements may provide a non- destructive tool for more thorough validation of reactor-core predictions on the individual fuel rod level.
In spite of the detailed modelling applied, Fig. 15 exhibits a weak systematic effect with the peripheral fuel rods being reconstructed to slightly lower activities than average ( 0.3%), which may be due to e.g. low-angle scattering not taken into account when calculating the contribution coefﬁcients. However, this systematic deviation is smaller than the expected measurement precision in an actual measurement, and it may also be taken into account for a speciﬁc measurement setup if a proper benchmark is provided. One may also note that the precision is higher for peripheral rods, having a
standard deviation of 0.5% about their reconstructed mean value of 0.997, as compared to the 32 innermost rods, which have a standard deviation of 1.1% about their mean value of 1.003. This higher precision at the assembly's periphery is expected and unavoidable, because most gamma-rays that reach the detector are emitted from the assembly's peripheral rods, whereas the gamma rays from its internal rods are attenuated to a much larger extent, limiting the amount of information available from this region.
5.Conclusions on the applicability of tomographic algorithms for quantitative SPECT on nuclear fuel assemblies
5.1.General remarks
Nuclear fuel assemblies are a challenging type of objects for SPECT measurements, with strong and highly inhomogeneous gamma-ray attenuation. It has been argued that the attenuation should be taken  into account in order to return representative, quantitative rod-by-rod activities. However, the availability of a priori information about the internal geometry of the fuel assemblies depends on the application, governing the level of detail of which the attenuation matrix can be incorporated. Here, a set of tomographic algorithms for analytic and algebraic reconstruction of the activity distribution in nuclear fuel assemblies have been presented. The algorithms range from general algorithms with no attenuation taken into account to specially developed algorithms, where the gamma-ray transport through the  fuel is modelled in detail.
It has been shown that reconstructions using basic algorithms provide images in which the individual fuel rods of the assembly are clearly visible, albeit quantitatively affected by strong attenua- tion of the emitted gamma rays, particularly from the central regions of the fuel assemblies. For applications where no a priori geometric fuel information is available, algorithms to take general attenuation properties of nuclear fuel into account have been presented, which do not require any detailed information of the objects under study, and which present a potential to directly analyze the properties of a fuel assembly in terms of both fuel geometry and position in the device and in terms of fuel rod identiﬁcation and activity quantiﬁcation.
However, the precision obtainable using the crude methods to take general attenuation properties into account is relatively poor. If conclusive quantitative rod-by-rod data are requested, detailed modelling of the gamma-ray transport through the fuel matrix can be incorporated in algebraic reconstruction models, provided that the geometry of the fuel assembly is known and that its position can be determined or deduced from reconstructed images. As presented in Section 4, this type of analysis may provide relative rod contents on the 1% level, and as described in Ref [11], this algorithm has previously been demonstrated on experimental data to yield an accuracy within the stated precision of the core
simulation code POLCA-7 of 4% (1σ).
Accordingly, both the analytic image reconstruction and the rod- activity reconstruction algorithms can be important constituents of the tomographic technique and a combination of both may be valuable.
5.2.Veriﬁcation of the completeness of fuel assemblies
The possibility to use tomography as a nuclear safeguards tool to verify the completeness of a fuel assembly, i.e. to make sure that all fuel rods are present, has been discussed. For this application, stand-alone veriﬁcation is requested, i.e. one should take into account that no a priori information on the fuel and its internal structure may be available. A possible procedure for the data analysis in such veriﬁcation is suggested, involving two steps:
1.An image-reconstruction algorithm generates a cross-sectional image of the fuel assembly, which in principle can be presented as soon as the measurements are completed. Automated image analysis can be applied on-line to identify fuel rods in the image and extract ﬁrst-order quantitative estimates of their activity content. An inspector may study the image and the quantitative data online and make a preliminary statement on the completeness of the fuel assembly.
2.For fuel assemblies where the inspector is doubtful, geometric information about the fuel obtained from the images can be used in a more detailed rod-activity reconstruction using the algorithm described in Section 3.2.4. Using the conclusive rod- by-rod data obtained, a more conﬁdent statement may be given regarding the completeness of the fuel.
With respect to the ﬁrst step, the images may be reconstructed using either an analytic or an algebraic method. However, the results in this study indicate that attenuation should be taken into account to enhance the analysis capabilities of this type of images. Here, we have suggested either to characterize the measurement response and make post-corrections to the reconstructed data, or to include attenuation in a model-based image reconstruction. The results indi- cate that the difference between activities in regions in the image corresponding to fuel rods as compared to non-rod areas may be larger for the model-based reconstruction, which may facilitate the analysis. One reason for this could be that the model-based recon- struction also takes into account the non-ideal properties of the measurement system, in particular the ﬁnite width of the collimator slits, whereas the analytic algorithms assume an ideal collimator. However, further investigations should be performed to conclude which methods are most suitable for this type of analysis. There may for example be ﬁltering methods for the FBP reconstructions that may be more suitable than the simple Ramp ﬁlter employed here. There may also be other tomographic methods that are better suited for this type of analysis (see Section 6).
Finally, one should note that the capability to non-destructively obtain relative rod-by-rod data with a quantitative  precision  on the per cent level in a tomographic measurement analyzed with a model-based reconstruction, which takes actual fuel properties  into account, may be useful to resolve possible anomalies encoun- tered in any fuel veriﬁcation process.
5.3.Rod-wise fuel characterization
Gamma tomography may be used to deduce the rod-wise dis- tribution of selected isotopes without the need to disassemble the fuel for individual rod measurements. This rod-wise isotopic information may be used to validate core simulation results and evaluate fuel performance for the speciﬁc fuel and operating conditions, including experimental conditions where the fuel design or operating conditions are under evaluation. The fuel may then be reintroduced into the core for further irradiation and follow-up measurements may be per- formed during the entire lifespan of the fuel.
For this application, one may assume that a priori information on the internal geometry and composition of the fuel assembly under study is readily available. Accordingly, one may use detailed model- ling of gamma-ray attenuation in a model-based reconstruction of quantitative rod-by-rod activities. As presented in Section 4.3.2, such a procedure may return relative rod activities with a precision on the 1% level.
6. Outlook
This study covers only a limited set of reconstruction algorithms available. Other options may be considered, which may improve the capabilities to quantify the rod-wise content of gamma emitters in nuclear fuel assemblies. As an example, statistical methods may be implemented, with which FBP images can be reprocessed iteratively while introducing attenuation, see e.g. Ref [28]. Such methods have been used previously in SPECT measurements on individual fuel rods [20,28], but their usefulness for complete fuel assemblies has not yet been demonstrated.
Furthermore, one may consider applying gamma transmission tomography to map the attenuation in the assemblies and take it into account in a subsequent SPECT reconstruction. Such a method would be particularly attractive as an option to take detailed attenuation into account in cases  when  no  a  priori  information on fuel geometry may be assumed. However, the high level of activity in the irradiated fuel assemblies themselves implies the need for a very strong transmission source, which may not be practically possible in the event of measurements at a commercial site. Accordingly, such a procedure has so far only been applied at research institutions, e.g. in the measurement of a 21-rod bundle that was subjected to fuel melting and analyzed [29], and in measurements on individual fuel rods [20]. In spite of the small content of fuel material in the latter case, a 60Co source as strong    as 2.4 GBq still had to be used.
There is also room for further development of the reconstruc- tion procedures described in this work. The currently used analytical algorithms could probably beneﬁt from developing an iterative process, where the position of the fuel assembly is taken into account and more accurate modelling of the gamma-ray attenuation is included. Attention may also be given to considering geometrical effects in this type of reconstructions, such as the isotropic scattering of radiation, and the ﬁnite height and width of the collimator, which exposes the detector to unequal volumes in the front and the back of the fuel assembly. Also for the algebraic algorithms, further development is possible, e.g. by including low- angle scattering in the transport model.
In addition to the work on the tomographic reconstruction algorithms presented here, a new measuring device is currently being deployed at the OECD Halden Reactor [10]. With that device, it will be possible to further develop and evaluate the tomographic algorithms, and valuable, quantitative data on research reactor fuel may be measured. In the start-up of its use, the previously used gamma scanning technique [5–7] may be utilized to obtain a quantitative benchmark of the tomographic technique, but also even more accurate, destructive measuring techniques may be considered for such a benchmark.
Acknowledgements
The authors are grateful for the ﬁnancial support given for this work by the Swedish Radiation Safety Authority (SSM) under grant number SSM2014-94, respectively by the Swedish Research Coun- cil (VR) under grant number 80588801.
