<title>On-the-fly Estimation Strategy for Uncertainty Propagation in Two-Step Monte Carlo Calculation for Residual Radiation Analysis</title>
<author>Gi Young Han a, Do Hyun Kim b, Chang Ho Shin b, Song Hyun Kim b,*,
Bo Kyun Seo a, and Gwang Min Sun c</author>
<Affiliation>a  Korea Institute of Nuclear Safety, 62, Gwahak-ro, Yuseong-gu, Daejeon, 305-338, South Korea
b  Department of Nuclear Engineering, Hanyang University, 222, Wangsimni-ro, Seongdong-gu, Seoul, 133-791,
South Korea
c  Korea Atomic Energy Research Institute, 111, Daedeok-daero 989beon-gil, Yuseong-gu, Daejeon, 305-353, South Korea</Affiliation>
<year>2016</year>
<Jounral>NUCLEAR ENGINEERING AND TECHNOLOGY</Journal>
<Publishing_house>Elsevier</Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.net.2016.01.009</DOI>
<URL>http://dx.doi.org/10.1016/j.net.2016.01.009</URL>
ABSTRACT
In analyzing residual radiation, researchers generally use a two-step Monte Carlo (MC) simulation. The first step (MC1) simulates neutron transport, and the second step (MC2) transports the decay photons emitted from the activated materials. In this process, the stochastic uncertainty estimated by the MC2 appears only as a final result, but it is underestimated because the stochastic error generated in MC1 cannot be directly included in MC2. Hence, estimating the true stochastic uncertainty requires quantifying the prop- agation degree of the stochastic error in MC1. The brute force technique is a straightfor- ward method to estimate the true uncertainty. However, it is a costly method to obtain reliable results. Another method, called the adjoint-based method, can reduce the computational time needed to evaluate the true uncertainty; however, there are limita- tions. To address those limitations, we propose a new strategy to estimate uncertainty propagation without any additional calculations in two-step MC simulations. To verify the proposed method, we applied it to activation benchmark problems and compared the re- sults with those of previous methods. The results show that the proposed method in- creases the applicability and user-friendliness preserving accuracy in quantifying uncertainty propagation. We expect that the proposed strategy will contribute to efficient and accurate two-step MC calculations.
Keywords:
Error Propagation On-the-fly
Monte Carlo Residual Radiation
Stochastic Uncertainty
1.Introduction
Particle transport analyses are preformed to get responses (i.e., dose rate, flux, criticality, and power distribution) in a system. The Monte Carlo (MC) method, which is stochastic, is accurate. Therefore it is widely used in the particle transport and analysis fields. The MC approach calculates an average and uncertainty of the responses by its stochastic processes. The uncertainty of the response confirms the reliability of the response; thus, analyzers can directly use it to determine design parameters, design limits, and so on when using the MC method as an analysis tool.
Serial MC simulations might be required to analyze the particle transport phenomenon, such as fuel depletion cal- culations, the source term generation problem, i.e., the standby service water (SSW)especific safety requirements (SSR) option in MC N-particle (MCNP) [1], and residual radia- tion analysis from activated materials [2]. The problem in using serial MC simulations is an inability to accurately eval- uate the uncertainty. Usually, for such problems, researchers just use the average value of response estimated from the previous MC calculation as the input for the next calculation. As a result, the uncertainty computed in the last MC calcula- tion is underestimated because it does not consider the sto- chastic uncertainty generated in previous steps. Thus, to obtain reliable results, researchers need to properly quantify the uncertainty propagation caused by input uncertainty that occurs as a result of previous MC calculations.
The brute force technique [3] analyzes uncertainty propa- gation by repetitive MC calculations using the same input with different random seeds. Statistically analyzing the results produces the sample standard deviation and it is taken to be the true stochastic uncertainty. The method is accurate because its analysis well reflects the stochastic nature of pre- vious MC calculations. However, the computational cost can be extremely high because it requires a huge number of MC cal- culations to achieve reliable results for a complex problem.
To prevent this inefficiency, the Oak Ridge National Laboratory proposed an adjoint-based method using an error propagation formula [4]. The method derives a rela- tionship between the true stochastic uncertainty and the uncertainty computed from the previous MC calculation.
After estimating the adjoint flux,  the  method  calculates the true uncertainty. It has an advantage in estimation efficiency over the brute force method because it requires only one additional adjoint calculation. However, it has the following limitations and difficulties: (1) it assumes the covariance term in the derived equation to be zero; and (2) it requires an additional calculation to obtain the adjoint flux.
To overcome the limitations of previous methods, we propose a new on-the-fly estimation strategy for the true stochastic uncertainty of the two-step MC calculations to improve both efficiency and accuracy. The main idea of the proposed approach is that it estimates the information required to analyze uncertainty propagation by adopting importance estimation and covariance of source-term esti- mation in forward MC calculations [5]. In Section 2, we describe the proposed method in detail. In Section 3, we verify the proposed method using activation benchmark problems.
2.Materials and methods
Here, we briefly introduce the previously published methods to analyze error propagation. In Section 2.3, we describe our proposed strategy to estimate error propagation.
2.1.Overview of the brute force method
Fig. 1 illustrates a procedure for the brute force method. First, a seed number is randomly sampled for each simulation. Then, a two-step MC simulation is performed with the random seed numbers until the responses have a reliable distribution. After analyzing the type of response distribution from the MC simulations, the true uncertainty is defined as the sample standard deviation of the responses. This method can analyze uncertainty propagation without any assump- tions. However, the calculation efficiency is low because of the repetitive procedure.
Fig. 1 e Procedure for the brute force technique in a two-step Monte Carlo calculation. MC, Monte Carlo.
2.2.Overview of the adjoint-based method
For a convenient description of the adjoint-based method, we define  the  propagated  uncertainty  from  the  first  step  MC simulation (MC1) as a hidden uncertainty (sh). The uncertainty directly computed in the second step MC simulation (MC2) is defined  as  an  apparent  uncertainty  (sa).  The  combined  un- certainty (sc) is defined as the total MC2 uncertainty including the  hidden  uncertainty.  MC1  and  MC2  are  performed  inde- pendently;  therefore, the  relationships  among  the apparent, hidden, and combined uncertainties can be expressed as Eq. (1).@1
The purpose of error propagation analysis is to estimate  the hidden uncertainty caused by the stochastic uncertainty of the MC1. Hence, we express the relationship between the source strength and response in the MC2 as Eq. (2).
@2
where R is the response in the MC2, Si is the source strength of cell i computed from the MC1, and Ci is the response contri- bution of a particle with a unit source strength from cell i to R in the MC2. Using an error propagation formula, we can derive the equation for the standard deviation (STD) of R from Eq. (2) as shown in Eq. (3).
@3
where sR is the uncertainty in the response of the MC2 considering the uncertainty of the source, sSi is the STD of the Si, Sj is the source strength of cell j computed from the MC1,covðSi; SjÞ is the covariance between Si and Sj, sCi is the STD of the Cj, Cj  is the response contribution of particles with a unit
source strength from cell j to R in the MC2, and covðCi; CjÞ is the covariance  between C  and   C .  In  this  derivation process, the covariance between the response contribution and source
strength is zero because they are independent of each other. The first and second terms on the right side of Eq. (3) are induced from the stochastic uncertainty in the MC1, and the other terms stem from the uncertainty in the response contribution of the MC2. Therefore, the hidden uncertainty in Eq. (1) can be derived by using the terms originated from the stochastic uncertainty in MC1 as Eq. (4).
@4
With Eq. (4), Eq. (1) can efficiently estimate the combined
uncertainty in the two-step MC calculation if the response contribution and covariance information are obtained.  Based
on Eq. (4), Oak Ridge National Laboratory proposed its adjoint- based method for error propagation analysis [4]. They pro- posed a lower bound concept of the combined uncertainty as an approximation method. Generally, changes in the re- sponses in the MC1 proportionally affect the changes of the other responses in neighboring cells. Therefore, the covari- ance of the source strengths in neighboring cells will be pos- itive  ½covðSi;  SjÞ > 0].  Due  to  the  weak  relationships  of  cells separate from each other, the covariance can be approxi- mated  to  zero  ½covðSi; SjÞ y0].  Thus,  the  second  term  on  the right side of Eq. (4) is positive, and the first term on the right side of Eq. (4) can be defined as the lower bound of the hidden uncertainty and expressed as Eq. (5).@5
where Ci is a discrete value in a unit cell i; therefore, it can be further expanded by considering the energy spectrum of the source term in the MC2, as given in Eq. (6).@6
where CiðEÞ is the energy spectrum of the response contribu- tion of particles with a unit source strength from cell i to R, and fiðEÞ is a normalized source energy spectrum in the MC2. Because the physical meaning of adjoint flux is equal to the response  contribution,  it  can  be  replaced  with  ∅yi ðEÞ.  There- fore, Eq. (5) can be expressed as Eq. (7).
@7
Eq. (7) can estimate the minimum value of the hidden STD if   ∅yi ðEÞ  is  estimated  using  an  additional  adjoint-transport calculation. However, this method has the limitation of requiring an additional adjoint calculation. Also, adjoint fluxes estimated by other adjoint-transport calculators, such as deterministic methods, can cause inaccuracy because of  the methodological differences. In addition, to more accu- rately estimate the combined uncertainty, the covariance between the source strengths should be properly estimated and applied in the error propagation analysis.
2.3.Proposed strategy for error propagation analysis
To solve the problems caused by the adjoint-based method,we here propose an on-the-fly estimation strategy based on the forward-adjoint method [5] and union tally. First, to esti- mate the minimum hidden uncertainty, we calculate adjoint fluxes in the forward MC simulation. We modify Eq. (4) into Eq.
(8) by multiplying and dividing by Si and Sj.@8
Because the source strength in MC2 is proportional to the
response calculated from MC1 as shown in Eq. (9), sSi   and
covðSi; SjÞ can be expressed as Eqs. (10) and (11).@9
@10
@11
where RMC1 is the response of cell i in the MC1, s MC1  is the STD of  RMC1,  covðRMC1; RMC1Þ is  the  covariance  between  RMC1 and
RMC1, and P is a proportional constant that is the source strength in the MC2 divided by the response of cell i in the
MC1.
Using Eqs. (9e11), Eq. (8) can be rewritten in terms of RMC1
and RMC1, as given in Eq. (12).@12
Eq. (12) converts the response contribution term to SiCi, which is defined as the response due to the source of cell i in the MC2. Based on that definition, we can obtain SiCi directly during the MC2 [5]. First, the source particles generated in cell i are flagged, and then each response originating from each cell i can be scored. Through the procedure, SiCi can be estimated without additional calculation.
Also, to evaluate covariance covðRMC1; RMC1Þ in Eq. (12), we
introduce a union tally strategy with on-the-fly scoring. For the estimation, we define a union region that combines two subcells and score it during the MC simulation. Using an error propagation formula, we can express the error relationship between the union region and two subcells as Eq. (13). Then, by rearranging the equation, we can estimate the covariance between RMC1 and RMC1 using Eq. (14).
ij
@13
@14
where U is the response in the union region for cells i and j, and sU is the STD of the union region. By substituting Eq. (14) into Eq. (12), we can finally estimate the hidden uncertainty using Eq. (15).@15
3.Results
In order to verify the proposed strategy, we assumed residual radiation analysis problems. By applying the proposed method, we estimated the combined uncertainties. After that,
the  results were compared with those of  brute  force method and  adjoint-based  method.  In  Section  3.1,  we  describe the
results and analysis of the simple activation benchmark problem. In  Section  3.2,  analysis of  a  more realistic  bench-mark problem and concrete activation in an accelerator fa-cility is presented.
3.1.Results and verification of simple activation problems
We assumed a simple activation benchmark problem, as
Fig. 2 e Overview of the simple activation benchmark problems. (A) Eight-cell problem. (B) Twenty-seven-cell problem. (C) Sixty-four-cell problem.
Fig. 3 e Comparison of the original flux-to-dose factor (International Commission on Radiological Protection 116 anteroposterior direction) to the modified four-group flux- to-dose factors. DCF, dose conversion factor.
Table 1 e Four-group flux-to-dose factors used for the verification.
uniformly distributed in a rectangle (9.9 × 30 × 30  cm3) with	i	j
1 × 1010 #/s of source strength. Also, we assumed that a rectangular-type (15 × 30 × 30 cm3) target material entirely composed of 59Co was located at the right side of  the  neutron source. Cobalt-60 isotopes are produced by the (n,
g) reaction in the target material after irradiation from the neutron source. We assumed that the activity of 60Co was equal to its production rate. Cobalt 60 emits both 1.17-MeV and 1.33-MeV gamma rays for each decay process. Hence, in the MC2, the residual gamma radiation emitted from 60Co is used as the source term. The residual gamma dose rate is detected 5 cm apart from  the   activated   material   using   a   rectangular-type   (5 × 10 × 10 cm3) detector. The center points of the volu- metric source, target material, and detector are on the x-axis. For the activation analyses, we assumed that the benchmark problems are evenly divided as eight cells (2 cells × 2 cells × 2 cells), 27 cells (3 cells × 3 cells × 3 cells), and 64 cells (4 cells × 4 cells × 4 cells).
We used general two-step MC simulations to test the pro- posed scheme. For the transport analysis, we used MCNP extended 2.7.0 code [1]. For the neutrons, we used the JENDL/ HE-2007 [6] cross-section library. Also, we used the MGXSNP photon cross-section library [7] in the MC2 to perform adjoint- and forward-photon transport calculation. In the MC1, we calculated the production rates of 60Co in the target material for each cell using the F8 FT RES tally option in MCNP. We used the F4 tally to detect the residual gamma flux in the MC2 and converted it to the dose rate in the unit of microsievert per hour (mSv/h) by applying the International Commission on Radiological Protection 116 anteroposterior direction flux-to- dose conversion factor (DCF) [8]. For the uncertainty evalua- tion based on adjoint fluxes, we generated a four-group DCF, as shown in Fig. 3 and Table 1. The compositions and densities follow the National Institute of Standards and Technology database. We  applied  the  particle  histories  to  4 × 105  and 2 × 107 for the MC1 and MC2, respectively.
To get the adjoint flux in the forward MC calculation, we used an SCX card, which has the function of scoring the par- ticles originated from the certain source distribution in MCNP, in the MC2. Union tally method was realized by getting the additional union responses for couple of cells in MC1. Using the obtained information, covariance of the  union responses,
covðRMC1; RMC1 Þ  was  estimated  by  Eq.  (14).  In  this benchmarkproblem, all combinations of union responses were estimated.
After analyzing the responses and uncertainties, we calculated the combined STD with the proposed method. For comparison, we also used the brute force technique [3] and adjoint-based method [4]. To perform the analysis with the brute force technique, we evaluated 301 responses with changing random seed numbers. To analyze the uncertainty with the adjoint-based method, we performed multi-group
Table 2 e Comparison of the combined standard deviation estimated using each method in a simple activation benchmark problem.
Fig. 4 e Comparison of the combined standard deviation results (sc) estimated from each method in the simple activation benchmark problem. STD, standard deviation.
adjoint-transport calculation using the MCNP code [7]. We performed the adjoint calculation using the grouping table merge option parameter to interchange the phase spaces of the source and the response.
To compare the results, we estimated the combined STD using the brute force method. It was regarded as the reference value. Then we carried out the other calculations using four estimation methods: (1) the adjoint-based method (Method 1);
(2) forward-adjoint method (Method 2); (3) coupled adjoint- based method with union tally (Method 3); and (4) coupled forward-adjoint method with union tally (Method 4, proposed method), as shown in Table 2 and Fig. 4.
We found the apparent STD was highly underestimated; it was less than half of the minimum value when using the brute force technique, which is why the propagation degree of un- certainty from the MC1 should be estimated in two-step MC simulations. As shown in Fig. 4, Methods 1 and 2, the adjoint- based and forward-adjoint methods, respectively, produced quite similar results. However, the forward-adjoint method used in this study is more efficient and easier to apply because it does not require an additional adjoint calculation. Methods 1 and 2 continue to underestimate the combined uncertainty in comparison to the other methods because the covariance term in Eq. (8) does not properly estimate the combined un- certainty. The results from Methods 3 and 4, which consider source-term covariance, are within reference interval (Fig. 4). The analysis shows that: (1) the adjoint-based method considering a covariance term is accurate and (2) adjoint fluxes estimated by forward MC calculation can also accu- rately evaluate uncertainty.
3.2.Results and verification of concrete activation problem in accelerator facility
To prove applicability of the proposed strategy, we assumed the concrete activation problem in b-nuclear magnetic resonance experimental facility in RAON accelerator [9] as described in
Fig. 5. In the MC1, the secondary neutrons emitted from the bombardment of 70 MeV proton beam and targets of b-nuclear magnetic resonance experimental facility were used as the source term. It is assumed to be point source with angular and energy dependency and source strength of 3.81111 × 1013 neu- trons/s.   Also,   we   assumed   that   a   rectangular-type   (200 × 75 × 250 cm3) target material composed of the concrete including small amount of impurities (59Co, 151Eu, and 153Eu) was located at the left side of the neutron source. Cobalt 60, 152Eu, and 154Eu isotopes are produced by the (n, g) reaction in the target material after irradiation from the neutron source and they are the dominant sources of residual gamma radiation emitted from the activated concrete [10]. In the MC2, the re- sidual gamma radiations emitted from 60Co, 152Eu, and 154Eu isotopes were used as the source term. The residual gamma dose rate was measured 35 cm apart from the activated mate- rial using a rectangular-type (30 × 30 × 30 cm3) detector for each radioisotope source. For the activation analyses, it was assumed that the activated materials are evenly divided as 240 voxels (8 voxels × 3 voxels × 10 voxels).
For the transport calculation, the same transport code and
cross-section data were used as those of simple activation benchmark problem in section 3.1. In the MC1, we calculated the production rates of 60Co, 152Eu, and 154Eu in the target material for each cell using the FM card with MT ¼ 102 in MCNP. In the MC2, residual gamma dose rates were estimated in the unit of (mSv/h) for each isotope by the same manner of  the simple activation benchmark problem. Irradiation condi- tion was assumed to be 10 years irradiation and 10  years  decay. Hence, residual gamma dose rates at the 20 years after the first irradiation were evaluated for each radioisotope. The compositions and densities follow the National Institute of Standards and Technology database and ANSI/ANS-6.4-2006 [11]. We applied the particle histories to 1.5 × 106  and 1 × 108  for the MC1 and MC2, respectively.
For the uncertainty evaluation by adjoint-based method, four-group DCF described in Fig. 3 and Table 1 was used and Fig. 5 e Monte Carlo N-Particle eXtended (MCNPX) modeling for the concrete activation in accelerator facility benchmark problem. (A) XY cross-section of MCNPX modeling for b-nuclear magnetic (bNMR) resonance experimental facility in a RAON accelerator [9]. (B) XY cross- section of MCNPX modeling for residual gamma transport calculation. (C) XZ cross-section of MCNPX modeling for the target material.
the grouping table merge option parameter option [7] was applied. SCX card in MCNP was used to estimate the adjoint fluxes in the forward MC calculation. To estimate the source-term covariance, only the neighboring union re- sponses were evaluated in this benchmark problem. To perform the analysis with the brute force technique, we evaluated 101 responses with changing random seed numbers. After analyzing the combined uncertainty by each
Fig. 6 e Comparison of the combined standard deviation results (sc) estimated from each method in a concrete activation benchmark problem. (A) 60Co source problem. (B) 152Eu source problem. (C) 154Eu source problem. STD, standard deviation.
method,   four   methods   introduced   in   Section   3.1  were
compared in Fig. 6 and Table 3.
From the results, we found that the proposed scheme
(Method 4) still can accurately evaluate the uncertainty propagation in more realistic and complex benchmark problems within 95% confidence interval of the reference. In conclusion, our proposed strategy adopting importance
estimation and source-term covariance estimation in for- ward MC calculation has big advantages in applicability and user-friendliness because it does not require addi- tional calculations.
Table 3 e Comparison of the combined standard deviation estimated using each method in a concrete activation benchmark problem.
4.Discussion
In this study, we proposed an on-the-fly error propagation analysis strategy to efficiently estimate uncertainty in two- step MC calculations. The main focus is obtaining the in- formation to estimate error propagation during the two-step MC simulation itself. We used activation benchmark prob- lems to evaluate the  combined  uncertainties  estimated using the proposed scheme and compared the results with those from the adjoint-based method and the brute force technique. The results show that our proposed method can accurately analyze the error propagation within the confi- dence interval of the reference results calculated  by  the brute force technique. Also, our analysis reveals that even though the calculation accuracy of the proposed strategy is similar to that of previous methods, our method is more efficient because it estimates the uncertainty during the two-step MC simulations without  additional  calculations. As a result, the proposed scheme can be directly inserted  into MC code to estimate the combined uncertainties in two-step MC calculations.
Conflicts of interest
All authors have no conflicts of interest to declare.
Acknowledgments
This work was supported by a National Research Foundation of Korea grant funded by the Korean Government (numbers: 2014M2A8A1029801, 2012M2A2A6004263), a Project on Radia-
tion Safety Analysis of RAON Accelerator Facilities grant funded by the Institute for Basic Science (project number: 2013-C062), and the Innovative Technology Center for Radia- tion Safety.
