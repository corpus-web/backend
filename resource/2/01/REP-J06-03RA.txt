<title>A comparison between GATE and MCNPX for photon dose calculations in radiation protection using a male voxel phantom</title>
<author>Tiantian Cui, Zhanpeng Li, Shuyuan Zhang, Yidi Wang, Dandan Chen, Liang Sun</author>
<Affiliation>a.State Key Laboratory of Radiation Medicine and Protection, School of Radiation Medicine and Protection, Soochow University,Suzhou 215123, China;b.Department of Radiation Oncology, The Affiliated Cancer Hospital of Zhengzhou University, Zhengzhou 450008, China.</Affiliation>
<year>2018</year>
<Jounral>Radiography</Journal>
<Publishing_house> Elsevier</Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.radphyschem.2018.12.003</DOI>
<URL>https://doi.org/10.1016/j.radphyschem.2018.12.003 </URL>
Abstract
The purpose of this work was to validate GATE external photon beam dosimetry calculations in radiological protection. In this work, GATE Standard, Livermore and Penelope physics lists (PLs) and MCNPX were used to calculate fluence-dose conversion coefficients for Korean Typical MAN-2 (KTMAN-2) voxelized phantom. Six irradiation geometries, anterior–posterior (AP), posterior–anterior (PA), left lateral (LLAT), right lateral (RLAT), rotational (ROT) and isotropic (ISO) for monoenergetic photon beams from 10 keV to 10 MeV were simulated. Compared the simulation results between GATE and MCNPX, it was shown that the GATE results agreed well with MCNPX results with an average accuracy better than 2.24% for energies above 30 keV. Although good agreements were found for both GATE Standard and Penelope PLs and MCNPX, Livermore PL has better stability and it is slightly more accurate than Standard and Penelope PLs. Dosimetric results generated with GATE for the organs of KTMAN-2 are available as supplemental data. The results indicate that GATE could be safely used for external photon beam dosimetry. This makes GATE a viable option for Monte Carlo modeling of both imaging and absorbed dose in external radiological protection.
Key words:
GATE; MCNPX; fluence-to-dose conversion coefficient; KTMAN-2
1.Introduction
Dose deposition in human tissue due to exposure to ionizing radiation cannot be directly measured [1], Monte Carlo simulation has become the most suitable tool and gold standard for the dose estimate in the radiological protection[2]. MCNP/MCNPX, EGSnrc, Geant4, Fluka, PHITS [3-7] are examples of general-purpose Monte Carlo codes that have been used in radiological dosimetry. The Monte Carlo simulation was used for the dose conversion coefficients calculations for reference phantoms, such as proposed by the International Commission on Radiological Protection(ICRP) committee and other various computational human phantoms [8-15]. As recent computational phantoms have become more realistic, the mathematical phantoms in dose conversion coefficients calculations have become less and less. Now Monte Carlo is used in radiological dosimetry, both for reference dosimetry and voxel phantom visualization.
While for the image modelling of voxel phantom, the majority of Monte Carlo codes are too complex and not yet adapted to modelling visualization, except for Geant4 and specific Monte Carlo codes design for imaging. Geant4 offers a diversity of tools for importing or defining the complex geometry for modelling visualization, real-time response radiation sources, detection system and exporting the required output data. The code is continuously extended and improved with new functionalities. The reverse side of Geant4 is its complexity, and new users must spend a lot of learning time before they make effectively use of this object-oriented code written in the C++ programming language [16]. Moreover, when the Geant4 is used to model visualization phantom, it takes large memory and slow computing speed. Specific Monte Carlo codes design for imaging have been explicitly tuned for the purpose, which represents a major asset in terms of using convenience and efficiency and computing speed.
The simulation platform GATE was developed by the OpenGate collaboration [17] and released in 2004, initially for nuclear medicine diagnostic imaging applications, was the open-source Monte Carlo simulation platform supporting radiation modeling both for imaging and dosimetry [18]. GATE is based on Geant4 toolkit and through a user-friendly interface to make the design of Geant4-based simulation available. However, GATE has been used for external beam radiotherapy, it not surprised that GATE comes into used in the radiological protection field.
In a few years, GATE has come into widespread used in the field of nuclear medicine, especially for scintigraphic equipment and image modelling. There are several papers present the validation of scintigraphic systems compared to experimental acquisitions, in SPECT [19-22] or in PET imaging [23, 24]. While GATE has been widely validated in nuclear medicine imaging, new areas of development have been studied and a limited number paper reporting its application and validation works in the past few years [18].
compared the internal dose calculated by GATE/GEANT with the MCNP4B published data for mono-energetic photon energy of 0.01-1 MeV and electrons of 935 keV based on Zubal voxel phantom [26]. Specific absorbed fractions were calculated for photon energies of 10, 15, 20, 30, 50, 100, 200, 500, and 1000 keV using GATE/GEANT on Snyder phantom and compared to published MIRD [27]. Specific absorbed fraction were also calculated using GATE/Geant4 Standard and Livermore packages and compared with MCNPX and EGSnrc reference data based on International Commission on Radiological Protection adult male voxelized phantom with energies ranging from 10 keV to 10 MeV in three different source organs [28]. Daphnée Villoing	GATE (version 6.2) and MCNPX (version 2.7.a) to derive dosimetric parameters (absorbed fractions, specifc absorbed fractions and S-values) for the reference female computational model proposed by the International Commission on Radiological Protection in ICRP report 110 to validate GATE-based clinical scale absorbed dose calculations in nuclear medicine dosimetry [29].However, no dosimetry validation of GATE for external photon beam in radiological protection dosimetry has been presented to date.
Geant4	We explore the applicability of GATE for calculating radiation exposures by using voxelized phantom in radiation protection, validate GATE code in external dosimetry for photon sources by evaluating fluence-to-dose conversion coefficients for photon energies values ranging from 10 keV to 10 MeV. Fluence-to-dose conversion coefficients values are calculated using GATE Standard, Livermore and Penelope PLs are compared with results provided by MCNPX. This work takes an important step towards the development of fluence-to-dose conversion coefficients database using GATE. Such database should consist of fluence-to-dose conversion coefficients of different organs in different irradiation source geometries.
2.Materials and methods
2.1Male reference computational phantom
The geometry of the adult male reference computational phantom was obtained from the MCNPX input file of MCNP Medical Physics Geometry Database. It was developed based on a series of CT images from a Korean man of 35 years, 1.72 m and 68 kg. Phantom consists of 300×150 ×344 voxels with a voxel resolution of 2×2×5 mm3. Up to 58 organs were manually segmented, including 19 bone parts [30]. Anterior-posterior and posterior-anterior views of skeleton and internal organs in KTMAN-2 were shown in Fig 1. Skin, muscle, and adipose tissue were made transparent to clearly show skeleton and internal organs.
Figure 1. Anterior-posterior(left) and posterior-anterior (right) views of skeleton and internal organs in KTMAN-2[30]
2.2GATE Monte Carlo simulations
Figure 2. Frontal (left) and sagittal (right) views of KTMAN-2 in GATE
There were major differences between the required format of voxelized phantom for GATE and MCNPX. To read in MCNPX voxelized geometry, GATE needed to do the following works. Firstly, In-house code was written in the MATLAB language, to read the geometry of MCNPX input file and generate 344 slices DICOM images of the voxelized phantom. The pixel matrix of each images was 300×150, pixel size was 2mm×2mm, and the slice thickness was 5mm.
Then, importing DICOM images into VV software to convert MetaImage format file, because DICOM format was not supported for the GATE version 7.2. MetaImage format was composed of a header .mhd and raw image .raw[31]. VV is an open-source and cross platform image viewer, designed for fast and simple visualization of spatio-temporal images: 2D, 2D+t, 3D and 3D+t (or 4D) images, runs on Linux, Windows and Mac OS in 32 and 64 bits[32]. Frontal and sagittal slices of the male phantom in GATE can be seen in Fig 2.
GATE version 7.2 was used with the recommended Geant4 version 10.02p02 and Standard, Livermore and Penelope Electromagnetic (EM) PLs were evaluated. Standard EM PL, which was used by default in GATE and described electron and photon interactions between 1 keV and 100 TeV [33], was used in all simulations, taking into account electron impact ionization, multiple scattering and bremsstrahlung generation. Livermore EM PL employs interpolated data tables based on the Livermore library[34, 35] to describe electrons and photons interactions from 100 eV to 100 GeV [33]. Penelope EM PL provides models and processes for EM interactions were effective between 100eV up to 1 GeV [33]. The physical model which originally was developed for Penelope MC code [36] combines analytical approach for computation of cross-section of the diﬀ erent interactions with data from cross-section databases calculated in Seltzer and Berger work [37]. Algorithm Penelope 2008 was used in Geant4 beginning with version v.4.9.3[38].
GATE inherits the physics constructor which automatically builds the PL, Standard PL loads the Standard packages which was the recommended PL for medical physics application, Similarly, Livermore and Penelope PL constructor were set in order to load the description of physics process according to the Livermore and Penelope package. ALL PL adopt distance to boundary option set on by default and the number of bins in stopping power and mean free path tables was set to 220 bins [39].
GATE also inherits the Geant4 capability to set thresholds for the production of secondary electrons, fluorescence X-rays, etc. All primary and secondary particles created in Geant4 are in principle tracked to the end of their range.
However, the user can limit the number of secondary particles to be tracked, by inhibiting the production of secondary
particles whose range would be less than a user-defined value called the range cut[33]. The setting of range out helped to speed up the simulation time. In this work, for energies ≥ 1 MeV, a range out was 2 um for electrons and photons; for energies <1 MeV, a range out was 1 um for electrons and photons.
A set of energies varying from10 keV to 10 MeV as shown in table 1 was simulated for several reference irradiation geometries (anterior-posterior, posterior-anterior, left-lateral, right-lateral, rotational, and isotropic) and considering 1000 0000 primary events. Simulations were performed by a high performance computer with an Intel(R) Xeon(R) E5-2660
2.2GHz CPU, 32 GB RAMs and the Ubuntu 16.04.1 LTS 64 bits operational system.
Table 1. Energy values used in GATE, MCNPX simulations
2.3MCNPX Monte Carlo simulations
MCNPX is a general-purpose Monte Carlo (MC) code[40]. It was developed at the Los Alamos National Laboratory and was designed to simulate transport of photons, electrons, neutrons and several heavy particles with energies up to 1 GeV for electrons and 100 GeV for photons. In this project, we utilized “Universe” and “Fill” cards, supported by MCNPX to describe the geometry, and the deposited energy were recorded by several *F8 tally cards. All calculations were performed in coupled electron–photon mode, using the el03 and mcnplib04 electron cross-section database. For all energies, the simulation geometries were the same as those described in sections 2.4. 1000 0000 source particles were simulated in each instance to reduce statistic error.
2.4Photon source configurations
The phantom was irradiated by photon with energies up from 10 keV to 10 MeV for six irradiation geometries: anterior-to-posterior (AP), isotropic (ISO), posterior-to-anterior (PA), left-lateral (LLAT), right-lateral (RLAT) and rotational (ROT). Each source was uniformly distributed on a plane; the reference vector was normal to the plane directing towards the phantom. The ROT geometry was a uniform parallel beam rotating around the long axis of the phantom at a constant speed. The ISO geometry was approximated by isotropic point sources distributed uniformly on a spherical surface centered at the phantom.
2.5Calculation of fluence-dose conversion coefficients
The absorbed dose in organs were estimated for the energies deposited in the voxels assigned to each organ divided by their masses. For MCNPX, the fluence-dose conversion coefficients could be calculated from the *F8 tally card recorded energies deposited in each organ or tissue DEP (MeV), divided by each mass, (kg), using the equation
@1
where, DT was average absorbed doses in organ T, unit, Gy; 1.602×10-13 was conversion constant.
As to GATE, the output file recorded average absorbed dose for per voxel, an in-house script was written in the MATLAB language to read output file and calculation average absorbed dose for each organ.
Based on the average organ dose absorbed, the dose conversion coefficients could be obtained by the below equations. First, needed to obtain fluence-to organ dose conversion coefficients DCCΦ in (pGy·cm2) by the equation
@2
where, Φ was particle fluence, cm-2; S was the area of source, cm2.
Then, obtained fluence-dose conversion coefficients by the equation
@3
where, Ka/Φ was per unit particle fluence air kerma free-in-air, pGy·cm2, available from ICRU Publication 47[41].
2.6.Data analysis
Obtained results with Standard, Livermore and Penelope PLs were compared to reference data and taking MCNPX as the reference, where relative difference between the GATE and MCNPX were given by:
@4
The absolute difference between the GATE and MCNPX were given by:
@5
2.6.1.Mean absolute difference ( ̅)
Given two set of data, each one with N elements. Comparison between them can be performed using the mean absolute difference ( ̅) of the intensity of each element:
@6
Such analysis quantifies the global discrepancy between the simulated and reference data. The standard deviation of
̅  was represented by:
@7
3.Results and discussion
Fig 3 and 4 show the comparison of fluence-dose conversion coefficients between GATE Standard, Livermore and Penelope PLs and MCNPX within the energy range of 0.01 to 10 MeV in AP and LLAT irradiation geometries. Four organs (skin, lung, stomach and liver) were selected to show the results. A good agreement was found between GATE Standard(Std), Livermore(Liv) and Penelope(Pel) PLs and MCNPX, with mostly less than ±2% of relative difference between the four dose conversion coefficients for energy values above 30 keV for lung, stomach and liver and all energy values for skin. Higher relative differences, however, were observed for low energy photons (below 30 keV) for lung, stomach and liver. These differences can be explained by the facts that, due to the short range of low energy photons,
with organs increased depths in human body, there are less photons can reach and deposit energy in lung, stomach and liver, causing a non-uniform distribution of deposited energy in lung, stomach and liver, except for skin. And the fluence-dose conversions are very low, for example, the fluence-dose conversion coefficients of GATE Standard,
Livermore and Penelope PLs and MCNPX in AP irradiation geometries for Lung are 4.30×10-7, 1.29×10-7, 0.00. Hence,
these relative differences are not considered significant.
Figure 3. Comparison of dose fluence-dose conversion coefficients for skin(a), lung(b), stomach(c)and liver(d) between GATE (Livermore, Standard and Penelope PLs) and MCNPX in AP irradiation geometries
Figure 4. Comparison of dose fluence-dose conversion coefficients for skin(a), lung(b), stomach(c)and liver(d) between GATE (Livermore, Standard and Penelope PLs) and MCNPX in LLAT irradiation geometries
Table 2 shows mean absolute difference ( ̅) values between Fluence-dose conversion coefficients calculated using
GATE Standard(Std), Livermore(Liv) PLs and Penelope(Pel) PLs with MCNPX at six irradiation geometries. This analysis shows how much the simulated values varies compared to the reference data. These values reveal a good agreement between the codes. The mean relative difference values between fluence-dose conversion coefficients calculated by Standard PL exhibit an overall bigger difference than those calculated by Livermore and Penelope PLs. It indicates that Livermore and Penelope PL shows to be more reliable codes than Standard PL. Besides, the mean absolute difference of smaller volume organs are higher than the other organs, i.e. thyroid glands and tests. These situations can be explained that, at the same irradiation geometry, there are less photons can deposit energy in the small organs, causing a less stable values between the four dose conversion coefficients.
Fluence-dose conversion coefficients obtained with GATE using Standard, Livermore and Penelope PLs exhibit an overall good agreement with the references values calculated with MCNPX. Fig 5 shows, for the energy value above 30 keV, the mean relative difference between fluence-dose conversion coefficients obtained with GATE Standard, Livermore and Penelope PLs with those calculated using MCNPX. When the energy values below 30 keV, some of the reference fluence-dose conversion coefficients are null, causing the mean relative difference is meanless.
Fig 5 indicates that the highest difference occurs at 30 keV and the differences are decreases with the increasing energy. This is because that, due to the short range of low energy photon, there are less photons can reach and deposit energy in organs, especially for deep organs in human body, causing the fluence-dose conversions are low and unstable.
Table 2. Mean absolute difference ( ̅) values between fluence-dose conversion coefficients calculated using GATE Standard(Std), Livermore(Liv) PLs and Penelope(Pel) PL with MCNPX
It is obvious that the mean relative difference of Standard PL is bigger than Penelope and Livermore PL. Standard PL agrees within an average of 1.97% with MCNPX and Penelope PL agrees within an average of 1.42% while Livermore PL	with an average agreement of 0.95%. Livermore and Penelope PL shows to be more reliable codes since they behave more stable than Standard PL. This is based on the higher difference for Standard PL with MCNPX. Moreover, Standard PL also exhibits the larger standard deviation of differences demonstrating a large variation of accuracy, indicating a lower reliability.
Fig 5 concerns how each GATE PL agrees with the reference code and it is possible to conclude that the best agreement relies in the comparison of Livermore PL with MCNPX. Although Penelope PLs also has a very good agreement comparison with MCNPX, it is a litter less reliable than Livermore PL. Besides, Livermore PL cover EM interactions down to 100 eV and provides more detailed and complex transport algorithms that uses directly experimental data. Therefore, the better results provided by Livermore PL relies on the better description of the physics processes.
Figure 5. Energy and mean relative difference.
.
4.Discussion and conclusions
In this work, we validated the usages of GATE for calculating photon fluence-dose conversion coefficients in radiation protection by using a male voxel phantom. Fluence-to-dose conversion coefficients values for KTMAN-2 adult male voxelized phantom were calculated using Standard, Livermore and Penelope GATE PLs and compared with results calculated by MCNPX, with monoenergetic photons ranging from 10 keV to 10 MeV.
Based on the absolute and relative difference analysis, the discrepancies between GATE and MCNPX were better than 3%, except for a few points where the energy was found below 30 keV. The larger absolute and relative differences were observed as could expected in small organs of low energy. However, in that situation fluence-dose conversion coefficients are usually very small and contribute marginally to the irradiation. One can conclude that in small organs at low energy there are less particles deposit energy, causing small dose conversion coefficients and larger differences.
Another source of discrepancies comes from the different cross-section libraries used by the codes, they originate from independent nuclear models and evaluated from different laboratories. Nevertheless, for the simulation tools, even for using the same cross-section data set, the differences in the data-processing methods and particle transport algorithms probably can make discrepancies between these two codes.
Results show that, good agreements were found for GATE Standard, Livermore and Penelope PLs with MCNPX. When energies above 30 keV, Livermore PL has an average accuracy better than 1.53%, Standard and Penelope PLs with an average accuracy better than 2.24%, 2.17%. Although good agreements were found for both GATE PLs and MCNPX, Livermore PL had better stability and it was slightly fit better than Standard and Penelope PLs. When the energy values below 30 keV, the higher differences between GATE PLs and MCNPX were observed. This is because that, due to the short range of low energy photon, there are less photons can reach and deposit energy in organs, causing the fluence-dose conversions are low and unstable.
For the simulation problems, even if a well agreement between these two codes is found, it cannot prove both are correct unless the simulations are consistent with accurate experimental measurements. However, in some conditions,
simulation results cannot be verified directly using the experimental measurements, such as measuring the accurate energy depositions in human organs. At such condition, cross verification of different Monte Carlo codes may provide indications for researchers and help find new applications features or potential bugs of the simulation codes.
Finally, this work demonstrats the versatility and potentials of GATE for dosimetry and radiotherapy applications. It implies that GATE might be used for radiation protection of photon, a new methodology is developed here, allowing to calculate fluence-dose conversion coefficients from energy spectrum simulated with GATE. Besides, the fluence-dose conversion coefficients calculated in this paper would be of great significance for analyzing the difference in photon dose conversion coefficients for Asian male.
FUNDING
This work was supported by Collaborative Innovation Center of Radiological Medicine of Jiangsu Higher Education Institutions, funding of the National Natural Science Foundation of China (Grant Nos. 11575124), the Priority Academic Program Development of Jiangsu Higher Education Institutions (PAPD), and the Nuclear Energy Development Project (No. 2016-1295).
