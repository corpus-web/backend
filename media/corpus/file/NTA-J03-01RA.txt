<title>MIGSHIELD: A new model-based interactive point kernel gamma ray
shielding package for virtual environment</title>
<author>Mengkun Li a, *, Zhihui Xu b, d, Wei Li c, Jun Yang a, Ming Yang a, Hongxin Lu d, Xinyu Dai d</author>
<year>2020</year>
<Jounral>Nuclear Technology</Journal>
<Affiliation>a School of Electric Power, South China University of Technology (SCUT), Guangzhou, 510640, China
b State Key Laboratory of Nuclear Power Safety Monitoring Technology and Equipment, Shenzhen, Guangdong, 581712, China
c Science and Technology on Reactor System Design Technology Laboratory, Nuclear Power Institute of China, Chengdu, 610213, China
d Fundamental Science on Nuclear Safety and Simulation Technology Laboratory, Harbin Engineering University, Harbin, 150001, China</Affiliation>
<Publishing_house>ANS</Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1080/00295450.2018.1432966</DOI>
<URL> https://doi.org/10.1016/j.net.2019.12.026</URL>
abstract
In this paper, 3D model-based interactive gamma ray shielding package (MIGSHIELD) is developed in
virtual reality platform for windows operating system. In MIGSHIELD, the computational methodology is
based on point kernel algorithm (PK), several key parameters of PK are obtained using new technique
and new methods. MIGSHIELD has interactive capability with virtual world. The main features made in
the MIGSHIELD are (i) handling of physical information from virtual world, (ii) handling of arbitrary
shapes radioactive source, (iii) calculating the mean free path of gamma ray, (iv) providing interactive
function between PK and virtual world, (v) making better use of PK for virtual simulation, (vi) plug and
play. The developed package will be of immense use for calculations involving radiation dose assessment
in nuclear safety and contributing to fast radiation simulation for virtual nuclear facilities.
Keywords:
Point kernel
Gamma ray shielding Virtual simulation
1.Introduction
When nuclear power plants are in normal operation, shut down for overhaul, decommissioning and emergency response, workers working in some areas with high radiation should take emergency measures in advance. High radiation dose level is easy to cause acute/chronic injury to human body, so radiation protection needs to be guaranteed [1]. Virtual simulation technology as a compre- hensive integration technology involves computer graphics, human-computer interaction, sensor, artiﬁcial intelligence and so on. Virtual simulation technology has been widely applied in nu- clear and radiation related work, such as: high-risk work simula- tion, exposure dose assessment to human, trajectory optimization of worker, radiation data ﬁeld visualization, nuclear and radiation workers training and public education. However, most of virtual simulation platforms developed for nuclear and radiation safety are none of radiation shielding calculation, most of special radiation dose calculation programs have no interaction to virtual world, for example MCNP [2] and FLUKA [3].
Monte Carlo algorithm (MC) is more suitable for dealing with particle transport problems in complex geometric space, but when the equipment size is large or the shielding body is thick, MC takes too long calculational time, especially for the large-size radiation data ﬁeld [10]. PK is more suitable for multiple sources and multilayered shielding calculation at reliable time [4]. PK based on analytical methods is much less computationally intensive than MC, so we determine that PK as the main core algorithm for radi- ation simulation in virtual world.
The application on PK based on 3D model is becoming prevalent and imperative, for example, Vela et al. [16] developed a code named CIDEC which uses the geometric modeling capabilities of CAD tools to construct the geometry for PK; Subbaiah and Sar- angapani [5] developed an interactive gamma ray shielding code IGSHIELD for windows operating system which is based on the PK employed in QADCGPIC (and hence QADCGGP) code. Yang et al. [14,15] developed PK codes named VTK and SPK for CAD model of arbitrary shape based on voxelization model and stylized model. However, these applications need much higher professional re- quirements for scholars and developers, and they have no inter- active calculation function with virtual reality platform.
Currently, some nuclear and radiation safety simulation plat- forms have many functions of good ALARA pre-job and simple ra- diation calculation, for example, VisiPlan [12] and VRdose [13]. But some virtual simulation projects of nuclear and radiation safety still need develop independent applications with special goals and functions. It takes much time to deal with interaction between radiation dose calculation and virtual world. So, we aim at designing and developing a package of interactive point kernel
Fig. 1. The structure of MIGSHIELD.
shielding calculation to realize plug and play, easy to use and interactive calculation with virtual world in this paper.
The rest of the paper is organized as follows: Section 2 presents the main idea of MIGSHIELD. Section 3 introduces the key tech- nologies of MIGSHIELD; Section 4 presents the important devel- opment works of MIGSHIELD. Section 5 shows the relatedexperiments and results. The paper is concluded in the last section2.Main idea2.1.Structure of MIGSHIELD
The structure of MIGSHIELD is shown in Fig. 1. The whole design ﬂow can be divided into four parts: virtual scene conﬁguring, physical information conﬁguring, geometrical processing and gamma shield calculation. In the 1st part, the arbitrary shape geometric models are built by 3D modeling software, arranged to form the scene in virtual platform. In the 2nd part, physical infor- mation of radioactive source (energy, activity, etc.) and shield are bound to the normal models by scripting, it is the basic of imple- ment of the interactive function between PK and virtual world. In the 3rd part, geometrical processing methods are developed for optical path calculation and geometrical discretization, which is the key of interactive function. In the 4th part, discretization of radio- active source and calculation of mean free paths from geometricalprocessing  are  developed  for  PK  to  calculate  the  dose  rate. Thephysical information is obtained from radioactive source model, for automatically calculating buildup factor and others. In addition, lightweight database is developed for saving parameters of PK.The data collected from virtual world is transmitted into PK core, and then the data calculated by PK is transmitted into the virtual world. The transmission and obtention of data between PK and virtual world reﬂect the interactive function of MIGSHIELD.
2.2.Point-kernel algorithm
In PK, the large volume sources are divided into predeﬁned smaller volumes, which can be considered as a point source with appropriate source weight. These point sources substituted as the large volume sources. From each of such a source point, optical path traversed in the source and shield media up to the detector location is estimated to calculate geometrical and material attenuations to get uncollared dose rate. Subsequently, this is multiplied with theappropriate dose buildup factor (accounts for scattered contribu- tion) to get total dose rate. Finally, the dose rate for entire volume source is obtained by summing over all the sampled points.
The dose rate at a detector position is calculated using the expression given below.
@
where, rp and rd are positions of point source and detector, E is photon energy, B (E, t) is the buildup factor, t(E) is the optical thickness from the point source to the detector, C(E) is photon ﬂux- to-dose rate conversion factor obtained from the 1977 ANSI/ANS [6] and the ICRP-21 [7].
The buildup factor is deﬁned as follows: in the passage of ra- diation through a medium, the ratio of the total value of a speciﬁed radiation quantity at any point to the contribution to that value from radiation reaching the point without having undergone a collision. So far, there have been a lot of achievements on buildup factor. In MIGSHIELD, the buildup factor is determined in two cases:
(1)for single-layer shielding, B (E,t) can be obtained from the ANSI/ANS-6.4.3 [11] and the Geometric Progression (G-P) formula [8], the buildup factor is calculated using the expression given below.
@
where, b、c、a、xk and d are ﬁtting parameters of G-P.
(2) for multi-layer shielding, the buildup factor is expected to be obtained by empirical formula proposed by Ref. [9]. Because MIGSHIELD is still in development, the multi-layer shielding calculation function has not been tested, the detail is not presented in this paper.
3.Methodology
The most above-mentioned methods based on PK, are capable of handling only regular geometrical volumes as sources, such as point, line, cylindrical, spherical, slab and so on. However, MIG- SHIELD can deal with models of arbitrary shapes, so geometrical
processing, physical processing and interactive point kernel calculation as cores of MIGSHIELD are described in this section.
3.1.Geometrical processing
In virtual world, source and shield are 3D mesh models which consist of a series of triangle. In VTK and SPK (2019a, 2019b), 3D model needs to be processed and transformed into voxel model and stylized model, and then optical path is calculated, and source is discretized according to these transformed models from stylization and voxelization. In MIGSHIELD, source is not transformed for discretization, and optical path is calculated according to polygonal mesh model in virtual world.
(1)Optical path calculation of gamma ray
Optical path calculation of gamma ray is the key process in MIGSHIELD. The shape of mesh model is arbitrary, so ray/shield intersection calculation is based on 3D ray/triangle intersection in computer graphics, as follows:
A triangle in a mesh has vertexes at A, B and C. The vector from A to  B  is  written  as   A!B	!A -!B ,  and  similarly  for  A!C ,  the  normal vector perpendicular to that plane ABC is given by !N	A!B	A!C . A point !p  in a triangle can be represented by a unique triple Cu,
v, wD such that !p	u A!B	v A!C	w!N . Point !p  is by translating A to
the origin !p	u A!B	v A!C	w!N	!A . A line deﬁned by !o     t!n  can
thus be transformed into the 3D space by@
The intersection point is obtained by@
This 3D ray/triangle intersection saves memory cache and calculational time by not associating a transformation matrix with each triangle.
Fig. 2 presents an illustration of ray/shield intersection calcu- lation. According to the positions of radioactive point source and detector, direction of a gamma ray from the radioactive point source to the detector can be simulated by line-segment.
According to 3D ray/triangle intersection calculation, intersec- tion triangles in this model are found and then the intersection points are determined. Fig. 3 presents the ﬂow of optical path calculation of ray traversing shields. Firstly, to obtain the shields from virtual world using collision detection from game engine. Secondly, to obtain the intersection triangles of gamma ray/shield using ray/mesh intersection. Thirdly, to obtain the intersection points of ray/triangle. Finally, to calculate the optical path according to these intersection points.
In MIGSHIELD, Axis Aligned Bounding Box (AABB) is a cuboid, instead of a 2D rectangle. AABB is deﬁned by a center point (posi- tion) and a half extent (size). The half extent of an Axis Aligned Bounding box represents half of the width, height and depth of theFig. 2. 3D ray/shield intersection calculation. The red solid line is a gamma ray from source to detector. The yellow wireframes are intersection triangles of ray/shield. The green points are intersection points of ray/triangle. The red dotted line is the optical path of ray/shield. (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to the Web version of this article.)
Fig. 3. Optical path calculation of gamma ray traversing shields.
(2)Axis Alignment Bounding Box for PK
box. Axis aligned bounding boxes are quite often used in computer graphics, for example for fast collision detection.
In MIGSHIELD, AABB is used for shield detection and geomet- rical discretization. AABBs of sources and shields need to be con- structed before gamma shielding calculation. AABB's construction and transformation is studied below.AABB's construction depends on wrapped mesh model. Ac- cording to the wrapped mesh model, we can obtain the minimumand maximum points of an AABB, and then calculate the center and
the half extent of AABB. Fig. 4 presents ﬂow of AABB's construction. In virtual world, 3D models are movable and transformable.
When the models are transformed, AABBs of them need to be changed in real time. The AABB's transformation depends on transformation matrix of the wrapped mesh model. When the wrapped mesh model is rotated in virtual scene, the previous maximum point and minimum point are not always maximum and minimum. If transformation matrix contains only scaling and translation of object, the maximum and minimum points is the product of previous maximum and minimum points and trans- formation matrix. If not, we should get previous eight vertices of AABB, then multiply the transformation matrix to get new eight points after the transformation. At last, center and half extent of new AABB is obtained according to the new eight vertices.
According to AABB, we can detect if a gamma ray traverses a shield roughly. If a ray does not traverse the AABB of the shield, it means the ray does not traverse the shield. If a ray traverses the AABB of the shield, it does not mean the ray traverse the shield, because AABB's size is larger than the wrapped object. So, a further detection between ray and shield need to be done. We adapt the intersection detection between ray and triangle to estimate if the ray traverses the shield and the intersection position.
Fig. 4. Flow of AABB's construction.
(3)Geometrical discretization for radiation source
Based on optical path calculation of gamma ray and AABB, geometrical discretization is designed to solve arbitrary shapes radioactive volume source. Fig. 5 presents the ﬂow of geometrical discretization for radiation source. There are four main steps in the ﬂow, (1) construction of AABB of an object; (2) establishment of traverse lines; (3) selection of effective traverse lines; (4) calcula- tion of discrete points.
The biggest area plane of the AABB is selected as the traverse line generating plane, the traverse lines from the plane to the opposite plane are homogeneous and perpendicular to the plane. Traverse lines go through the whole object, but traverse lines are obviously not as effective in all cases. If traverse lines are not collided with the object, these traverse lines are not effective, so they should be removed for saving memory cache and calculational time. According to the optical path calculation of gamma ray, all the intersection points can be calculated. According to the adjacent points in a same traverse line, the interpolation points can be calculated. Both the intersection points on the surface and the
interpolation points inside constitute the discrete points of radio- active volume source.
3.2.Physical processing
Besides geometrical processing, physical processing is a new feature of MIGSHIELD. The physical information of source and shield are different, for example, shield (density and atomic num- ber) and source (energy and activity). We build source class and shield class using C# language respectively, instead of input card of QAD program. The nonradioactive and non-shield models in virtual world are ignored. The extraction process of physical information is mainly realized by C# language. According to the class on model, type of model can be distinguished, and the physical parameters can be obtained and edited by programming and hand at any time. It is an important means to realize real-time interactive function for MIGSHIELD.
3.3.Interactive point kernel calculation
We combine geometrical processing, physical processing, and PK algorithm to develop an interactive point kernel calculation algorithm for virtual world. The ﬂow of interactive point kernel calculation algorithm for virtual world is shown in Fig. 6, including three parts: interaction function, geometrical processing & physical processing and PK algorithm core.
(1)get all the models from virtual world according to type at- tributes on the models, and then classify these models into shields, sources and others. (2) get different physical attributes from different models. All models are converted into point sources by geometrical discretization for radiation source. (3) calculate the optical path of gamma ray traversing the shield from a point source to a detector, calculate mean free path based on mass attenuation factors, calculate the buildup factor based on energies of radioactive source, calculate dose convertor factor and then calculate a dose rate of detector. (4) repeat the above (3) step until all the point sources are involved, and then calculate dose rate of the detector by the sum of dose rates from all point sources. (5) transmit the dose rate data into the virtual world.
4.Development of MIGSHIELD package
The biggest characteristics of MIGSHIELD package are plug and play, and easy to interact with virtual world. This section presents three main development works of MIGSHIELD, (1) virtual world for nuclear facilities, (2) The database used for saving important pa- rameters of PK, (3) Class structure designed based on PK algorithm and interactive function. The primary ﬁlegroups of MIGSHIELD are database and plugins. MIGSHIELD ﬁlegroups can be called by vir- tual reality platform.
Fig. 5. Flow of geometrical discretization for radiation source.
Fig. 6.   Interactive point kernel calculation for virtual world.
4.1.Virtual world
Virtual world contains 3D models and interactive functions. Geometrical processing and physical processing need objective information from the virtual world, and then convert them into PK- required data. So, preparing works for virtual world are essential, for example, build CAD model and initialize parameters of radio- active source and shield. In MIGSHIELD, all the sources and shields should be given corresponding source class and shield class scripts. If parameters of shields and sources are not assigned appropriately, the calculational result is wrong. In addition, accuracy of CAD model effects on the result of PK, for example, CAD model in virtual world is different from basic geometrical shapes in QAD.
MIGSHIELD is developed by C# programming language, it has been used for Unity engine successfully. Unity is a cross-platform game engine developed by Unity Technologies, the engine can be used to create three-dimensional, two-dimensional, virtual reality, and augmented reality games, as well be used for simulation appli- cation in industry. Unity as a lightweight engine also has been used for virtual simulation in nuclear industry, MIGSHIELD meets the current application need of virtual simulation of nuclear facilities.
4.2.Database
Real time calculation of PK will require a huge query power for photon ﬂux-to-dose rate conversion factor, buildup factor and so on.
Therefore, it is necessary to set up previously a database containing these parameters that could be queried by operators. We built the “BuildupFactor”, “DoseConvertor” and “MassAttenuationFactor” databases using xml script. Xml script is a lightweight database only used for storing data, so we developed data analysis functions of index, sort, query for xml database by C# programming. These xml ﬁles can be grouped to place in directory of virtual platform to use, without installing any database software. It satisﬁes our demands of easy to use and plug and play for virtual simulation.
4.3.Class structure
According to above mentioned key technologies of MIGSHIELD, the class structure is shown in Fig. 7. The classes contain public variables and main functions. Some main functions in classes are included completely and others may be omitted if not needed. The auxiliary classes of xml document, data transmission and proces- sion between PK and virtual world are not shown in this paper.
5.Experiments and results
In this section, three experiments are designed to verify the feasibility of the MIGSHIELD. The ﬁrst experiment is designed to test the feasibility of interactive function. The second experiment is designed to verify the dose rate accuracy of MIGSHIELD compared with other methods. The third experiment is designed to test the
Fig. 7. MIGSHIELD0 s class structure. Purple parts are basic classes, green parts are main classes, blue parts are auxiliary classes. (For interpretation of the references to colour in this
ﬁgure legend, the reader is referred to the Web version of this article.)
feasibility of MIGSHIELD in a more complex virtual world. All methods are run on a computer with a 2.80 GHz processor and
8.00 GB of RAM Windows operating system.
Fig. 8. Screenshot of optical path calculation. A: ray/triangle intersection detection, gamma rays traverse different shields; B: ray/triangle intersection calculation, red wireframes are intersection triangles, green points are intersection points. C: yellow line-segments are optical path. (For interpretation of the references to colour in this ﬁgure legend, the reader is referred to the Web version of this article.)
(1)Geometrical discretization for radiation source
5.1.
Interactive function experiments
Optical path calculation, geometrical discretization and trans- formation are tested and visualized to verify the interactive function.
(1)Optical path calculation
We built ﬁve mesh models: S-type tube, solid teapot, beveled tube, L-type surface and straight tube. The gamma rays traverse
Fig. 9. Screenshot of geometrical discretization. A: radioactive volume source model; B: AABB of sources and traverse lines; C: discretization point sources.
(3) Transformation of radioactive source
Table 1
Statistic of geometrical discretization for radiation volume sources with different shapes.Fig. 10. Screenshot of transformation of radioactive source.
these models. Fig. 8 presents a screenshot of simulation result of optical path calculation. The elapsed time of optical path calcula- tion for these models is less than 2 milliseconds. According to the results, the optical path calculation of MIGSHIELD is effective and feasible.
Four different geometries (S-type tube, solid teapot, beveled tube and straight tube) are selected as radioactive sources for testing geometrical discretization. The distance between the closest discrete points is 4 cm. The geometrical discretization of four ge- ometries is shown in Fig. 9. The statistic of geometrical discretiza- tion is shown in Table 1.
Whether the source is solid model or surface model, geometrical discretization is effective in virtual world. The discretization time for a mesh model depends on the number of mesh vertex. If a mesh model has a large of vertex, geometrical discretization needs much time. If the demand of accuracy of dose calculation is not high, it is best to optimize the model properly using CAD tool for reducing the vertex and triangles, but over-optimization would lead to distortion of the model.
A beveled tube is used to test the inﬂuence of transformation for geometrical discretization. When the tube is translated and rotated, geometrical discretization is done as shown in Fig. 10. Whether the object is translated or rotated, geometrical discretization for source is useful.
5.2.Unshielded dose rate calculation experiments
To further assess the calculational accuracy of MIGSHIELD, parallelepiped and cylinder source models are built for unshielded dose rate calculation. The energies of these sources are 1.5 MeV and the activity are 4.86 109 Bq. The sources  are  positioned at  the origin of the room, the detectors are positioned at  100, 150,  200, 250 cm away from the sources. The results obtained with MIG- SHIELD are compared in Table 2 with those obtained for the same geometries with MCNP.
5.3.Single-layer shielding calculation experiments
To further assess the calculational accuracy of MIGSHIELD, a virtual world is established for single layer shielding calculation, the calculational results of MCNP is from the paper (Yang et al., 2019a). In the scene, a cylinder volume source with radius of 50 cm and height of 60 cm is positioned at the position of origin aligned with the axis, a 2 cm thick slab shield is positioned at the position of
50 cm away from the volume source, and three detectors are selected at the positions of 150, 250, 350 cm away from volume source  respectively,  as  shown  in  Fig.  11.   The  source's  energy is
1.5 MeV, and the activity is 4.86   109 Bq. The source is distributed  in the air. Four typical shielding materials (aluminum, water, lead, concrete) are selected. The results obtained with MIGSHIELD are compared in Table 3 with those obtained for the same geometries with MCNP.
6.Discussion
The result from experiment 1 shows that the interactive func- tions are effective for optical path calculation and geometrical discretization in MIGSHIELD. The result from experiment 2 shows that the unshielded dose rate calculation in MIGSHIELD has acceptable correlation with MCNP. The result from experiment 3 shows that the single-layer shielding calculation for different ma- terials in MIGSHIELD has acceptable correlation with MCNP. At present, these experiment results meet our expectation and requirement of interactive shielding calculation in virtual world.
However, MIGSHIELD is still in development, multiple layers
Table 2
Comparison of MIGSHIELD with MCNP in unshielded dose rate calculation.Fig. 11. The screenshot of a single layer shielding calculation.
Table 3
Comparison of MIGSHIELD with MCNP in single-layer shielding.shielding calculation and large-size virtual world need more higher geometrical processing and numerical computing power for real- time shielding calculation, the related  development  have  not  been done. How to do the real-time computation of large-scale data in virtual world is our problem we're solving. These following works are important for MIGSHIELD in engineering applications, we will report our breakthrough about MIGSHIELD in the future.
7.Conclusion
In this paper, a new model-based interactive point kernel gamma ray shielding package for virtual environment has been developed. The experiment results show that MIGSHIELD is efﬁ- cient and feasible for interactive functions and shielding calculation in virtual world. Different from VTK, SPK and QAD, MIGSHIELD has no need of deformation and simpliﬁcation for 3D model. So, MIG- SHIELD has much more efﬁcient than the other methods. In addi- tion, MIGSHIELD is plug and play for virtual platform, and makes better use of PK for interactive virtual simulation.
Declaration of competing interest
We declare that we have no ﬁnancial and personal relationships with other people or organizations that can inappropriately inﬂu- ence our work, there is no professional or other personal interest of any nature or kind in any product, service and/or company that could be construed as inﬂuencing the position presented in, or the review of, the manuscript entitled, “MIGSHIELD:A new model- based interactive point kernel gamma ray shielding package for virtual environment”.
Appendix A. Supplementary data
Supplementary data to this article can be found online at
