<title>Single photon detection with the multi-anode CLAS12 RICH detector</title>
<Affiliation>a INFN Sezione di Ferrara and University of Ferrara, Italy
b INFN Laboratori Nazionali di Frascati, Italy
c INFN Sezione di Roma1 - Gruppo Collegato Sanità and Italian National Institute of Health, RM, Italy
d INFN Sezione di Genova, GE, Italy
e Thomas Jefferson National Accelerator Facility, VA, USA
f University of Connecticut, CT, USA
g Duquesne University, PA, USA</Affiliation>
<author>M. Contalbrigo a,∗, E. Aaron g, I. Balossino a, L. Barion a, F. Benmokhtar g, M. Benninghoff g,
E. Cisbani c, C. Cuevas e, C. Dickover e, A. Kim f, V. Kubarovsky e, V. Lucherini b, M. Mirazita b,
R.Malaguti a, A. Movsisyan a, P. Musico d, D. Orecchini b, B. Raydo e, P. Rossi e,b, A. Scarabotto a,
S.Tomassini b, M. Turisini a,b</author>
<year>2019</year>
<Jounral>Nuclear Inst. and Methods in Physics Research, A</Journal>
<Publishing_house>Elsevier BV</Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.nima.2019.04.077</DOI>
<URL>https://doi.org/10.1016/j.nima.2019.04.077</URL>
ABSTRACT
The first module of the hybrid-optics large-area CLAS12 RICH at JLab has been recently put into operation  using for the first time the well known Hamamatsu H8500 MAPMT and the new single-photon  dedicated H12700, for a total of about 400 MAPMTs and 25000 pixels.  The  photon  detector  must  efficiently  detect single photons in the visible and near-UV light region, provide a fast response for background rejection and pattern recognition, and have a spatial resolution of less than 1 cm over an area of ≈ 1 m2 .
Each front-end readout unit is composed of three electronic boards with specific tasks directly connected to groups of 2 or 3 sensors. The core of the readout is composed of MAROC3 and FPGA chips. The MAROC3 chip is able to discriminate the 64 signals from one MAPMT and to produce 64 corresponding binary outputs with 100% efficiency starting at a small fraction of the single-photon signal, while the FPGA chip provides 1 ns TDC capability with 8 μs maximum latency and acts as a DAQ controller. The system is designed to be almost dead-time free at the foreseen 20 kHz CLAS12 trigger rate. The best working conditions for single-photon detection have been studied at laser stands, test beams, and with the JLab electron beam data. A report of the photon detector preparation, commissioning and operation is here discussed.
Keywords:
Single-photon detection
Ring-imaging Cherenkov detectors Front-end electronics
Multi-anode PMT Digital readout1.The CLAS12 ring-imaging Cherenkov detector
In deep-inelastic scattering experiments performed with the CLAS12 spectrometer [1] at Jefferson Lab (JLab), hadron identification in the final state will be exploited to access quark flavour sensitivity, to enhance the discrimination power for rare processes and to study final state interactions [2]. A large-area ring-imaging Cherenkov (RICH) detector has been designed to achieve a pion rejection factor of the order of 1:500 in the momentum range from 3 GeV/c to 8 GeV/c at       a luminosity as high as 1035 cm−2  s−1. The adopted solution foresees  a novel hybrid-optics design based on an aerogel radiator, composite mirrors and a high-packed and high-segmented photon detector [3]. In order to achieve the needed performance and accomplish the physics programme while retaining the baseline layout of the CLAS12 spec- trometer, two symmetric radial sectors (out of six) of the gas Cherenkov detector are replaced with a RICH detector. Each RICH sector has a pro- jective geometry, a gap depth of 1.2 m and about 5 m2 entrance window area. A focusing mirror system has been designed to collect the light of large-angle particles and reduce  the  detection  area  instrumented by photon detectors to about 1 m2 per sector, minimizing costs and influence on the detectors (TOF and Calorimeters) positioned behind the RICH.
2.The photon detector
The goal of the CLAS12 RICH is to achieve a single photon-electron (SPE) Cherenkov angle resolution, dominated by the aerogel chromatic dispersion, of 4.5 mrad. The flat panel Hamamatsu H8500 Multi-Anode PhotoMultiplier Tube (MAPMT) [4] has been selected to achieve the design angular resolution, thanks to the enhanced sensitivity to the visible and near-UV light in conjunction with a matching geometrical layout of 64 pixels covering a 5 × 5 cm2 area with an excellent packing factor of 89%. Despite not advertised as the optimal choice in the
Fig. 1. The CLAS12 RICH readout unit design (see text for details).
Fig.  2.  (Left) Pedestal RMS, as measured on a test point, of the 192 channels of the  3× MAROC boards during the production quality assurance. The measured RMS values are below 4 mV while the single photo-electron signal is expected around 800 mV. (Right) Logic discrimination efficiency as a function of the MAROC channel, for a range of programmed thresholds. A test pulse corresponding to 60 fC, i.e. about 1/7 of the expected typical single photo-electron discharge, is generated by the programmable on-board pulse generator and injected in channel 23 of each chip. Close to the pedestal value, spurious fluctuations are discriminated in all channels (the efficiency defined as the ratio of counts over triggers appears greater than 1). At threshold values below the pedestal, the system digitized the undershoot of the bipolar shaped signal.
SPE regime, such MAPMT showed adequate performance in several laboratory tests [5] and at beam tests [6] when used in conjunction with an adapted readout electronics. Just after the RICH construction startup, the novel Hamamatsu H12700 became available, with the same layout of the H8500 but an optimized dynode structure for single photon detection [7].
The CLAS12 RICH is the first large-area detector to employ this type of multi-anode photo-multiplier. A total of 391 MAPMTs, corresponding to about 25 000 pixels, are needed to cover the about 1 m2 trapezoidal active area of the first RICH module. The production of the RICH photon detectors (80 H8500 and 320 H12700) has been completed,
achieving an average gain of 2.7 ⋅ 106, which corresponds to about 400 fC generated charge per SPE.
3.The readout electronics
The RICH front-end electronics is designed to ensure 100% effi- ciency at 1/3 of the average photo-electron signal level, 1 to 4 gain spread compensation, time resolution of the order of 1 ns to distinguish direct from reflected photon hits, and a trigger rate up to 20 kHz and    8 μs trigger latency.
The front-end electronics is organized in compact units (tiles) me- chanically designed to fit the MAPMT dimensions, each serving two  or three MAPMTs, thus allowing the tessellation of large surfaces with minimum dead space and material budget, see Fig. 1. Each readout unit comprises three boards with complementary functions.
A feed-through adapter board provides the electrical connectivity of the sensors with the external readout system while preserving the adequate light and gas tightness of the inner detector volume when
mounted on the RICH carbon fibre supporting panel. It also distributes the sensor bias voltage (with −1000 V as nominal value). The signal processing board is based on the MAROC3 chip [8], a 64-channel micro- circuit dedicated to MAPMT pulse processing. Each channel comprises a low impedance adjustable gain preamplifier followed by two highly configurable shaping sections with independent processing. The first section embeds a slow shaper and a sample and hold structure to allow linear charge measurements up to 5 pC. Requiring short trigger delays and multiplexed access, this feature is used as a RICH calibration tool. The second section features a fast shaper and an adjustable threshold discriminator to produce, for each input signal, a start and stop logic pulse. These are stored in a 8 μs deep circular memory allowing a parallel, almost dead-time free, readout. The fast shaper works in an almost saturated regime to maximize the discrimination efficiency. The MAROC chip is configured and read out by a FPGA board optically linked to the data acquisition back-end (DAQ) using the JLab Sub- System Processor (SSP), which resides in a VXS/VME crate. The current firmware version includes a 1 ns precision timestamping of the logic pulses.
A constant-threshold binary readout requires a good stability of    the baseline (pedestal) and definition of the working point (gain and threshold). Their programmed levels are here expressed as Digital-to- Analog Converter (DAC) units. During the board production, quality assurance tests confirmed the excellent sensitivity of the logical read- out, able to discriminate signals down to a few percent of a single photon-electron discharge, see Fig. 2.
4.Characterization and commissioning
Each readout unit was characterized in laboratory tests using a pico- second precision pulsed PicoQuant laser of 405 nm wavelength. A light diffuser was used in order to uniformly illuminate the whole sensitive area and integrate all the local variations of the sensor response. The laser pulse intensity was tuned and optical neutral density filters added in order to deliver on average 3 photon hits per MAPMT. The recorded single-photon spectra allowed to map the relative gain and efficiency of the 64 pixels of each MAPMT [9], see Fig. 3. All the MAPMTs were fully tested and characterization parameters were extracted by fitting a detailed model of the SPE spectrum, developed at JLab [10]. Data showed that the H12700 has, on average, a 10% better efficiency than the H8500, likely due to the improved photocathode performance. The recorded information can be useful for the likelihood definition of each particle hypothesis in the RICH reconstruction. In addition, the SPE spectra allow to study the efficiency dependence on the working parameters, i.e. MAPMT bias voltage, MAROC pre-amplification gain and threshold. Data indicated the efficiency reaches a plateau over        a wide range of working parameter values, see Fig. 4. The plateau would correspond to the region where all the MAPMT discharges are digitized and the efficiency ultimately depends on the quality of the photocathode. The plateau is a consequence of the saturated mode employed in the MAROC binary readout and allows a flexible definition of the working point, a crucial feature when dealing with a large number of channels in the challenging single-photon regime.
The RICH detector was installed in the CLAS12 experiment at    the beginning of January 2018. The electronics pedestal values were regularly monitored during the following engineering run and CLAS12 data-taking, as their stability is a crucial feature for the constant threshold readout. The pedestal level is different for each MAROC, but is relatively uniform within one chip, a feature conforming to the common discrimination threshold, see the left plot of Fig. 5. With    HV ON, the typical measured dark count rate is around 10 Hz/pixel,   in agreement with the Hamamatsu specifications. In the right plot of Fig. 5, the measured dark rate of one pixel of a H12700 MAPMT is plotted as a function of the discriminating threshold with MAPMT HV OFF (0 V) and HV ON (−1000 V), at the beginning and at the end      of the first physics run. The plot shows a large region of uniform
Fig. 3. (Left) Example of MAPMT efficiency map normalized to the maximum pixel efficiency. Data show an almost flat behaviour at values close to 1 except for the edge pixels. (Right) Example of MAPMT gain map normalized to the maximum pixel gain.  The visible 1:2 variation is expected for this type of sensors and can be compensated       by the electronics.
Fig. 4. Relative SPE detection efficiency as a function of the working parameters: bias voltage, MAROC preamplification gain and discriminator threshold. The plots show the dependence on two parameters while keeping fixed the third: bias voltage (left) or threshold (right). Data are normalized to the reference point at HV = −1000 V, gain
= 1 and threshold = + 50 DAC. Values greater than 1 are likely due to the cross-talk contribution.
Fig. 5. (Left) Pedestal map of the whole MAPMT plane showing the values within the same MAPMT are quite uniform. (Right) Count rate of one MAPMT pixel as a function of the discrimination threshold as measured at the beginning and at the end of the first CLAS12 physics run. A pixel with a dark count rate above the average is chosen for better visibility. The discriminated signals have been recorded within a programmed time window at each of the thresholds selected for the scan. The peak corresponds    to the pedestal (when the threshold equals the baseline), visible also at HV OFF. The tails are the dark count signals (bipolar after the shaping section) at HV ON. The shoulders around the pedestal are due to cross-talk signals. The almost flat behaviour up to 600 DAC is due to the large amplification (and almost saturated signals). The pixel behaviour is stable with time. Colour scales and threshold are in DAC units.
response above a very narrow pedestal (as expected from the laboratory characterization) that stays unchanged over time.
A typical feature of any constant threshold readout is the time-walk,
i.e. the dependence of the discrimination time on the signal amplitude. The time-over-threshold (ToT) derived from the recorded start and stop signal times provides a non-linear estimate of the charge collected at the MAPMT anode. This can be used to correct for the time-walk effect. In order to have an easier handling of the time-walk and ToT behaviour over the   25 000 channels of the RICH detector, an equalization of   the SPE shaped pulses is desirable, in particular because the MAROC programmable  threshold  is  common  to  all  its  64  readout channels.
Fig. 6. ToT distributions of the RICH channels at three typical values of threshold (25, 50 and 100 DAC) without (left) and with (right) gain equalization. The saturated SPE signals generally yield ToT duration greater than 40 ns. When lowering the threshold also weaker cross-talk signals are recorded with ToT duration around 25 ns.
Fig. 7. Examples of RICH reconstructed events: direct (left) and partially reflected (right). Big dots indicate the reconstructed photon hits. The arrows indicate the hadron impact point (red star) and the expected photon pattern (small magenta points). (For interpretation of the references to colour in this figure legend, the reader is referred   to the web version of this article.)
The RICH channel-by-channel SPE signal equalization was performed during the CLAS12 engineering run with real data. Data-acquisition tests were made at various thresholds for different MAROC gain con- figurations. Fig. 6 shows the ToT distribution for three typical values of the threshold: on the left for all channels without amplification (nominal MAROC gain of 1), on the right after equalization (tuning the average MAPMT+MAROC gain to 2.7 × 106 in all the channels). After equalization, the ToT distribution of saturated SPE signals is narrower than before. With typical ToT values larger than 40 ns, the peak is   also clearly separated from the cross-talk signals whose ToT values distribute around 25 ns.
For each hit in the MAPMT plane, an estimate of the corresponding Cherenkov angle is derived by ray-tracing the photon path inside the RICH volume taking into account possible reflections. The emission point is assumed to be the middle point of the hadron path inside      the aerogel radiator. The reconstructed path and  angle are  validated by a ±3 ns time coincidence between the RICH recorded time and the CLAS12 expected time. The latter is defined as the time of interaction plus the flight time of the traced hadron to the aerogel radiator and     of the ray-traced photon to the sensor. The expected time provides a practical way to check the RICH time resolution as CLAS12 has a much smaller time uncertainty than RICH. Examples of reconstructed RICH events are shown in Fig. 7. A distinguishing feature is the low level   of spurious hits from accidentals, in-time background (i.e. Rayleigh scattering) and dark counts. The preliminary time resolution is of the
order of 0.7 ns and well within the RICH specification of less than 1 ns.
The preliminary SPE Cherenkov angle resolution yields about 6 mrad, see Fig. 8. It is expected to improve towards the goal value of 4.5 mrad once the corrections for the detector misalignment and realistic optical parameters of each aerogel tile will be accounted for.
5.Electronics applications
The tessellated electronics developed for the CLAS12 RICH provides a very flexible solution for low photon-yield readout systems from
Fig. 8. (Left) Typical time resolution before (red) and after (blue) time-walk correction for all the pixels in MAPMT 52. (Right) Cherenkov angle reconstruction without (black) and with (magenta) a time coincidence request between RICH detected and CLAS tracking times (the difference is in red). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)
the scale of a laboratory test-bench up  to  a  full-scale  experiment. The same electronics system was adopted by the DIRC detector of    the GlueX experiment  [11] and is used for the initial prototypes of      a future Electron–Ion collider ring-imaging Cherenkov detector [12]. The system can be connected by an optical link to a desktop computer via TCP/IP or to a VXS/VME DAQ via a SSP protocol. It provides both a charge linear measurement and parallel binary information with 1 ns time precision (which conforms to CLAS12 RICH requirements, but can be improved with dedicated firmware). The system has an on- board pulse generator and can work in auto, self and external trigger mode. It is ideal for MAPMTs but is also compatible with other sensors,
i.e. Silicon Photo-Multiplier (SiPM) matrices. Test-beam studies of the RICH electronics have been performed at Fermilab using a 120 GeV/c proton beam and a small modular RICH prototype using an aerogel tile as radiator and a Fresnel lens to focus the ring image and limit the   size of the gap between radiator and sensors [13]. The prototype was instrumented with either four H13700 MAPMTs [14] or three S12642-
1616PA  matrices  of  3   ×   3  mm2   area  SiPMs  [15],  and   successfully
read out with the CLAS12 RICH electronics with the simple redesign of the adapter board [16]. In the case of SiPMs, a cooling plate was integrated into the adapter board to provide temperature control from room temperature down to −30 Celsius.
6.
Conclusions
Preliminary data analysis shows that the CLAS12 RICH, for the first time equipped with H8500 and H12700 MAPMTs, is able to match the required time and Cherenkov angle resolution. A compact and scalable readout electronics system has been realized for the detector, able to work in the single-photon regime with high efficiency and stability. It provides a reliable readout system for a variety of cutting-edge sensors, from densely packed H13700 MAPMTs to novel SiPM matrices.
Acknowledgements
This material is based upon work supported by INFN, Italy and by   the U.S. Department of Energy, Office of Science, Office of Nuclear Physics under contract DE-AC05-06OR23177 and the National Science Foundation, Award #1615067. We thank the JLab Detector Support  Group and Fast Electronic Group, the Hall-B technical and management staff and the INFN technical and administrative service.