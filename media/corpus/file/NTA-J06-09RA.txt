<title>Development and validation of reactor nuclear design code CORCA-3D	</title>
<Affiliation>Science and Technology on Reactor System Design Technology Laboratory, Nuclear Power Institute of China, Chengdu, 610213, China/Affiliation>
<author>Ping An, Yongqiang Ma, Peng Xiao, Fengchen Guo, Wei Lu, Xiaoming Chai</author>
<year>2019</year>
<Jounral>Nuclear Energy and Technology</Journal>
<Publishing_house>ELSEVIER </Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.net.2019.05.015</DOI>
<URL>https://doi.org/10.1016/j.net.2019.05.015</URL>
a b s t r a c t
The advanced node core code CORCA-3D is one of the independent developed codes of NPIC for the nuclear reactor core design. CORCA-3D code can calculate the few-group cross section, solve the 3D diffusion equations, consider the thermal-hydraulic feedback, reconstruct the pin-by-pin power. It has lots of functions such as changing core status calculation, critical searching, control rod value calculation, coefﬁcient calculation and so on. The main theory and functions of CORCA-3D code are introduced and validated with a lot of reactor measured data and the SCIENCE system. Now, CORCA-3D code has been applied in ACP type reactor nuclear cores design.
Keywords:
Nuclear design Diffusion calculation
Critical boron concentration Thermal-hydraulic feedback Science
1.Introduction
HuaLong No. 1 reactor is one of the main types of the third  generation nuclear power plant in China. With the construction of HuaLong No. 1 nuclear power plants and the need for nuclear po- wer export, it is particularly important to develop core software with independent intellectual property right.
According to the needs of research on HuaLong No. 1 reactor and the status of core neutron analysis mostly using diffusion method, China Nuclear Power Institute has developed CORCA-3D, a reactor core nuclear design code. It can slove neutron diffusion equations of few energy groups considering the thermal-hydraulic feedback, calculate the burnup of the important actinide nuclides, ﬁssion products, and burnable poisons, obtain the power peak factor and the nuclear enthalpy rise factor through rod reconstruction calcu- lation. CORCA-3D has also the main function for core fuel man- agement and safety assessment on reload, such as the variable parameter calculation, critical search, control rod value calculation, the equilibrium concentrations of iodine and antimony and coef- ﬁcient calculation and so on.
This paper introduces the main physical model and veriﬁcation results. The reference results are provied by the measured data from the nuclear power plant and the SCIENCE system [1]. The SCIENCE system developed by the Framatome is a nuclear code package to perform the nuclear analysis of PWR cores. It consists of a set of core physics tools based on 2D lattice calculations, APOLLO2-F [2]and 3D core calculation, SMART. The SCIENCE system has a lot of engineering application experience.
2.Theory
This chapter provides main equations and methods used in the diffusion calculation, microscopic burnup, cross section calculation and rod information reconstruction in CORCA-3D code.
CORCA-3D solves the few energy group diffusion equation for the core and provides the power distribution for thermal-hydraulic calculation. The results such as moderator density, fuel tempera- ture are for updating the cross section and step into the next diffusion calculation. After convergence of the neutrionics and thermal-hydraulic coupling, CORCA-3D calculates the power peak factor and the nuclear enthalph rise factor through the power reconstruction. Then Boron concentration searching or burn-up calculation starts.
2.1.Diffusion theory
CORCA-3D code can calculate the diffusion equations for the core of the rectangular and hexagonal assembly, and its boundary conditions allow the albedo or ﬁxed ﬂux boundary. Based on the rectangular Green Function nodal method [3], the multi-geometry Green Function nodal method [4] is introduced using the conformal mapping between the rectangle and the hexagon. The conformal
mapping [5] is obtained through the use of the Schwartz-Christoffel transformation [6], and the shape of the rectangle is ﬁxed with a speciﬁc base-to height ratio.
Three-dimension neutron diffusion equation for rectangular
node after the conformal mapping takes the follows form:
@1
where  superscript  k  is  the  number  of  node,  u; v0; zis  the  three dimensional  coordinate  number  after  the  conformal  mapping; D
is  the  diffusion  coefﬁcient;  S is  total  removal  section;  S is the ﬁssion  section  and  Sgg0 is  scattering  cross  section;  g2  u; v0  is  the Conformal mapping factor.
After the transverse integration of the above formula, the Green's  function  of  the  second  type  of  boundary  condition  is
introduced to obtain the ﬂux integral equation (2), the interface current coupling equation for the adjacent k-1,k,k 1 nodes (3) and the node equilibrium equation (4). (2)(3)(4) form the basic equa- tions for diffusion calculation.
@2
@3
@4
@5
@6
@7
4gu: the traversely averaged values of ﬂux
Gk : Green Function,
Rk: the side length of the hexagonal node,
bk: the rectangular width after the conformal mapping,
hk: the height of the node,
Jk 、 Jk : the average interfaces current ﬂow of the left(right)
side of the S direction,(hexagon: s ¼ u; v; w; Rectange: s ¼ u; v),
gu
Lk : the leakage term,
k guL
k guR: the discontinuity factor of the left(right) side of the S direction,
fg : the node average ﬂux.
The residual weight method is used to solve the equations above. The ﬂux is expanded into a secondary Legendre polynomial to solve the source iteration.
They can be solved with the conventional outer and inner iter- ation method. The inner ieration is performed on Equation (3) to solve for the currents for the given sources. With the currents available, Equation (4) can solve the node average ﬂux fg . And the
outer iteration is performed to update the ﬂux and the source.
Equation (2) can solve the new 4k   using the new currents, newleakage moments and the old source moments. With the new 4k The burnup module of CORCA-3D Code uses the Chebyshev Rational Approximation Method(CRAM) [7] and Projected Predictor-Corrector method(PPC) [8] to resolve depletion equations.
The point depletion is approximated by a system of liner equations with constant coefﬁcients
@9
WherefðtÞis the neutron ﬂux of time t; l is the decay constant of    nuclide i; s is the microscopic cross section of nuclide i in reaction
i;k is the branching ratio for transmutation of nuclide to nuclide
i;k is the branching ratio for transmutation of nuclidei in decay reaction; yi;j;k is the branching ratio for
transmutation of nuclide j to nuclide i in reaction k.
i in decay reaction; yi;j;k is the branching ratio for transmutation of nuclide j to nuclide i in reaction k.
Equation (9) can be converted into the matrix form:
@10
Equation (10) can be formally solved by the matrix exponential method yielding the simple solution:
@11
So far, CRAM has been one of the advanced point-burnup calculation algorithms, which has higher accuracy. The formula is as follows for x2ð— ∞; 0Þ:
@12
Where a0, ai, li is the CRAM coefﬁcients [9], k is the CRAM order.
2.3.Homogenous cross section calculation
The macroscopic cross section in energy group g of the node in core can be represented as the summation of multiplication of nuclides density of isotopes and its microscopic cross section of the energy group, which is as follows:
@13
The depletion module of CORCA-3D considers the  actinium  group isotopes (such as 234U, 235U, 236U, 2348U, 237Np, 239Np, 238Pu,   239Pu, 240Pu, 241Pu, 242Pu, 241Am, 242Am, 242Cm, 243Cm, 244Cm), the
ﬁssion products (such as 135I, 135Xe, 147Nd, 147Pm, 148Pm, 149Pm, 158Gd). The ﬁssion products in CORCA-3D code is less than the real ones produced. A pseudo isotope is a package of the rest of ﬁssion products and all unburnable isotopes mainly in the structure ma- terial for the requirement of engineering design.
So the homogenized few group macroscopic cross section of a node is represented as:
@14
The part macroscopic cross section of DSrod
Fig. 1.  User interface of core load.
The part macroscopic cross section of DSrod denotes the inﬂu-ence of the insertion of the control rod, and it is the delta value between inserted and raised.
Fig. 1.  User interface of core load.
Fig. 2.  User interface of reload.
Fig. 3. User interface of output.
The macroscopic cross section of the pseudo isotope or the microscopic cross section of a isotope is the summation of a basic part and three variable parts. The formula can be written as:
@15
X denotes the macroscopic cross section of the pseudo isotope or the microscopic cross section of a isotope. Xb is the basic value in the reference state. DXm is the inﬂuence considering the variation  of moderator density. DXf  is the inﬂuence considering the variation
of fuel temperature. DXH is the inﬂuence of the different burn-up
history. The form of each part is polynomial. The subsection inter- polation is applied for the consideration of high precision.
According to the current and history information, such as burnup, the nuclides density of isotopes, the concentration of bo- ron, the moderator density, the effective fuel temperature, the cross
Fig. 4.  Comparsion of the critical boron concentration of ACP1000 core for C1eC5.
section calculation module in CORCA-3D code calculates the ho- mogenized few group macroscopic cross section.
2.4.Thermal-hydraulic feedback
CORCA-3D use a closed-channel thermal-hydraulic feedback model and assumes no exchange of energy and mass between the channels. In single-channel thermal feedback model the inlet-ﬂow is inputted by user, the coolant temperature, void fraction and water density are calculated along the ﬂow direction, and the fuel effective temperature is calculated by interpolating. The single- channel thermal feedback model divides heat transfer region into single-phase convection region, subcooled boiling region, saturated
Fig. 5. Comparsion of the power peak factor of ACP1000 core for C1eC5.
Fig. 6. Comparsion of the nuclear enthalpy rise factor of ACP1000 core for C1eC5.
Table 1
Relative deviation of the radial power distribution of ACP1000.
boiling region by wall temperature, subcooled and surface heat transfer coefﬁcient. In different heat transfer region, different empirical correlation are used to calculate the heat transfer coef- ﬁcient, vapor quality and void fraction.
2.5.Rod power and burnup reconstruction
The modulation method is used to reconstruct the parameters of the pin power and burnup in CORCA-3D code [10]. The node corner ﬂux is expanded as 32-term polynomial, whose unknows can be solved by the node and surface average ﬂux and surface current of the adjacent nodes. The pin ﬂux is expanded as 13-term poly- nomial, considering the assembly discontinuity factor and shape factor. After solving the rod cross section,we can calculate the rod power and distribution. Then the parameters such as core power peak factor and nuclear enthalpy rise factor are calculated. The rod burnup can also obtained by the polynomial expansion method.
2.6.User interface
CORCA-3D uses a graphical interface to view input modeling and calculation results, and user can use the mouse for the core loading and reload modeling. The output interface can directly display the physical parameters such as the fuel consumption, power, and important nuclide nuclear density of the component, and display it with cloud distribution. CORCA-3D code has the good human computer interaction and user experience. The Figs. 1e3 show the user interface of core load, reload and output.
3.Validation
3.1.HuaLong No. 1 core
The HuaLong No.1 core, ACP1000 is the 3rd generation nuclear power plant of a pressurized light water type that uses a low concentration of uranium dioxide fuel. The core consists of 177 fuel assemblies. We calculate the ﬁrst ﬁve-cycle core of the ACP1000 and compare the main results with the SCIENCE system. Among them, the few group cross section library used by CORCA-3D code is calculated by the assembly neutron analysis code KYLIN-II [11] based on the MOC method.
The core in this example is in the hot full power operation state(HFP) and all control rods are rised out of the core(ARO). We maintain the critical state by changing the boron concentration of the core. Fig. 4 shows the absolute deviations of the critical boron concentration with the burn-up in the ﬁrst ﬁve-cycle of the ACP1000. Compared with SCIENCE system, the maximum absolute deviation of critical boron concentration during the full life period is less than 50 ppm. At the same time, the power peak factor, Fq and the nuclear enthalpy rise factor, Fdh are listed in Fig. 5 and Fig. 6 at the status of the balance xenon. The maximum relative deviation of Fq and Fdh are less than 5%(individual points less than 6%) compared to SCIENCE system. The results are in good agreement.
Table 1 shows the maximum relative deviations of the radial relative power of the core at some burup times such as 0 MWd/ tU(BOL) 、 6000-9000  MWd/tU(MOL)and  12000 -17000MWd/
tU(EOL)between CORCA-3D code and SCIENCE system. All of them,
the maximum relative deviations are less than 5%.
3.2.The core consisting of 157 fuel assemblies
Unit 1 of LingAo nuclear plant and Unit 1 of FangJiaShan nuclear plant are the typical second generation plus nuclear power plants with 157 fuel assemblies in core. We choose the cycle 1 to cycle 14 of LingAo unit 1 plant and cycle 1 and cycle 4 of FangJiaShan unit 1 plant as the calculation object and calculate the critial Boron con- centration, radial power distribution, Fq, Fdh, burnup distribution at end of every cycle life using CORCA-3D code. The reference data of the critical Boron concentration is the measured data provied by the nuclear power plant. The reference data about radial power distribution, Fq, Fdh and the burnup distribution at the end of life are the results of SCIENCE system. We show the statistical analysis of the comparison results.
The  comparison  results  x1;  x2;  /xnare  the  samples.  n  is  the
Fig. 7. Statistical chart of relative deviation of critical Boron concentration.
Fig. 8. Shows the statistical chart of relative deviation of radial relative power distribution.
deviation  of  the  sample  is  .  The  conﬁdence  in-
terval of 95% means 95% probability of the values belongs to this interval.
Fig. 7. Statistical chart of relative deviation of critical Boron concentration.
Fig. 8. Shows the statistical chart of relative deviation of radial relative power distribution.
Fig. 9. Statistical chart of relative deviation of Power peak factor, Fq.
Fig. 10. Statistical chart of relative deviation of nuclear enthlpy rise, Fdh.
Fig. 11. Statistical chart of the absolute deviation of assembly burnup.
Fig. 12. Comparsion of CORCA-3D code to the Reference Solution of Hexagonal Benchmark Problem.
3.2.1.Critical Boron concentration
The sample number of the absolute deviation of the critical Boron concentration is 167.  The  average  value  of  the  sample is 4.8 ppm. The mean deviation of the sample is 11.4 ppm. The standard deviation of the sample is 15.4 ppm. The conﬁdence in- terval of 95% is [-43.0 ppm,27.0 ppm]. Fig. 7 shows the statistical chart of relative deviation of critical Boron concentration.
3.2.2.Radial power distribution
The sample number of the relative deviation of the radial rela- tive power distribution at high level (relative power 0.9) is 29998. The average value of the sample is 0.17%.  The mean deviation of the sample is 0.58%. The standard deviation of the sample is 0.73%. The conﬁdence interval of 95% is [-1.65%,1.17%].
The sample number of the relative deviation of the radial rela- tive power distribution at low level (relative power < 0.9) is 10326. The average value of the sample is 0.18%. The mean deviation of the sample is 0.92%. The standard deviation of the sample is 1.20%. The conﬁdence interval of 95% is [-2.99%,1.69%]. Fig. 8 shows the statistical chart of relative deviation of radial relative power distribution.
3.2.3.Power peak factor
The sample number of the relative deviation for the power peak factor, Fq is 274. The average value of the sample is 0.01%. The mean deviation of the sample is 1.05%. The standard deviation of the sample is 1.28%. The conﬁdence interval of 95% is [-2.18%, 2.71%]. Fig. 9 shows the statistical chart of relative deviation of the power peak factor.
3.2.4.Nuclear enthalpy rise factor, Fdh
The sample number of the relative deviation of the nuclear enthalpy rise factor, Fdh is 274. The average value of the sample is 0.52%. The mean deviation of the sample is 0.70%. The standard deviation of the sample is 0.92%. The conﬁdence interval of 95% is [-1.34%, 2.43%]. Fig. 10 shows the statistical chart of relative devi- ation of the nuclear enthalpy rise factor, Fdh.
3.2.5.Burnup distribution at end of lifek
The sample number of the absolute deviation of the assemblies burnup at end of life is 2826. The average value of the sample is 39 MWd/tU. The mean deviation of the sample is 63 MWd/tU. The standard deviation of the sample is 77 MWd/tU. The conﬁdence
interval of 95% is [-126 MWd/tU,168 MWd/tU]. Fig. 11 shows the statistical chart of the absolute deviation of the assemblies burnup at end of life.
3.3.Benchmark for hexagonal geometry core
The diffusion module in CORCA-3D code can ben used to calculate the hexagonal geometry core such as IAEA, VVER-1000, and VVER-440 [12]. The Fig. 12 shows the comparison results of CORCA-3D code for the benchmark problem. Reference solutions are calculated by the ﬁnite difference code. The absolute deviations of the eigenvalue, Keff are less than 50pcm, and the relative de- viations of radial relative power of the average assembly are less than 2%.
4.Conclusion
This paper introduces the three-dimension core neutron anal- ysis code CORCA-3D developed by the China Nuclear Power Research and Design Institute. We use CORCA-3D code to calculate the cycle 1 to cycle 5 of the ACP1000 core, the cycle 1 to cycle 14 of LingAo Unit 1 core, the cycle 1 to cycle 4 of FangJiaShan Unit 1 core, and some benchmark problems for hexagonal core. The compar- sion results between CORCA-3D code and the measured data, the reference values and SCIENCE system agree well. Now CORCA-3D code has be applied for nuclear power plants of the second and third generation in China. We are also developing the functions for the core with the hexagonal geometry arrangement. Our goal is to make the CORCA-3D code important software for the engineering design of rectangle and hexagonal nuclear power plants core.
