<title>A hyperbolic phase-transition model coupled to tabulated EoS for two-phase flows in fast depressurizations</title>
<author>1,M.De Lorenzoa,2,Ph.Lafona,3,M.Pelantia,4,A.Pantanoabc,5,M.Di Matteod,6,Y.Bartosiewiczd,7,J.-M.Seynhaeved</author>
<Affiliation>1,IMSIA UMR EDF-CNRS-CEA-ENSTA, Palaiseau 91120, France;2,Politecnico di Torino, Torino 10129, Italy;3,INP Phelma, Grenoble 38000, France;4,Université catholique de Louvain (UCL), Institute of Mechanics, Materials, and Civil Engineering (iMMC), Louvain la Neuve 1348, Belgium</Affiliation>
<year>2020</year>
<Jounral>Nuclear Engineering and Design</Journal>
<Publishing_house>ELSEVIER</Publishing_house>
<Text_Collector>XiaFan，HEU</Text_Collector>
<DOI>10.1016/j.nucengdes.2020.110954</DOI>
<URL>https://www.sciencedirect.com/science/article/pii/S0029549320304489</URL>
A hyperbolic phase-transition model coupled to tabulated EoS for two-phase flows in fast depressurizations
M.De LorenzoaPh.LafonaM.PelantiaA.PantanoabcM.Di MatteodY.BartosiewiczdJ.-M.Seynhaeve
IMSIA UMR EDF-CNRS-CEA-ENSTA, Palaiseau 91120, France
Politecnico di Torino, Torino 10129, Italy
INP Phelma, Grenoble 38000, France
Université catholique de Louvain (UCL), Institute of Mechanics, Materials, and Civil Engineering (iMMC), Louvain la Neuve 1348, Belgium
<Section>Highlights</Section>
Hyperbolic phase-transition model for metastable two-phase flows.
Coupling of the six-equation two-phase model to accurate tabulated EoS (IAPWS-IF97).
Use of novel relaxation techniques for the thermodynamic equilibrium recovery.
Numerical simulations of fast depressurization of steam-water systems.
Validation against experimental data and the Homogeneous Equilibrium Model.
<Section>Abstract</Section>
This article deals with a single-velocity six-equation two-phase flow model and its use for the simulation of metastable liquid–vapor flows of industrial interest like fast depressurizations in which phases are in thermo-chemical disequilibrium.
The purpose of this work is to develop a numerical method of industrial grade with enhanced adherence to physics by employing advanced modeling techniques based on hyperbolic multiphase flow models proposed in the last two decades. The model here developed is able to accurately take into account disequilibrium between phases thanks to splitted relaxation processes for pressure, temperature and Gibbs free enthalpy disequilibria. At the same time, numerical calculations rely on fast and accurate Equations of State (EoS).
To obtain such a tool, in this paper, we merge the single-velocity six-equation two-phase flow model with novel relaxation procedures and steam-water tables calculation methods. The outcome is an accurate and time-efficient hyperbolic model for simulating metastable two-phase flows. The merging builds up on previous work of the authors that was dedicated on the one hand to EoS-independent relaxation procedures for the six-equation model, and on the other hand on steam-water look-up table techniques coupled to simpler two-phase flow models.
Since the single-velocity six-equation model is capable of accounting for vapor metastable states, the steam-water tables and the look-up table technique that we developed in previous work are extended here to the vapor metastable domain up to the vapor spinodal line. Then, the complete six-equation model is coupled to the new steam-water tables for the simulation of metastable two-phase flows occurring in the event of a fast depressurization. These simulations are validated against experimental data available in the literature.
The final model is implemented in the EUROPLEXUS code for its use in nuclear reactor safety.
Keywords:Two-phase flow;Relaxation procedures;Tabulated equations of state;Metastable states;Fast transients;Depressurizations
<Section>1. Introduction</Section>
The last two decades have seen a great improvement in the mathematical and numerical modeling of two-phase flows. Hyperbolic models have become more popular and their application domains are various. These advancements led to a better description of the disequilibria phenomena existing between phases. In this context an effective modeling approach consists in decomposing thermodynamic disequilibrium in mechanical, thermal and chemical disequilibrium processes.
In case of phase transition simulations of a single-component mixture, the occurence of thermodynamic disequilibrium may lead to the presence of metastable states, that is, the persistence of a phase into the stability domain of another phase. Thanks to the contribution of new techniques based on hyperbolic flow models, the analysis of metastable two-phase flows has greatly improved. Nonetheless, these improvements have not changed the numerical methodologies of common use in industry.
One of the reasons stems from the difficulty of using real equations of state in some of the recent and more advanced approaches. The numerical techniques recently proposed in the literature (Crouzet et al., 2015, Pelanti and Keh-Ming Shyue, 2014, Saurel et al., 2008, Saurel et al., 2009, Zein et al., 2010) are often designed only for very simple Equations of State (EoS) as the stiffened gas one. However, this is not adequate for some industrial applications.
Our research is fully devoted to the nuclear reactor safety in Pressurized Water Reactors (PWRs), where the coolant is the water. Due to highly non-linear behaviors of water, engineers and the nuclear regulator are often skeptical about the use of simplistic EoS. For this reason, we paid a tremendous attention to the capability to use accurate EoS. Our approach is different because, conversely to many other research works in the hyperbolic domain, we built the whole numerical model around a tabulated EoS. This is dictated by our industrial needs. As a result, some of our modeling choices are constrained.
One of the main reasons that led us to develop the single-velocity six-equation two-phase flow model stems from this constraint. In fact, aside from the seven-equation model, this is the only model with a full thermodymanic separation between the two phases. As we will see in the next section, this model requires two phasic EoS totally independent from each other.
In all other models, thermodynamic closure laws are somehow dependent from each other. When using a simple EoS as the stiffened gas one, this is not an issue because closure laws are so simple that can be analytically manipulated to end up in a simple analytic law, e.g. Daude et al., 2014, Saurel et al., 2008, Chiapolino et al., 2017, Goncalvès, 2014. By contrast, when using real EoS or tabulated ones, this is not possible and a non-linear algebraic equation must be iteratively solved to guarantee the equality of phasic pressures and/or temperatures. Solving this non-linear equation per each cell at every time step is extremely time-consuming and can also lead to low robustness of the whole numerical model. We experienced this problem in the HRM in De Lorenzo et al. (2017), other authors experienced it using the single-pressure six-equation model in conservative variables (Tiselj and Petelin, 1997), and the same problem would be encountered if the Kapila model (Kapila et al., 2001) was coupled to a real EoS.
Therefore, the choice of the single-velocity six-equation two-phase flow model allows us to use tabulated EoS avoiding any iterative method. In this way, we have both an accurate thermodynamic modeling and a greater robustness, both features are fundamental for our industrial scope.
Our previous works separately dealt with the fluid properties calculation and the single-velocity six-equation two-phase flow model. In De Lorenzo et al. (2017), we developed a fast and accurate technique for the calculation of steam-water properties. Then, in De Lorenzo et al. (2018), we verified the hyperbolic solver and analyzed the integration of non-conservative terms.Later, in De Lorenzo et al. (2019), we proposed a novel method for the relaxation of thermodynamic disequilibrium for phases described by arbitrary EoS.
The purpose of the current work is to couple the three aforementioned techniques to simulate metastable two-phase flows of industrial concern as fast depressurizations in which phases are in thermo-chemical disequilibrium. The outcome of this work is a hyperbolic model for metastable two-phase flows that uses the proposed techniques for the calculation of interfacial transfers and steam-water properties. Moreover, it is computationally affordable for its use in industrial configurations.
In our previous works, the single-velocity six-equation model was numerically integrated using the basic Fortran libraries of the CLAWPACK software (LeVeque, 2002). Due to its industrial interest, we have now implemented it in EUROPLEXUS code (Europlexus User’s Manual, 2016) for the simulation of metastable steam-water flows for nuclear reactor safety analyses. In this paper, we use our methodology for simulating fast depressurizations, validating it against experimental data available in the literature.
The outline of the article is the following. In Section 2 we briefly describe the single-velocity six-equation two-phase flow model together with its physical and mathematical properties. Here we discuss both the homogeneous hyperbolic portion of the model and the source terms necessary for the thermodynamic equilibrium recovery. Section 3 explains our strategy for the calculation of steam-water properties and the developments of the work done in De Lorenzo et al. (2017) to extend it to metastable vapor states. In Section 4 we show the numerical methods developed to integrate the complete model, focusing on Riemann and Runge–Kutta solvers.
These methods are used in Section 5 in tests of industrial grade in which we compare the computational results of the complete model to several fast depressurizations experiments realized in steam-water systems. Finally, in Section 6, we give some conclusions and perspectives.
<Section>2. Single-velocity six-equation two-phase flow model</Section>
For the metastable two-phase flows simulation, we chose the single-velocity six-equation model (Saurel et al., 2009, Kapila et al., 2001) in the form proposed in Pelanti and Keh-Ming Shyue (2014) to ensure mixture-energy-consistency at discrete level. The six-equation model is a two-phase two-pressure system modeling the dynamics of mixture of fluids that can also deal with phase transitions when phases are the liquid and its vapor.
It is a reduced model of the seven-equation model (Baer and Nunziato, 1986) in which phases are constrained to move at the same velocity. This is a strong assumption in two-phase flow because very often phases move at a significantly different speed. However, this assumption is here justified by the fact that our research purpose is the description of the very first milliseconds of rapid depressurizations, the so-called acoustic phase, where thermodynamic disequilibria play the most important role as we can see in Bartak’s experimental campaign (Bartak, 1990, Suchanek and Bartak, 1989).
Our research is only devoted to the acoustic phase of fast depressurizations because our main industrial interest is the analysis of the fluid–structure interaction in reactor cores caused by the rarefaction wave originated at the breach at the very beginning of a Loss-of-Coolant Accident (LOCA). By contrast, to analyze the subsequent evolution of a LOCA, it is necessary to use a two-fluid model to allow phases to move at different velocity.
In the following, first we introduce the homogeneous hyperbolic portion of the model, then we describe the complete model proposed by the authors in De Lorenzo et al. (2019).
2.1. Homogeneous hyperbolic portion of the model
The governing equations consist of mass and energy balance laws for each phase, a momentum balance for the mixture, plus an advection equation for one of the two phases. In 1D, the hyperbolic homogeneous portion of this model reads
(1)∂tα1+u∂zα1=0,∂t(α1ρ1)+∂z(α1ρ1u)=0,∂t(α2ρ2)+∂z(α2ρ2u)=0,∂t(ρu)+∂z(ρu2+α1p1+α2p2)=0,∂t(α1ρ1E1)+∂z[α1(ρ1E1+p1)u]+Σ=0,∂t(α2ρ2E2)+∂z[α2(ρ2E2+p2)u]-Σ=0.
At each phase is assigned a density ρk, a pressure pk, a specific internal energy ek and a volume fraction αk, where k=1,2. Ek=ek+12u2 are the specific total energies and ρ=α1ρ1+α2ρ2 is the mixture density. Both phases move at velocity u. Two other useful quantities are: phasic mass fractions Yk=αkρk/ρ and phasic partial densities mk=αkρk. The volume saturation condition α1+α2=1 is obviously assumed.
The non-conservative terms appearing in phasic total energy equations are
(2)Σ=-u·Y2∂z(α1p1)-Y1∂z(α2p2).
These terms are non-zero if u≠0 and if Y1Y2≠0, that is, if the fluid is a mixture containing both species moving at non-zero velocity.
The above system of partial differential equations is hyperbolic and its eigenvalues are
(3)λ1=u-chom,λ2,…,5=u,λ6=u+chom,
where the speed of sound of the associated homogeneous model is
(4)chom=Y1c12+Y2c22,
and ck are the phasic isentropic speeds of sound. In order to close the system, two equations of state (EoS) are needed, one per each phase. They are of the form of incomplete EoS (Cowperthwaite, 1969):
(5)pk=pk(ρk,ek).
In this work, we do not use an analytic relation for (5), rather a look-up table algorithm for a fast and accurate evaluation of steam-water properties (De Lorenzo et al., 2017). This procedure provides bicubic spline functions globally continuous on the entire e-v domain. This technique is explained in Section 3.
2.2. The complete model for phase transition
The complete single-velocity six-equation two-phase flow model proposed in De Lorenzo et al. (2019) allows us to simulate phase transition phenomena of metastable phases. Relaxation processes are non-instantaneous and phases can be described by arbitrary EoS. As shown by the authors in De Lorenzo et al. (2019) and previously discussed in Tiselj and Petelin (1999) for another flow model, when equilibrium recovery mechanisms are assumed to be quasi-instantaneous, the six-equation model tends to the Homogeneous Equilibrium Model (HEM), that is, infinitely fast relaxation mechanisms can not simulate metastable flows.
The model and the numerical procedures we proposed in De Lorenzo et al. (2019) have the capability to describe an arbitrarily fast equilibrium recovery. This enables to correctly simulate metastable two-phase flows. The numerical procedures proposed in De Lorenzo et al. (2019) enable to separately account for the three main physical processes that drive a metastable mixture towards equilibrium. These processes are: (i) compression-expansion energy transfer leading to phasic pressures equilibrium, also called pressure relaxation process, (ii) sensible heat transfer, also called temperature relaxation process, and (iii) mass transfer process occurring during a phase transition.
Considering the contribution of the relaxation sources, the six-equation model reported in Eq. (1) becomes:
(6)∂tα1+u∂zα1=α1aρ1Θp(p1-p2)+α1aρ1hAintV(T1-T2)-1ρ11-α1ipkT-kpiTkpjT-jpkTG1→2AintV,∂t(α1ρ1)+∂z(α1ρ1u)=-G1→2AintV,∂t(α2ρ2)+∂z(α2ρ2u)=+G1→2AintV,∂t(ρu)+∂z(ρu2+α1p1+α2p2)=0,∂t(α1ρ1E1)+∂z[α1(ρ1E1+p1)u]+Σ=-α1pintaρ1Θp(p1-p2)+bThAintV(T1-T2)-bgG1→2AintV,∂t(α2ρ2E2)+∂z[α2(ρ2E2+p2)u]-Σ=+α1pintaρ1Θp(p1-p2)-bThAintV(T1-T2)+bgG1→2AintV,
where pint denotes an averaged interface pressure that here we define as in Saurel and Abgrall (1999),
(7)pint=α1p1+α2p2
and does not account for curvature and surface tension effects, which are considered negligible. Other definitions are possible, e.g. Saurel et al., 2003, Coquel et al., 2002.The other terms introduced in De Lorenzo et al. (2019) are:
(8)bT=α1ρ1pintaρ12Γ1α1+Γ2α2-1α1ρ1,bg=α1ρ1jpiT-ipjTkpjT-jpkT
The form of the thermal relaxation terms appearing in the energy equations and in the volume fraction equation allows us to maintain constant the phasic pressure difference during the temperature relaxation process. Analogously, the form of the mass transfer terms in those three equations keeps constant the pressure and temperature difference during a phase transition process (De Lorenzo et al., 2019).These enable to strictly separate the three relaxation mechanisms and to prevent non-physical behaviors. The definitions of ip,jp,kp,iT,jT and kT can be found in Appendix A.
Aint/V is the interfacial area density per unit volume. It is a very important quantity because interphasic transfers occur at the interface and are proportional to interfacial area. At the current state of our research we have set it to unity, but we expect to improve our modeling using a separate flow-pattern model to better estimate this quantity.
h is the convection heat transfer coefficient, Γk are the phasic Grüneisen coefficients, and Θp is the characteristic time for pressure equilibrium recovery.
From (6) we can see that pressure disequilibrium (p1-p2) drives the compression-expansion energy transfer in pressure relaxation process. The term (T1-T2) drives the sensible heat transfer. This is a simplification of the real phenomenon because the sensible heat transfer in each phase is not driven by phasic temperature difference but by their differences with respect to interfacial temperature. G1→2 stands for the net mass flow rate per unit interfacial area due to phase transition phenomena.
Source terms standing on the right-hand-side of Eq. (6) represent the mathematical modeling of physical phenomena occurring during a phase transition. These phenomena are irreversible, then they lead to an increase of the mixture entropy. The irreversibility of such phenomena is discussed in Appendix B.
<Section>3. Look-up table algorithm for liquid and vapor EoS</Section>
To correctly simulate phase transition phenomena, accurate equations of state should be used. For the steam-water properties, nowadays, the most reliable EoS for water is the IAPWS-95 (Wagner and Pruß, 2002). This is an analytical equation based on experimental data and is used for general and scientific purposes. Given that the IAPWS-95 formulation is quite cumbersome and time consuming, IAPWS also provides a separate formulation recommended for industrial use, i.e. the IAPWS-IF97 (Wagner et al., 2000). The latter consists of a set of equations for five different regions, fitting the values resulting from the IAPWS-95. In this work we rely on the IAPWS-IF97 for the water properties calculation.
Generally, accurate EoS are expressed as:
(9)f=f(ρ,T)org=g(p,T),
where: f=e-Ts and g=h-Ts are, respectively, the Helmholtz free energy and the Gibbs free enthalpy. The IAPWS-IF97 is a combination of the these two forms because is composed of four EoS, each of which describes the water properties of a subdomain of the thermodynamic diagram. These subdomains are called regions and are depicted in Fig. 1. The IAPWS-IF97 EoS reads:
(10a)forRegion1:g(p,T)=RT∑i=134n1,i(7.1-π)I1,i(τ-1.222)J1,i,
(10b)forRegion2:g(p,T)=RTlnπ+∑i=19n2,ioτJ2,io+∑i=143n2,iπI2,i(τ-0.5)J2,i,
(10c)forRegion3:f(ρ,T)=RTn3,1lnδ+∑i=240n3,iδI3,iτJ1,i,
(10d)forRegion5:g(p,T)=RTlnπ+∑i=16n5,ioτJ5,io+∑i=15n5,iπI5,iτJ5,i.
where R=0.461526kJkg-1K-1 is the specific gas constant of ordinary water, π,τ and δ are the reduced pressure, temperature and density, that is, normalized values with respect to the critical point. The coefficients nk,i,Ik,i and Jk,i can be easily found in Wagner et al. (2000).
Fig. 1. Region subdivision of the IAPWS-IF97 on the p-T diagram. Region 4 represents the saturation curve.
These EoS are very accurate for stable states because they are based on experimental data. However, they are not explicitly made to fit metastable condition data, therefore it is expected a lower accuracy in this domain.
Such EoS are very accurate but extremely costly from a computational point of view. Therefore, replacing the incomplete EoS in (5) by an iterative algorithm that implements a complete EoS as (9) is feasible but too expensive for industrial calculations. Further, the iterative algorithm may be an issue for the global robustness of the code since it may not converge.
Based on the works of Kunick, 2015, Kunick et al., 2017, we proposed in De Lorenzo et al. (2017) an alternative strategy to calculate steam-water properties. In our previous work, it consisted in a look-up table method that calculates p=p(ρ,e) by a bicubic interpolation in the e-v thermodynamic diagram. The choice of the e-v diagram for the look-up table method comes from the fact that the specific volume v=1/ρ and the specific internal energy e are immediately available from the vector of the conservative variables.
Since it was used for HEM and HRM calculations, ρ and e referred to single-phase states or to equilibrium mixture ones. For the current work, we developed a very similar technique but for the calculation of phasic EoS, i.e. pk=pk(ρk,ek), because those are required for the six-equation model (see Eq. (5)).
In the following we discuss the physical constraints for phasic EoS in order to identify the limits of the liquid and vapor domains. Then we present such domains on the e-v diagram of water, showing the extension up to liquid and vapor spinodal curves. Finally, we recall the guidelines of our strategy for the bicubic interpolation of the thermodynamic properties.
3.1. Physical constraints of phasic EoS
For the current work, we have developed a bicubic spline method for the calculation of phasic EoS as:
(11)pk=pk(ρk,ek),Tk=Tk(ρk,ek),gk=gk(ρk,ek).
It means that the e-v diagram has been divided into two domains: the liquid domain and the vapor domain. In the liquid domain, liquid EoS exist in the forms:
(12)pl=pl(ρl,el),Tl=Tl(ρl,el),gl=gl(ρl,el),
and in the vapor domain, similarly, vapor EoS are:
(13)pv=pv(ρv,ev),Tv=Tv(ρv,ev),gv=gv(ρv,ev).
Since here we are dealing with phasic EoS, phasic domains are bounded by physical constraints of thermodynamic stability. For each phase, the criteria for equilibrium and stability (Carey, 2007) can be expressed, respectively, as:
(14)δSk=0,δnSk<0forthesmallestnatwhichδnSk≠0,
where Sk are phasic entropies. Further developments of the last criterion provide two conditions which ensure thermodynamic stability of a system:
(15)Cv,k>0,∂pk∂vkTk<0.
Cv,k indicates the specific heat at constant volume. The former is called criterion of thermal stability, the latter criterion of mechanical stability. The criterion of thermal stability is generally satisfied by the EoS, however the respect of mechanical stability is not always ensured. Many EoS satisfy the mechanical stability until the so-called spinodal line, the line that separates the unstable domain from the stable/metastable one.
To identify the domains where Eqs. (12), (13) are physically defined, phasic spinodal curves must be identified. For the liquid spinodal curve, we rely on our previous work in De Lorenzo et al. (2017) where we identified and compared it with results available in the literature. In De Lorenzo et al. (2017) we defined the liquid domain limit as the composition of liquid spinodal and isobar p=0 curves. However, there are many references and measurements, which prove that the liquid can appear in metastable conditions at negative pressure (liquid under tension) also in the nuclear safety applications (Gale and Tiselj, 2008), therefore we expect to extend this tabulation to the negative pressure domain in the future.
The identification of the vapor spinodal curve is discussed in the next section.
3.2. Extension to vapor metastable states
In fast transients of nuclear industry concerns, one or both phases can be metastable. The liquid can reach metastable states due to a rapid depressurization (see De Lorenzo et al., 2017 or Section 5), and the vapor can depart from equilibrium conditions during the vapor pocket compression initiating a waterhammer. But, metastable vapor is also of concern in the expansion stages of the steam turbines, both in nuclear and in conventional steam power plants.
For these reasons, the steam-water tables that we have proposed in De Lorenzo et al. (2017) need to be extended to metastable vapor states. For prior works similar to the present one, refer to Kunick et al., 2017, Tiselj et al., 2008. In this section we provide a method of determination of the thermodynamical states belonging to the vapor spinodal curve, which allows us the extension to metastable vapor conditions included between the saturation curve and the spinodal one.
Contrary to what was done in De Lorenzo et al. (2017) for the liquid spinodal curve, the properties of the vapor spinodal curve have been determined using the IAPWS-95 formulation. In fact, the IAPWS-95 expresses the thermodynamical variables as a function of v=1/ρ and T, therefore, it exists a function of the form
(16)p=p(v,T),
that allows one to define the loci at which
(17)∂p∂vT=0.
These correspond to the limit of thermodynamic stability for a pure phase, then they define the spinodal curve (Carey, 2007, Debenedetti, 1996). As visible from Eqs. ((10a), (10b), (10c), (10d)), IAPWS-IF97 can express a relation in the form of Eq. (16) in Region 3 only. For the liquid domain, in De Lorenzo et al. (2017), we used the IAPWS-IF97 to define the spinodal curve because Region 3 almost entirely defines the metastable liquid domain. However, for the vapor phase it is not possible because the metastable vapor is only partially defined by Region 3 equation of state.
To overcome this difficulty, the vapor spinodal curve has been identified using the IAPWS-95. However, metastable vapor properties are everywhere defined using the IAPWS-IF97. Even on the vapor spinodal curve, once it has been identified by the IAPWS-95, thermodynamic properties are recalculated using the IAPWS-IF97 to guarantee thermodynamic properties continuity on the whole domain. In Fig. 2 we show the comparison between the pure vapor temperature and speed of sound on the vapor spinodal curves obtained by IAPWS-95 and IAPWS-IF97. The trends are very similar.
Fig. 2. Speed of sound and temperature profiles on the vapor spinodal curve. The results obtained using the IAPWS-IF97 are compared to the ones obtained with the IAPWS-95.
Once the vapor spinodal curve has been identified, the domain of the steam-water tables can be extended up to this limit. Beyond this limit, the fluid is unstable, then non physical. That is the reason why the spinodal lines represent an impassable boundary in our work.
3.3. The e-v diagram for water
The e-v diagram is quite uncommon in the literature. The water phase diagram is clearly subdivided into three portions: liquid phase, vapor phase and unstable domain. To identify liquid and vapor phases on this diagram, refer to Fig. 3. The liquid region, located on the left of the e-v diagram, is defined up to the critical point and up to the composition of liquid spinodal and isobar p=0. The vapor domain is the one located above of the critical point and the vapor spinodal line.
Fig. 3. Liquid and vapor water on e-v diagram. Critical point is indicated by circular markers ○ in both main plot and its magnified view. The black curve is the saturation curve, representing the loci at which phases are at saturated conditions. The red curve is the vapor spinodal, then, the region of metastable vapor is the one comprised between the saturation curve and the vapor spinodal. The blue curves represent the rightmost limit of the metastable liquid and is composed of two curves: the negative pressure border and the liquid spinodal. Thus, the metastable liquid is the narrow region comprised between the saturation curve and the blue lines. The wide region comprised between the two spinodals represents the unstable region, where a pure phase can not exist. This plot has been realized using both IAPWS-IF97 and IAPWS-95.
The area comprised between the two spinodal lines is not of interest because it refers to phasic unstable states.
In De Lorenzo et al. (2017) we have shown the behavior of thermodynamic properties in this plane, and the trend of isotherms, isobars and isoquality curves for single-phase water and mixtures at saturated conditions. Here, we make a different use of this diagram because we need one equation of state per phase. In Fig. 4 we show 2D trends of pressure, temperature and speed of sound on the whole e-v domain. Note that the 2D plots here reported are intended for phasic liquid and vapor, in stable and metastable conditions, then, their behaviors beyond the saturation curve do not correspond to the mixture plots shown in De Lorenzo et al. (2017).
Fig. 4. Phasic pressures (MPa), temperatures (K) and speeds of sound (m/s) on e-v diagram. Results obtained using the IAPWS-IF97. The black line indicates the saturation curve. The properties in the liquid domain are not clearly visible here. For a clearer representation of this domain, see De Lorenzo et al. (2017).
3.4. A bicubic interpolation method
For the sake of simplicity, during the interpolation process, the irregular physical domain e-v, has been transposed in a Cartesian transformed domain, Y-X. This feature is depicted in Fig. 5 and exhaustively discussed in Kunick (2015).
Fig. 5. Grid of nodes in the physical domain and in the transformed one.
As previously done in Kunick (2015), in the liquid and supercritical domain we imposed an equidistant pattern of nodes, hence the distribution is linear, whereas, in the vapor domain the node distribution is logarithmic. Handling such a regular distribution of nodes ensures that the cell containing the working point can be immediately found. Such a feature allows to strongly reduce the computational time for the cell identification. An alternative approach would be the one used in Dumbser et al., 2013, Kyriazis et al., 2017, where the physical domain was divided in an unstructured thermodynamic table.
Then, a bicubic interpolation is performed in the Cartesian diagram Y-X, using stored values of e-v diagram.
To perform a bicubic interpolation, the cell must be square. A bilinear mapping is used to pass from physical domain to Cartesian one. The bilinear mapping functions are:
(18)v=α1+α2X+α3Y+α4XY,
and
(19)e=β1+β2X+β3Y+β4XY.
To identify αi,βi coefficients, one needs to set the vertices of the irregular cell in the e-v plane to be the vertices of the unit length square of the transformed space (see Fig. 5). In our particular case, the grid is formed by horizontal iso-e lines, then: β2,β4=0. Finally, it comes out:
(20)α1=v1,α2=-v1+v4,α3=-v1+v2,α4=v1-v2+v3-v4,
(21)β1=e1,β2=0,β3=-e1+e2,β4=0.
The bilinear mapping serves to identify the (X0,Y0) point corresponding to a phasic (vk,0,ek,0) value. Once the point is known, we can calculate the thermodynamic properties using a bicubic interpolation. Let us suppose to be interested in phasic pressure calculation, thus:
(22)pk(vk,0,ek,0)=p̃k(X0,Y0)=[1X0X02X03]A[1Y0Y02Y03]T
where A is the coefficient matrix describing the function pk in the transformed space. Its elements are
(23)A=10000010-33-2-12-211p̃k,1p̃k,2∂Yp̃k,1∂Yp̃k,2p̃k,4p̃k,3∂Yp̃k,4∂Yp̃k,3∂Xp̃k,1∂Xp̃k,2∂X,Yp̃k,1∂X,Yp̃k,2∂Xp̃k,4∂Xp̃k,3∂X,Yp̃k,4∂X,Yp̃k,310-32003-201-2100-11,
where, for instance, ∂Xp̃k,1 indicates the derivative of the function pk with respect to the coordinate X at node 1, that is, the node in the bottom left corner. One can refer to De Lorenzo et al. (2017) for further information about the calculations of these derivatives.
The function p̃k(X,Y) refers to a Cartesian square grid and, by construction (Press et al., 1997), has the following properties: i) values of the function and the specified derivatives are reproduced exactly at the nodes, and, ii) the function and the specified derivatives change continuously across cell edges. Furthermore, these smoothness properties do not depend on the accuracy of the specified derivatives (Press et al., 1997).
Similarly to phasic pressures, we have tabulated also phasic temperatures, sonic velocities and Gibbs free enthalpies to have a faster numerical method. Due to the choice of the bilinear transformation, pk(vk,ek),Tk(vk,ek),ck(vk,ek) and gk(vk,ek) are globally continuous functions on the whole e-v plan, but not all their derivatives are continuous across edges.
<Section>4. Numerical solution methods</Section>
The numerical solution of system (6) can be obtained by a succession of operators (Strang, 1968) of first order,
(24)Uin+1=LsourceΔtLhypΔtUin
or second order
(25)Uin+1=LsourceΔt/2LhypΔtLsourceΔt/2Uin,
where Lhyp and Lsource denote, respectively, the hyperbolic and the source operator. The latter is composed by three operators: Lp,LT,Lg that are, respectively, operators for pressure, temperature and chemical potential relaxation procedures. The result of an operator is used as initial value for the following operator.
The calculation variables vector, at the end of the hyperbolic operator step, will be called
(26)Uin+=LhypΔtUin.
In this section, we describe the numerical techniques used for solving the hyperbolic homogeneous portion of the system and then relaxation operators.
4.1. Hyperbolic operator
The hyperbolic homogeneous portion of the model, that is, Eq. (1), can be written as
(27)∂tU+∂zF(U)+B1(U)∂zu+B2(U)∂z(α1p1)+B3(U)∂z(α2p2)=0,
where:
(28)U=α1α1ρ1α2ρ2ρuα1ρ1E1α2ρ2E2,F=α1uα1ρ1uα2ρ2uρu2+α1p1+α2p2α1(ρ1E1+p1)uα2(ρ2E2+p2)u,B1=-α100000,B2=0000-uY2+uY2,B3=0000+uY1-uY1.
Considering a spatial domain decomposed in cells, we refer to Uin as the integral average of the calculation variables vector in ith cell at time step tn. The evolution between tn and tn+ is
(29)Uin+=Uin-ΔtΔzFi+12n-Fi-12n-ΔtHi
where Fi±12n denotes the fluxes at mesh cell boundaries, and Hi groups all contributions of non-conservative terms, that is
(30)Hi=∫ΔzB1∂zudz-∫ΔzB2∂z(α1p1)dz-∫ΔzB3∂z(α2p2)dz.
Eq. (29) is exact, however we need an approximation method to evaluate both the fluxes and the integral of non-conservative terms. For the former we adopt a HLLC-type method, then the numerical approximation of the flux is:
(31)Fi+12HLLC,n(Uin,Ui+1n)=Fℓ,ifSℓ>0,Fℓ∗=Fℓ+Sℓ(Uℓ∗-Uℓ),ifSℓ⩽0<S∗,Fr∗=Fr+Sr(Ur∗-Ur),ifS∗⩽0<Sr,Fr,ifSr⩽0.
This solver is complete because it assumes as many waves as the ones of the system. In fact, three waves are present and move at speeds
(32)s1=Sℓ,s2=S∗,s3=Sr.
They separate four constant states called: Uℓ,Uℓ∗,Ur∗ and Ur. We indicate with subscripts ∗ℓ,∗r the quantities corresponding to the states Uℓ∗ and Ur∗ adjacent (respectively on the left and on the right) to the middle wave propagating at speed S∗. Following Davis (1988) we define
(33)Sℓ=min(uℓ-cℓ,ur-cr),Sr=max(uℓ+cℓ,ur+cr).
The speed S∗ is then determined as in Toro (1997):
(34)S∗=u∗=pr-pℓ+ρℓuℓ(Sℓ-uℓ)-ρrur(Sr-ur)ρℓ(Sℓ-uℓ)-ρr(Sr-ur).
The completely upwind fluxes of Eq. (31) are: Fℓ=F(Uin) and Fr=F(Ui+1n). The middle states are:
(35)Uι∗=α1,ι(α1ρ1)ιSι-uιSι-S∗(α2ρ2)ιSι-uιSι-S∗ριSι-uιSι-S∗S∗(α1ρ1)ιSι-uιSι-S∗E1,ι+(S∗-uι)S∗+p1,ιρ1,ι(Sι-uι)(α2ρ2)ιSι-uιSι-S∗E2,ι+(S∗-uι)S∗+p2,ιρ2,ι(Sι-uι),
with ι=ℓ,r.
Non-conservative terms are approximated using a first order approximation method, that is
(36)∫ΔzB1(U)∂zudz≈B1(Uin)ui+12-ui-12,
(37)∫ΔzB2(U)∂z(α1p1)dz≈B1(Uin)(α1p1)i+12-(α1p1)i-12,
(38)∫ΔzB3(U)∂z(α2p2)dz≈B1(Uin)(α2p2)i+12-(α2p2)i-12.
In order to calculate the interfacial quantities, we use the wave pattern information coming from the HLLC solver. For the advection equation we use the method proposed in Johnsen and Colonius (2006):
(39)ui+12HLLC,n(Uin,Ui+1n)=uℓ,ifSℓ>0,Sℓ-uℓSℓ-S∗S∗,ifSℓ⩽0<S∗,Sr-urSr-S∗S∗,ifS∗⩽0<Sr,ur,ifSr⩽0.
For the non-conservative terms of the phasic energy equations, we propose:
(40)(αkpk)i+12HLLC,n(Uin,Ui+1n)=(αkpk)ℓ,ifSℓ>0,αk,ℓ[pk,ℓ-ρk,ℓ(Sℓ-uℓ)(uℓ-S∗)],ifSℓ⩽0<S∗,αk,r[pk,r-ρk,r(Sr-ur)(ur-S∗)],ifS∗⩽0<Sr,(αkpk)r,ifSr⩽0.
The hyperbolic operator just described has been intensively studied and tested in our previous works (De Lorenzo et al., 2018, De Lorenzo, 2018). In particular in De Lorenzo et al. (2018) we compared various Riemann solvers for the six-equation system, assessing the performance of the solvers with mesh convergence tests and efficiency studies at first and second order. Moreover, we also studied the performance of different discretizations of the non-conservative terms in the energy equations and we investigated conditions leading to discrepancies with respect to the exact solution of the pressure equilibrium model based on the Rankine–Hugoniot conditions established in Saurel et al. (2007). Difficulties related to non-conservative terms seem to arise only in the case of strong shocks in genuine two-phase mixture zones. Our numerical model therefore appears adequate for the applications to fast depressurizations of the present paper, which do not involve shock formation.
4.2. Relaxation operators
In the literature, most of the works deal with instantaneous relaxation procedures to be used for very simple EoS as the stiffened gas one. In De Lorenzo et al. (2019), the authors proposed novel techniques to describe the physics involved into the relaxation mechanisms. They consist of dynamical systems of ordinary differential equations that allow the equilibrium recovery. The novelty of this work lies in the EoS independence of the numerical techniques.
These relaxation processes can be split into three systems of ODEs, each one modeling a different physical phenomenon. In this work the systems of ODEs are calculated using a high order explicit Runge–Kutta (RK) method with adaptive stepsize, that is, the so-called RK45 (Fehlberg, 1969). This method is fourth order accurate with an error estimator of fifth order for the calculation of the variable time step.
The drawback of this explicit method is the loss of stability for stiff problems. However, one may refer to the appendix of De Lorenzo et al. (2019) for alternative robust semi-analytical methods if needed.
At the end of the hyperbolic operator step, phases are in full thermodynamic disequilibrium. This is reduced using three relaxation operators that are used in series. First the pressure equilibrium step, then the temperature relaxation one and, finally, the mass transfer procedure.
4.2.1. Pressure relaxation operator
The pressure relaxation procedure is a system of ODEs composed of two equations. In the canonical form it writes
(41)dρ1dt=-1ap1-p2Θp,de1dt=-pintaρ12p1-p2Θp,
where
(42)a=ρ1Γ1pintρ12-∂e1∂ρ1p1+ρ2Γ2α1ρ2α2ρ1pintρ22-∂e2∂ρ2p2.
pint indicates the interfacial pressure. To see the consistency between System (41) and the corresponding first term in the right-hand-side of advection and energy equations in Eq. (6), refer to De Lorenzo et al. (2019). This relaxation is based on the first law of the thermodynamics and an exponential time-decay for the pressure disequilibrium. It allows a semi-analytical integration, then, it is very robust even for stiff cases (Θp≪1).
Since we use the six-equation model to integrate more easily the five-equation model of Kapila et al. (2001), the pressures equilibrium is required at the end of this pressure relaxation step. Hence, sufficiently small Θp must be used. For instance, for Θp=Δtconv/9, the final pressure disequilibrium is around the 0.01% of the initial one. As a result, phases may be considered to be roughly in pressure equilibrium.
4.2.2. Temperature relaxation operator
The temperature relaxation procedure is based on the first law of thermodynamics and the Newton’s law for the convection. This step is the one responsible for the sensible heat transfer. In the canonical form, the system to solve is
(43)dρ1dt=-hAintV(T2-T1)1aΓ1α1+Γ2α2,de1dt=-hAintV(T2-T1)pintaρ12Γ1α1+Γ2α2-1m1.
h is the heat transfer coefficient expressed in W/m2·K and Aint is the interface area expressed in m2 and flow pattern dependent. One can use some empirical correlations to estimate them or can use hAintV as a parameter for speeding up or slowing down the sensible heat transfer process.
To see the consistency between System (43) and the corresponding second term in the right-hand-side of advection and energy equations in Eq. (6), refer to De Lorenzo et al. (2019).
For very fast temperature relaxation processes, a more robust technique is reported in the appendix of De Lorenzo et al. (2019). It is a semi-analytical procedure based on an exponential time-decay for the temperature disequilibrium.
4.2.3. Mass transfer operator
The mass transfer procedure models the condensation and evaporation events. The procedure proposed in De Lorenzo et al. (2019) is very flexible because it may incorporate various models present in the literature. For instance nucleation models (see Plesset and Zwick, 1954, Prosperetti and Plesset, 1978), statistical mechanics theory (see Ward, 1977), or simpler relaxation models (Bilicki and Kestin, 1990).
It is based on the pressure equilibrium between phases and phasic temperature difference invariance. This latter condition means that the heat transfer occurring in this processes is the latent one. No sensible heat transfer occurs. The canonical form of this relaxation process is
(44)dm1dt=-G1→2AintV,dρ1dt=-G1→2AintVipkT-kpiTkpjT-jpkT,de1dt=-G1→2AintVjpiT-ipjTkpjT-jpkT.
To close the system, a closure law for the mass transfer term G1→2Aint is needed.
The mass transfer is due to a chemical disequilibrium, that is, a difference between phasic Gibbs free enthalpies. For this reason, many authors in the literature assumes (Pelanti and Keh-Ming Shyue, 2014, Pelanti and Keh-Ming Shyue, 2019, Saurel et al., 2008, Zein et al., 2010, Linga and Flatten, 2019):
(45)G1→2∝(g1-g2).
In this work, we assume
(46)G1→2AintV=g1-g2Θg,
where Θg is the characteristic time for the chemical equilibrium recovery. Such magnitude is not clearly known, then, we adopt a correlation inspired from De Lorenzo et al., 2017, Bilicki and Kestin, 1990, Downar-Zapolski et al., 1996, i.e.
(47)Θg=Kgαv-0.25psat-ppcrit-psat-1.8,
where psat indicates the saturation pressure corresponding to the equilibrium temperature that has been already reached in the previous relaxation step. In case the thermal equilibrium has not been reached yet, it refers to the liquid temperature because in a depressurization the phenomenon that triggers the vaporization is the metastability of the liquid.
This term is fundamental because it controls the phase transition kinetics. It is important to precise that if the kinetics is not sufficiently fast, phases can go into a too deep metastability and, as a result, cross the spinodal line. When this occurs, the numerical simulation stops because an unstable thermodynamic state has been detected. Due to the proximity of the saturation line to the spinodal line, the detection of unphysical states is more likely to occur for the liquid phase than for the vapor one (see Fig. 3).
<Section>5. Numerical simulations of fast depressurizations</Section>
In the context of nuclear safety, the Loss of Coolant Accident (LOCA) is one of the Design Basis Accidents (DBA). It represents the sudden rupture of a primary system pipe of a nuclear power plant. When it occurs, a rarefaction wave originates at the breach and moves upstream in the primary circuit. The interaction of this wave with the reactor core may lead to the mechanical damage of core components. Then, for the fluid–structure analysis, the correct calculation of the rarefaction wave amplitude is of paramount importance.
The thermodynamic disequilibrium plays a crucial role on the rarefaction wave amplitude, thus, a simple HEM can not produce a correct simulation of these flows. Therefore, to improve the industrial simulation tools, the single-velocity six-equation model has been implemented in the fast dynamic code EUROPLEXUS.
Since the phenomena involving metastable states were not completely known, in the ’70s–’80s, some experimental campaigns have been carried out. The experimental facilities for the industrial scenarios focused on the rapid depressurization of vessels or pipes containing water at subcooled conditions (Bartak, 1990, Edwards and O’Brien, 1970, Riegel, 1978).
In this section we use these experiments for the validation of the methodology discussed above with the EUROPLEXUS code. The benchmark is performed using the experimental data of Bartak (1990), Edwards and O’Brien (1970) and Super Canon test rig (Riegel, 1978).
5.1. Experimental device description
Super Canon facility was set up in France in the ’70s and its experimental campaign was more devoted to the global transient, that is, for the analysis of the two-phase flow features from the break up to the complete blown down of the test rig. The schematic of the Super Canon facility and the measurement devices are shown in Fig. 6. It consists in a 4.389 m long horizontal pipe, with an internal diameter of 102.3 mm completely filled with degassed water. At one extremity of the pipe, there is a rupture disc whose sudden opening triggers the pipe depressurization. The opening is the 100% of the cross section. At the other extremity, the pipe is fully closed. It comprises six pressure transmitters and a void fraction measurement device.
Fig. 6. Schematic of Super Canon experimental facility and location of the measurement devices.
The Edwards-O’Brien test rig is similar to the Super Canon one. It is an horizontal pipe of 4.096 m with an internal diameter of 73.15 mm. Unlike the previous experiments, the cross section of the break is 12.5% smaller than the cross section of the pipe.
Conversely to the previous ones, the Bartak test rig consists of a pressure vessel and a discharge pipe of 1.7 m equipped with pressure transmitters and a rupture disc at the end. The internal diameter of the discharge pipe is 80 mm and the abrupt opening is the 100% of the cross section.
For further details about the test rig geometries and the measurement techniques, one may refer to Bartak, 1990, Edwards and O’Brien, 1970, Riegel, 1978.
For all tests, the fluid is at rest at the moment of the abrupt opening. The initial pressure and temperature conditions are 12.5MPa and 563.15K for the Bartak test, 10.34MPa and 557.59K for the Edwards-O’Brien test, and 15MPa and 593.15K for the Super Canon test. Then, the corresponding subcooling degrees, i.e. Tsat(pin)-Tin, are, respectively, 38K,29K and 22K. Generally, the higher the subcooling degree, the deeper the metastability reached.
All numerical tests have been simulated using a simplified 1D geometry. The sudden opening is simulated as a Riemann problem with the experimental conditions on one side of the discontinuity and a quasi-infinite vessel filled atmospheric steam on the other side. On the end of the pipe, for Super Canon and Edwards-O’Brien tests, there is a wall boundary conditions. Whereas, for Bartak test, the pressure vessel is modeled as a 0D vessel of large dimensions.
For all tests, we conducted a convergence study and we report here only the results obtained using a 1000 cells mesh. These results are no longer affected by nodalization choices.
5.2. Analysis of the numerical results
At that moment, a rarefaction wave originates at the break and moves backward. The very first part of the transient is well represented by the Bartak and Edwards-O’Brien data, whereas, the Super Canon experiments represent the global transient.
The depressurization is initially abrupt and fast, then pressure drops below the saturation pressure corresponding to the initial stagnation temperature (7.4MPa in Bartak experiment, 6.8MPa in Edwards-O’Brien test, 11.2MPa for Super Canon). The liquid water is then into the metastable domain.
Since the abrupt depressurization has led the liquid into a deep metastable condition, the fluid is driven from the thermo-chemical disequilibrium towards the thermodynamic stability condition. Then, the depressurization is stopped by a quick vaporization, also called explosion-like nucleation. The system pressure is therefore driven towards the saturated conditions. Further discussions about the rate of depressurization, the pressure undershoot and the homogeneous nucleation phenomenon can be found in Alamgir and Lienhard, 1981, Bartak, 1990, Carey, 2007, Debenedetti, 1996, Skripov and Sinicyn, 1980.
In Fig. 7, Fig. 8, Fig. 9, Fig. 10 we show the comparisons of the numerical simulations obtained with the single-velocity six-equation model and the experimental data. To underline the importance of the thermo-chemical disequilibrium, we report as well the numerical results of the HEM. From these figures we can observe that the pressure undershoot just discussed is well reproduced by the six-equation model, whereas, for the HEM, the mixture always remains at saturated conditions. This means that a numerical simulation performed with a HEM leads to an underestimation of the amplitude of the rarefaction wave, then, for a fluid–structure interaction analysis, the HEM leads to an underestimation of the mechanical consequences on the structure.
Fig. 7. Pressure evolution in the first 16ms of the Bartak’s experiment (Bartak, 1990) (12.5MPa,563.15K). Assessment of the single-velocity six-equation model against the experimental data and the HEM results. For this calculation, the 1.7m long tube has been discretized into a 1000 cells mesh and Kg=4.
Fig. 8. Assessment of the single-velocity six-equation model on a Edwards-O’Brien experiment. The initial stagnation conditions are 10.34MPa and 557.59K (1500psia,544°F). For this calculation, the 4.096m long tube has been discretized into a 1000 cells mesh and Kg=0.5.
Fig. 9. Assessment of the single-velocity six-equation model on a Super Canon experiment: pressure evolution. The initial stagnation conditions are 15MPa and 593.15K. For this calculation, the 4.389m long tube has been discretized into a 1000 cells mesh and Kg=0.6.
Fig. 10. Assessment of the single-velocity six-equation model on a Super Canon experiment: void fraction evolution. The initial stagnation conditions are 15MPa and 593.15K. For this calculation, the 4.389m long tube has been discretized into a 1000 cells mesh and Kg=0.6.
By the experimental measurements we know that the velocity of propagation of the rarefaction wave compares well with the isentropic speed of sound of the liquid water initially present into the system. From Fig. 7, Fig. 8 we can see that this velocity is correctly simulated by both equilibrium and disequilibrium two-phase flow models.
For a HEM simulation, once the rarefaction wave has taken the fluid into the two-phase domain, phase transition takes place in order to maintain phases at full thermodynamic equilibrium. In this case, phase transition starts when the fluid reaches the saturated liquid curve.
For the single-velocity six-equation model, the rarefaction wave propagates into the liquid and takes it to metastable conditions. Phase transition does not take place immediately when the fluid reaches the saturated conditions, thus, the amplitude of the rarefaction wave is wider than in the HEM calculations. For the single-velocity six-equation model, the mass transfer that transforms the liquid into vapor is activated only when metastable conditions are detected. Once one of the two phases crosses the saturation curve, the mass transfer is activated and its intensity is proportional to the chemical disequilibrium (see Eq. (46)). This is coherent with the theory of thermodynamic stability according to which a deeper metastability condition leads to a faster mass transfer (Carey, 2007). Summarizing, this modeling choice allows to well represent the two main physical features occurring in fast depressurizations: (i) the correct amplitude of the rarefaction wave, and (ii) the explosion-like nucleation phenomenon.
Considering the whole depressurization Super Canon experiment in Fig. 9, after the explosion-like nucleation at the first milliseconds, the pressure remains constant, but at values lower than the saturation one. Hence the liquid is still in metastable conditions. After 50ms, the pressure decreases due to the emptying of the capacity. The emptying rate is imposed by the two-phase critical flow that sets at the breach (De Lorenzo et al., 2017).
<Section>6. Conclusions</Section>
In the present work we have developed a single-velocity six-equation model for phase transition flows, and implemented it in the EUROPLEXUS code. The industrial objective of this work was to provide the EUROPLEXUS code with a single-velocity hyperbolic model able to deal with thermal and chemical disequilibria to be used for the fluid–structure interaction analysis of hypothetical accidents in nuclear reactors.
This work results from the merging of two techniques previously developed by the same authors. The first technique was the fast and accurate calculation of steam-water properties (De Lorenzo et al., 2017). The second technique was the treatment of the relaxation processes source terms by means of EoS-independent numerical procedures (De Lorenzo et al., 2019).
Typically, one can distinguish two kinds of two-phase flow modeling approaches: an industrial one and an academical one. For the industrial-aimed numerical modeling, the process of equilibrium recovery between liquid and vapor is usually treated by using experimental correlations or simple models (RELAP5/MOD3.3, 2001, Tiselj and Petelin, 1997, Gale et al., 2008, Bestion, 1990). The advantage of the industrial codes came from the capability to use accurate EoS or tabulated ones. In the academical numerical modeling context, the process of equilibrium recovery is often decomposed according to the physical disequilibria (Crouzet et al., 2015, Pelanti and Keh-Ming Shyue, 2014, Saurel et al., 2008, Zein et al., 2010). Then, it is closer to the physics. However, the drawback of these procedures lies in the difficulty of using accurate EoS.
Nevertheless, for a wide industrial use, adopting accurate EoS is necessary. Our work is based on a physically consistent analysis of the metastable flows, that is widely used in the literature (Crouzet et al., 2015, Pelanti and Keh-Ming Shyue, 2014, Saurel et al., 2008, Saurel et al., 2009, Zein et al., 2010). Thanks to that, the disequilibrium between the phases can be correctly taken into account because of the splitting of pressure, temperature and Gibbs free enthalpy disequilibria, and, at the same time, the numerical calculations rely on fast and accurate EoS.
The new methodology has been validated on experimental data of rapid depressurization tests available in the literature.
The perspectives of this work are multiple. From the industrial point of view, a medium-term perspective could be the adjustment of the relaxation techniques to the velocity disequilibrium case and their coupling with the seven-equation model already present in EUROPLEXUS (Crouzet et al., 2015, Lochon, 2016). In that case, no adjustments would be necessary for using the steam-water tables within the seven-equation model.
From the academical point of view, thanks to the decoupling of the physical phenomena effects (compression, sensible heat and latent heat transfers), one can conduct a finer analysis of equilibrium recovery mechanisms. Using these techniques, it could be possible to increment the physical understanding of some phenomena, simulating vapor bubbles cavitation or liquid droplets vaporizations. This analysis of the thermal and chemical disequilibria can be useful to extrapolate new macroscopic correlations, for example. A preliminary step towards this goal has already started at IMSIA, joint laboratory EDF-CNRS-ENSTA-CEA. The single-velocity six-equation model together with the steam-water tables have been implemented on the high-order code called Code_Safari (Daude et al., 2012, Emmert et al., 2009).
From the macroscopic point of view, the novel relaxation procedures allow to study same physical phenomena at different flow pattern regimes. It could be interesting to study the dependency of some phenomena on the topological magnitudes (interfacial area).
Moreover, the mass transfer procedure proposed in De Lorenzo et al. (2019) and described in Section 4.2.3 allows us to take into account different phase transition models using the same numerical framework. This could be used to conduct benchmark tests of the different phase transition models (nucleation models, relaxations models, etc.) against experimental data.
Lastly, despite our efforts, the irreversibility of the model has not been formally proven yet. Therefore, a perspective work is also the proof that the final model generates entropy in each of its interphase transfer terms.
<Section>Declaration of Competing Interest</Section>
The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.
<Section>Acknowledgments</Section>
The authors would like to gratefully thank Pascal Galon (CEA) and Frédéric Daude (EDF) for helpful discussions and advice for the implementation of the flow model in EUROPLEXUS.
<Section>Appendix A. Coefficients for the mass transfer mechanism</Section>
The coefficient for the mass transfer process involve the partial derivatives of the thermodynamic properties and are:
(A.1)ip=ρ2Γ2e1-e2m2+∂p2∂ρ2e2ρ1-ρ2α2ρ1,jp=∂p1∂ρ1e1+∂p2∂ρ2e2α1ρ2α2ρ1,kp=ρ1Γ1+ρ2Γ2m1m2,
and
(A.2)iT=1Cv,2e1-e2m2+∂T2∂ρ2e2ρ1-ρ2α2ρ1,jT=∂T1∂ρ1e1+∂T2∂ρ2e2α1ρ2α2ρ1,kT=1Cv,1+1Cv,2m1m2.
where Γk are the phasic Grüneisen coefficients, Cv,k are the phasic specific heats at constant volume and mk=αkρk are the phasic partial densities.
<Section>Appendix B. Entropy source terms of the complete model</Section>
The interphasic processes are irreversible, then, they lead to an increase of the mixture entropy. To check this physical and mathematical feature, we now transform the energy source terms into corresponding entropy source terms. For this purpose, we use the product rules for derivatives and the fundamental thermodynamic differential
(A.3)dek=Tkdsk+pkρk2dρk.
Ignoring transport effects in Eq. (6), phasic entropies evolutions read:
(B.2a)ds1dt=(p1-pint)(p1-p2)aT1ρ12Θp.
(B.2b)ds2dt=(pint-p2)(p1-p2)aT2ρ1ρ2Θpα1α2
Thus, considering that the mixture entropy is S=α1ρ1s1+α2ρ2s2, its time-derivative is
(B.3)dSdt=-α1(p1-p2)aT1T2ρ1Θp[pint(T2-T1)+T1p2-T2p1].
For the temperature relaxation process, the time evolutions of phasic entropies are
(B.4a)ds1dt=1ρ1T1hAintV(T2-T1)1aρ1Γ1α1+Γ2α2(p1-pint)+1α1,
(B.4b)ds2dt=1ρ2T2hAintV(T2-T1)1aρ1Γ1α1+Γ2α2(pint-p2)-1α1α1α2.
The time-derivative of the mixture entropy is
(B.5)dSdt=α1hAintV(T2-T1)1aρ1Γ1α1+Γ2α2p1-pintT1+pint-p2T2+1α11T1-1T2.
For the general case of p1≠p2, investigating the sign of this function, it is too complex to analytically demonstrate the irreversibility of the process. In the limit case of p1=p2, (B.5) becomes
(B.6)dSdt=hAintV(T1-T2)2T1T2⩾0.
Hence, if the temperature relaxation occurs when phases are at pressure equilibrium, the sensible heat transfer process is irreversible as it must be. In our case, we have a stiff pressure relaxation forcing phasic pressures to numerically converge prior to proceeding with the temperature relaxation process. Therefore, we are very close to the limit case reported in (B.6).
Even if the thermal relaxation process occurs keeping p1≈p2, in order to check the physical consistency of our code, we calculate the mixture entropy at the beginning and at the end of this relaxation to notify whether it has decreased. In all the numerical tests performed so far, we have never detected a single decrease of the mixture entropy.
Finally, for the mass transfer process, the time-derivatives of phasic entropies are:
(B.7a)ds1dt=+p1ρ12(ipkT-kpiT)-(jpiT-ipjT)(kpjT-jpkT)T1G1→2AintV,
(B.7b)ds2dt=-p2ρ12(ipkT-kpiT)-(jpiT-ipjT)(kpjT-jpkT)T2G1→2AintVm1m2,
for the mixture:
(B.8)dSdt=-α1ρ1(T1-T2)T1T2p1ρ12(ipkT-kpiT)-(jpiT-ipjT)(kpjT-jpkT)+(s1-s2)G1→2AintV.
Similarly to temperature relaxation, it is too complex to analytically demonstrate the irreversibility of the process. But unlike temperature relaxation, it is not possible to define a limit case in which the irreversibility is ensured. To check the physical consistency of our code, we compute the mixture entropy at the beginning and at the end of the mass transfer process. In all the numerical tests performed so far, we have never detected a decrease of the mixture entropy. This empirical check is not to be intended as a proof of irreversibility, because it is just an informatic warning to notify whether the mixture entropy has ever decreased.
<Section>Supplementary data</Section>
The following are the Supplementary data to this article:
Supplementary data 1.
<Section>Research data for this article</Section>
Data not available / The authors do not have permission to share data
About research data
<Section>References</Section>
Alamgir and Lienhard, 1981
M. Alamgir, J.H. Lienhard
Correlation of pressure undershoot during hot water depressurization
J. Heat Transfer, 103 (1981), pp. 52-55
CrossRefView Record in ScopusGoogle Scholar
Baer and Nunziato, 1986
M.R. Baer, J.W. Nunziato
A two-phase mixture theory for the deflagration-to-detonation transition (ddt) in reactive granular materials
Int. J. Multiphase Flow, 12 (1986), pp. 861-889
ArticleDownload PDFView Record in ScopusGoogle Scholar
Bartak, 1990
J. Bartak
A study of the rapid depressurization of hot water and the dynamics of vapour bubble generation in superheated water
Int. J. Multiphase Flow, 16 (1990), pp. 789-798
ArticleDownload PDFView Record in ScopusGoogle Scholar
Bestion, 1990
D. Bestion
The physical closure laws in the CATHARE code
NED, 124 (1990), pp. 229-245
ArticleDownload PDFView Record in ScopusGoogle Scholar
Bilicki and Kestin, 1990
Bilicki Z., Kestin J., 1990. Physical aspects of the relaxation model in two-phase flow, Proceedings of the Royal Society A, Math. Phy. Sciences, vol. 428, 379–97.
Google Scholar
Carey, 2007
V.P. Carey
Liquid-Vapor Phase-Change Phenomena, Francis & Taylor, New York, USA (2007)
Google Scholar
Chiapolino et al., 2017
Chiapolino A., Boivin P., Saurel R., 2017. A simple phase transition relaxation solver for liquid–vapor flows. Int. J. Numer. Meth. Fluids 2017; 83:583–605.
Google Scholar
Coquel et al., 2002
Coquel F., Gallouet T., Herard J.-M., Seguin N., 2002. Closure laws for a two-fluid two-pressure model. Comptes Rendus Mathematique, vol. 334, 927-32.
Google Scholar
Cowperthwaite, 1969
M. Cowperthwaite
Relationships between Incomplete Equations of State
J. Franklin Inst., 285 (1969), pp. 379-387
ArticleDownload PDFView Record in ScopusGoogle Scholar
Crouzet et al., 2015
F. Crouzet, F. Daude, P. Galon, J.-M. Hérard, O. Hurisse, Y. Liu
Validation of a two-fluid model on unsteady liquid–vapor water flows
Comput. Fluids, 119 (2015), pp. 131-142
ArticleDownload PDFView Record in ScopusGoogle Scholar
Daude et al., 2012
F. Daude, J. Berland, T. Emmert, Ph. Lafon, F. Crouzet, C. Bailly
A high-order finite-difference algorithm for direct computation of aerodynamic sound
Comput. Fluids, 61 (2012), pp. 46-63
ArticleDownload PDFView Record in ScopusGoogle Scholar
Daude et al., 2014
F. Daude, P. Galon, Z. Gao, E. Blaud
Numerical experiments using a HLLC-type scheme with ALE formulation for compressible two-phase flows five-equation models with phase transition
Comput. Fluids, 94 (2014), pp. 112-138
ArticleDownload PDFView Record in ScopusGoogle Scholar
Davis, 1988
S.F. Davis
Simplified second-order Godunov-type methods
SIAM J. Sci. Stat. Comput., 9 (1988), pp. 445-473
CrossRefGoogle Scholar
Debenedetti, 1996
P.G. Debenedetti
Metastable Liquids: Concepts and Principles
Princeton University Press, Princeton, NJ (1996)
Google Scholar
De Lorenzo, 2018
De Lorenzo M., 2018, Modelling and numerical simulation of metastable two-phase flows. Ph.D. thesis from Université Paris-Saclay.
Google Scholar
De Lorenzo et al., 2017
M. De Lorenzo, Ph. Lafon, J.-M. Seynhaeve, Y. Bartosiewicz
Benchmark of delayed equilibrium model (DEM) and classic two-phase critical flow models against experimental data
Int. J. Multiphase Flow, 92 (2017), pp. 112-130
ArticleDownload PDFView Record in ScopusGoogle Scholar
De Lorenzo et al., 2017
M. De Lorenzo, Ph. Lafon, M. Di Matteo, M. Pelanti, J.-M. Seynhaeve, Y. Bartosiewicz
Homogeneous two-phase flow models and accurate steam-water table look-up method for fast transient simulations
Int. J. Multiphase Flow, 95 (2017), pp. 199-219
ArticleDownload PDFView Record in ScopusGoogle Scholar
De Lorenzo et al., 2018
M. De Lorenzo, M. Pelanti, Ph. Lafon
HLLC-type and path-conservative schemes for a single-velocity six-equation two-phase flow model: a comparative study
Appl. Math. Comput., 333C (2018), pp. 95-117
ArticleDownload PDFView Record in ScopusGoogle Scholar
De Lorenzo et al., 2019
M. De Lorenzo, Ph. Lafon, M. Pelanti
A hyperbolic phase-transition model with non-instantaneous EoS-independent relaxation procedures
J. Comput. Phys., 379 (2019), pp. 279-308
ArticleDownload PDFView Record in ScopusGoogle Scholar
Downar-Zapolski et al., 1996
P. Downar-Zapolski, Z. Bilicki, L. Bolle, J. Franco
The non-equilibrium relaxation model for one-dimensional flashing liquid flow
Int. J. Multiphase Flow, 22 (1996), pp. 473-483
ArticleDownload PDFView Record in ScopusGoogle Scholar
Dumbser et al., 2013
M. Dumbser, U. Iben, C.-D. Munz
Efficient implementation of high order unstructured WENO schemes for cavitating flows
Comput. Fluids, 86 (2013), pp. 141-168
ArticleDownload PDFView Record in ScopusGoogle Scholar
Edwards and O’Brien, 1970
A.R. Edwards, T.P. O’Brien
Studies of phenomena connected with the depressurization of water reactors
J. British Nucl. Soc., 9 (1970), pp. 125-135
View Record in ScopusGoogle Scholar
Emmert et al., 2009
T. Emmert, Ph. Lafon, C. Bailly
Numerical study of self-induced transonic flow oscillations behind a sudden duct enlargement
Phys. Fluids, 21 (2009), Article 106105
CrossRefGoogle Scholar
Europlexus User’s Manual, 2016
Europlexus User’s Manual, 2016. Technical Report, Joint Research Centre (JRC), Commissariat á l’énergie atomique et aux énergies alternatives (CEA). URL http://europlexus.jrc.ec.europa.eu/public/manual_html/index.html.
Google Scholar
Fehlberg, 1969
E. Fehlberg
Low-order classical Runge-Kutta formulas with step size control and their application to some heat transfer problems
NASA Technical Report, 315 (1969)
Google Scholar
Gale and Tiselj, 2008
Gale J., Tiselj I., 2008, Modeling of pressure undershoot and heat and mass transfer at negative pressures. ASME FEDSM2005-77146, pp. 807–14.
Google Scholar
Gale et al., 2008
J. Gale, I. Tiselj, A. Horvat
Two-fluid model of the WAHA code for simulations of water hammer transients
Multiphase Sci. Technol., 20 (2008), pp. 291-322
View Record in ScopusGoogle Scholar
Goncalvès, 2014
Goncalvès E., Charrière B., 2014, Modelling for isothermal cavitation with a four-equation model. Int. J. Multiphase Flow 59 54–72.
Google Scholar
Johnsen and Colonius, 2006
E. Johnsen, T. Colonius
Implementation of WENO schemes in compressible multicomponent flow problems
J. Comput. Phys., 219 (2006), pp. 715-732
ArticleDownload PDFView Record in ScopusGoogle Scholar
Kapila et al., 2001
A.K. Kapila, R. Menikoff, J.B. Bdzil, S.F. Son, D.S. Stewart
Two-phase modeling of deflagration-to-detonation transition in granular materials: reduced equations
Phys. Fluids, 13 (2001), pp. 3002-3025
View Record in ScopusGoogle Scholar
Kunick, 2015
M. Kunick, et al.
CFD Analysis of steam turbines with the IAPWS standard on the spline-based table look-up method (SBTL) for the fast calculation of real fluid properties
Turbine Technical Conference and Exposition: Proceedings of ASME Turbo Expo 2015 (2015)
Google Scholar
Kunick et al., 2017
M. Kunick, R.A. Berry, R.C. Martineau, H.-J. Kretzschmar, U. Gampe
Application of the new IAPWS Guideline on the fast and accurate calculation of steam and water properties with the spline-based table look-up method (SBTL) in RELAP-7
Kerntechnik, 82 (2017), pp. 1-16
Google Scholar
Kyriazis et al., 2017
N. Kyriazis, P. Koukouvinis, M. Gavaises
Numerical investigation of bubble dynamics using tabulated data
Int. J. Multiphase Flow, 93 (2017), pp. 158-177
ArticleDownload PDFView Record in ScopusGoogle Scholar
LeVeque, 2002
LeVeque R., 2002, Finite Volume Methods for Hyperbolic Problems. Cambridge University Press, UK.
Google Scholar
Linga and Flatten, 2019
Linga G., Flatten T., 2019, A hierarchy of non-equilibrium two-phase flow models. ESAIM: Proceedings and Surveys, vol. 66.
Google Scholar
Lochon, 2016
Lochon H., 2016, Modélisation et simulation d’écoulements transitoires eau-vapeur. PhD thesis, Aix-Marseille.
Google Scholar
Pelanti and Keh-Ming Shyue, 2014
M. Pelanti, K.-M. Keh-Ming Shyue
A mixture-energy-consistent six-equation two-phase numerical model for fluids with interfaces, cavitation and evaporation waves
J. Comput. Phys., 259 (2014), pp. 331-357
ArticleDownload PDFView Record in ScopusGoogle Scholar
Pelanti and Keh-Ming Shyue, 2019
M. Pelanti, K.-M. Keh-Ming Shyue
A numerical model for multiphase liquid-vapor-gas flows with interfaces and cavitation
Int. J. Multiphase Flow, 113 (2019), pp. 208-230
ArticleDownload PDFView Record in ScopusGoogle Scholar
Plesset and Zwick, 1954
M.S. Plesset, S.A. Zwick
The growth of vapor bubbles in superheated liquids
J. Appl. Phys., 25 (1954), pp. 493-500
CrossRefView Record in ScopusGoogle Scholar
Press et al., 1997
W.H. Press, S.A. Teukolsy, W.T. Vetterling, B.P. Flannery
Numerical Recipes
Cambridge University Press, USA (1997)
Google Scholar
Prosperetti and Plesset, 1978
A. Prosperetti, M.S. Plesset
Vapour-bubble growth in a superheated liquid
J. Fluid Mech., 85 (1978), pp. 349-368
View Record in ScopusGoogle Scholar
RELAP5/MOD3.3, 2001
RELAP5/MOD3.3, 2001, code manual, vol. I. Idaho Falls, USA.
Google Scholar
Riegel, 1978
Riegel B., 1978, Contribution à l’étude de la décompression d’une capacité en régime diphasique. PhD thesis, Institut National Polytechnique de Grenoble.
Google Scholar
Saurel and Abgrall, 1999
Saurel R., Abgrall. R., 1999, A multiphase godunov method for compressible multiuid and multiphase flows. J. Comput. Phys. 150, 425–467.
Google Scholar
Saurel et al., 2003
Saurel R., Gavrilyuk S., Renaud F., 2003, A multiphase model with internal degree of freedom, application to shock–bubble interaction. J. Fluid Mech. 495, 283–321.
Google Scholar
Saurel et al., 2007
Saurel R., Le Metayer O., Massoni J., Gavrilyuk S., 2007, Shock jump relations for multiphase mixtures with stiffmechanical relaxation. Shock Waves, Vol.16, 209-32.
Google Scholar
Saurel et al., 2008
R. Saurel, F. Petitpas, R. Abgrall
Modelling phase transition in metastable liquids. Application to cavitating and flashing flows
J. Fluid Mech., 607 (2008), pp. 313-350
CrossRefView Record in ScopusGoogle Scholar
Saurel et al., 2009
R. Saurel, F. Petitpas, R.A. Berry
Simple and efficient relaxation methods for interfaces separating compressible fluids, cavitating flows and shocks in multiphase mixture
J. Comput. Phys., 228 (2009), pp. 1678-1712
View Record in ScopusGoogle Scholar
Skripov and Sinicyn, 1980
V.P. Skripov, P.A. Sinicyn, et al.
Teplofizicheskyie Svoyistva Zhidkostey v Metastabil’nom Sostoyanyii
Atomizdat, Moskva (1980)
Google Scholar
Strang, 1968
Strang, 1968, On the construction and comparison of difference schemes. SIAM J. Numer. Anal. 5, 506–517.
Google Scholar
Suchanek and Bartak, 1989
Suchanek M., Bartak J., 1989, Thermohydraulic Behavior of the coolant in the initial phase of a loss-of-coolant accident. Proceedings of the Second International Symposium on Multiphase Flow and Heat Transfer, pp. 929–938.
Google Scholar
Tiselj and Petelin, 1997
I. Tiselj, S. Petelin
Modelling of two-phase flow with second-order accurate scheme
J. Comput. Phys., 136 (1997), pp. 503-521
ArticleDownload PDFView Record in ScopusGoogle Scholar
Tiselj and Petelin, 1999
Tiselj I., Petelin S., 1999, Integration of the source terms in the two-fluid models. NURETH 19.
Google Scholar
Tiselj et al., 2008
I. Tiselj, A. Horvat, J. Gale
Numerical scheme of the WAHA code
Multiphase Sci. Technol., 20 (2008), pp. 323-354
View Record in ScopusGoogle Scholar
Toro, 1997
E.F. Toro
Riemann Solvers and Numerical Methods for Fluid Dynamics
Springer-Verlag, Berlin, Heidelberg (1997)
Google Scholar
Wagner et al., 2000
W. Wagner, et al.
The IAPWS industrial formulation 1997 for the thermodynamic properties of water and steam
ASME J. Eng. Gas Turbines Power, 122 (2000), pp. 150-182
View Record in ScopusGoogle Scholar
Wagner and Pruß, 2002
W. Wagner, A. Pruß
The IAPWS formulation 1995 for the thermodynamic properties of ordinary water substance for general and scientific use
J. Phys. Chem. Ref. Data, 31 (2002), pp. 387-535
View Record in ScopusGoogle Scholar
Ward, 1977
C.A. Ward
The rate of gas absorption at a liquid interface
J. Chem. Phys., 67 (1977), pp. 229-235
View Record in ScopusGoogle Scholar
Zein et al., 2010
A. Zein, M. Hantke, G. Warnecke
Modeling phase transition for compressible two-phase flows applied to metastable liquids
J. Comput. Phys., 229 (2010), pp. 2964-2998
ArticleDownload PDFView Record in Scopus