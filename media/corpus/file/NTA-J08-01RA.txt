<title>Automated method of tracing proton tracks in nuclear emulsions</title>
<Affiliation>a.Northwest Institute of Nuclear Technology, P.O. box 69-9, Xi’an, Shaanxi 710024, People's Republic of China
b.Academy of Nuclear Science and Technology, Xi’an Jiaotong University, Xi’an, Shaanxi 710049, People's Republic of China</Affiliation>
<author>Jin-lu Ruan , Hong-yun Li, Ji-wen Song , Jian-fu Zhang , Liang Chen，Zhong-bing Zhang , Jin-liang Liu , Lin-yue Liu </author>
<year>2015</year>
<Jounral>Nuclear Instruments and Methods in Physics Research A</Journal>
<Publishing_house> Elsevier </Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.nima.2015.03.075</DOI>
<URL>http://dx.doi.org/10.1016/j.nima.2015.03.075</URL>
a b s t r a c t
The low performance of the manual recognition of proton-recoil tracks in nuclear emulsions has limited its application to energy spectrum measurement of a pulsed neutron source. We developed an automated microscope system to trace proton-recoil tracks in nuclear emulsions. Given a start point   on the proton track of interest, the microscope system can automatically trace and record the entire track using an image processing algorithm. Tests indicate that no interaction of the operator is needed in tracing the entire track. This automated microscope greatly reduces the labor of the operator and increases the efﬁciency of track data collection in nuclear emulsion.
Keyword:
Proton recoil tracks     Nuclear emulsion     Track recognition     Neutron spectrum    Tracing tracks
1.Introduction
Nuclear emulsion used as a charged particle detector has a long history, and has made outstanding contributions in the ﬁelds of elementary particle physics, high energy physics [1], nuclear physics and so on for its excellent submicron spatial resolution [2–4]. Nuclear emulsions consist of gelatin substrates, in which silver-bromide microcrystals with a typical diameter of 200 nm uniformly are interspersed [4,5]. When a charged particle passes through the nuclear emulsion, its trajectory is recorded as a sequence of latent images. The latent images appear as a sequence of metallic silver grains with a diameter of about 1 μm [6,7], which become visible under an optical microscope as dots, namely track grains, along the trajectory after a chemical development.
Before fast electronic nuclear detectors come into  being,  nuclear emulsion is widely used as a neutron detector. Although the usage of nuclear emulsion in neutron experiments gradually decreases with the rapid developments of the fast electronic technique, the nuclear emulsion is still an important and effective choice for measurements of neutron energy spectrum and yield in some cases [2,8], especially when time-of-ﬂight  measurement  is not suitable.
As a neutron detector, the nuclear emulsion has some unique advantages: simple structure, small volume and low cost; high spatial resolution; high stopping power and no ‘dead time’ [9]; coverage of 4π geometry [10,11] and 100% detection efﬁciency for recording proton-recoil tracks from n–p reactions. However, an obvious drawback, that the tracks of proton-recoil have to be measured manually one by one with a microscope, limits the extensive application of the nuclear emulsion. This manual read out process is time consuming and laborious. Therefore, many automatic track recognition systems have been developed [7, 12–16] with the evolutions of electronics, automatic scanning technologies and computing technologies under the promotions of international cooperation experiments, such as OPERA (Oscilla- tion Project with Emulsion tRacking Apparatus). However, these systems are mainly developed for the recognition of tracks of the high energetic particles impinging on a series of parallel thin nuclear emulsions (40–50 μm) almost along the normal of the nuclear emulsion surface as shown in Fig. 1(a) [15,17,18]. The parts of the tracks of high-energy particles in a single thin nuclear emulsion are short and straight and can be fully observed in one ﬁeld of view (FOV) of the microscope [19,20]. These automatic scanning systems are designed speciﬁcally for the scenarios like OPERA. The algorithms used in these systems are not capable of tracing long tracks (hundreds of microns) nearly parallel to the surface of the emulsion plate. Moreover, these systems have large
Fig. 1. Comparisons between the characteristics of the tracks in thin nuclear emulsions and those in thick nuclear emulsions. (a) Tracks in a series of parallel thin nuclear emulsions irradiated by high energetic particles; (b) Proton-recoil tracks in thick nuclear emulsions irradiated by a collimated neutron beam.
limitations as, for example, the restricted angular acceptance in tracking, the difﬁculty in detecting short range tracks which start and stop in the thin nuclear emulsion and recognizing the tracks at angles with the direction of the incident particle (up to 1.3 rad)  [21]. Nevertheless, for the proton-recoil tracks produced by the neutrons inducing parallel to the surface of the thick nuclear emulsion (400–500 μm) (shown in Fig. 1(b)) used to measure the pulsed neutron energy spectrum, the techniques for recognizing the tracks of high energetic particles in thin nuclear emulsion are not suitable because all the tracks in 4π solid angle should be recognized and the recoil angles and the lengths of the tracks need to be measured accurately. Moreover, the tracks of the recoil protons in thick nuclear emulsions are long and ﬂexuous at the end, and only parts of some long tracks can be observed in one FOV. Usually, to obtain an entire track of recoil protons, we need to stitch the image sequences of several adjacent FOVs.
Therefore, in order to realize the automatic recognition of the proton tracks in nuclear emulsion to solve the limitations of the manual mode of recognizing tracks, prompt the applications of nuclear emulsions and reduce the burden of the operators, we present an automated method of tracing proton tracks. And we recognize the proton tracks by the method in the nuclear emulsion irradiated by the neutron beam at energy of 14.9 MeV.
2.The proton track recognition system
2.1.Hardware conﬁguration
The system used for the recognition of proton tracks in nuclear emulsion is illustrated in Fig. 2. This system consists of an automati- cally biological microscope with a computer-controlled motorized stage and multiple objective lenses, a CMOS camera with mega-pixel (1360 pixel 1024 pixel) resolution mounted on the top of the optical tube, a controller with a vision processor board and the motor control board and a control PC. The detailed information about the hardware of the system can be found in Ref. [22].
2.2.Processes of proton track recognition
The processes of the proton track recognition in nuclear emulsion are shown in Fig. 3. Firstly, a tomography of each FOV can be obtained by moving the stage with a step 0.3 μm along the z-axis to adjust the focal plane of the objective lens through the whole thickness of the nuclear emulsion. Then all the track images
Fig. 3. The processes of recognizing proton tracks.
in the entire volume of the nuclear emulsion can be obtained by moving the stage along the x-axis or y-axis to change the position  of the FOV. Furthermore, the track grains in the images are recognized by the image processing methods and the coordinates of the track grains are transformed according to the relative locations between the adjacent FOVs  under  the  same  coordin-  ate frame (that of the ﬁrst FOV). Finally, the proton tracks are reconstructed by connecting the track grains belonging to  the  same proton track. The more detailed introductions of the pro- cesses of proton track recognition can also be found in Ref. [22].
Sometimes, there are not any segments of proton tracks in many images of a tomography of one FOV, because the area (136μm ~ 102.4μm with a 100 ~ oil-immersion objective lens) of the FOV is too small. In this situation, storing and processing these images are wasting time and memory. So we proposed an auto- mated method of tracing proton tracks. In this method, operators just need to ﬁnd one proton track and pick out one track grain belonging to the track. Then the recognition system can realize the recognition of the entire track automatically and just save the images which contain the segments of the track.
3.Automated method of tracing the proton track
Track grains belonging to proton tracks are normally drowned in a sea of random background grains, produced during the development process. But there are strong space correlations between the coordinates of the track grains belonging to one same track. So we use this characteristic to realize the automated method of tracing the proton track. The scheme of the method is illustrated in Fig. 4, consisting of three steps: construction of the reference track, elongation of the reference track and reversed trace of the track respectively.
3.1.Construction of the reference track
3.1.1.Selection of the reference grain
The recognition system can make sure which track is the traced one after one grain belonging to the track is selected. So, one
proton track in the nuclear emulsion needed to be found by moving the stage along the x-axis, y-axis and/or z-axis at  ﬁrst. Then we picked out one grain (the blue symbol ‘n’ in Fig. 6(a)) belonging to the track from the image (the reference image) displayed on the screen of the control PC with a click of  the  mouse. But the coordinate of the grain picked out by the mouse had some discrepancy with that of  the  real  one  (illustrated  in  Fig. 6(b)) which was obtained by the method of recognizing track grains in nuclear emulsions described in Ref. [23]. Therefore, we chose the real grain, which was the closest one to the grain picked out, as the reference grain Pr (xr, yr, zr).
3.1.2.Algorithm of constructing of the micro-tracks
A segment of the proton track (called as a micro-track) including the reference grain Pr (xr, yr, zr) needed to be constructed as the onset of tracing the track by the system after the reference grain was obtained. Firstly, we obtained the coordinates of the grains recognized by the method for recognizing the grains proposed in Ref. [23] and stored the coordinates of the grains in the descending order according to the y-axis values of the coordinates. Because the collimated neutron beam induced along the opposite direction of the y-axis as illustrated in Fig. 1(b), the y-axis values of the coordinates of the grains belonging to the proton-recoil tracks changed obviously.
Then, we supposed that every one of the grains stored could be the starting grain of a segment of a track. For example, we chose the grain Pi (xi, yi, zi) as the starting point to search for another
grain Pj (xj, yj, zj) of which the coordinate satisﬁed the limitations of  the  Eq.  (1)  to  build  the  vector  Pi!Pj .  Maybe  many  grains  were
found to satisfy the limitations of Eq. (1). So we chose one of these
grains as the grain Pj (xj, yj, zj) and stored the coordinates of the grains Pi (xi, yi, zi) and Pj (xj, yj, zj) in an array Microsegment. As for
Fig. 4. Scheme of the automated method of tracing the proton track.
the others, they would also be chose as the grain Pj (xj, yj, zj) one by one after the construction of the micro-track was completed with the grain Pi (xi, yi, zi) and the current grain Pj (xj, yj, zj) as the ﬁrst two grains of the micro-track
@1
On  the  basis  of  the  vector  Pi!Pj ,  we  searched  for  one  grain  Pm
(xm, ym, zm) of which the coordinate satisﬁed the limitations of Eq. (2) to build the vector PjP!m . Maybe many grains were found to
satisfy  the  conditions  in  the  Eq.  (2).  So  we  chose  one  of  these
grains as the one Pm (xm, ym, zm) and stored the coordinate of the grain Pm (xm, ym, zm) the array Microsegment and updated the coordinates of the grain Pi (xi, yi, zi) and the grain Pj (xj, yj, zj) with
those of the grain Pj (xj, yj, zj) and the grain Pm (xm, ym, zm) to build the new vector Pi!Pj . As for the others, they would also be chose as
the grain Pm (xm, ym, zm) one by one after the construction of the
micro-track was completed with the grain Pi (xi, yi, zi), the grain Pj (xj, yj, zj) and the current Pm (xm, ym, zm). A micro-track was constructed by iterating the processes mentioned above until no grain Pm (xm, ym, zm) was found. The coordinates of the grains consisted of the micro-track were stored in the array Microsegment
@2
Finally, all micro-tracks in the reference image were con- structed until all the grains were already chose as the starting point. We just retained the micro-tracks consisting of more than two grains and deleted the others. However, one grain may belong
to multiple micro-tracks, because every one of the grains was chose  as  the  starting  point  of  a  micro-track,  the  ﬁrst  vector  P—i!Pj might be not unique and the grain Pm(Xm ym zm)also might not be unique  when  we  used  the  vector  Pi!Pj   to  ﬁnd  the  grain  which
satisﬁed the Eq. (2). In this situation, we compared the numbers of the micro-tracks which one grain or many grains belonged to simultaneously, retained the micro-track consisting of the most grains, and deleted the others. If there were multiple micro-tracks consisting of the most grains, the one resembling best a straight track was retained and the others were deleted. The measure of  the straightness of a micro-track is the correlation coefﬁcient between the values of the x-axis and the y-axis of the coordinates  of the grains belonging to the micro-track. The correlation coefﬁ- cient can be calculated by the formula (3)
@3
As for the cuts in Eqs. (1) and (2), we chose these numbers as  the cuts according to the distributions of  the  distance  between two consecutive grains and both angular and spatial deviations from a straight line formed by the last considered pair of grains and our experience in recognizing the tracks in nuclear emulsion. These distributions and the numbers as the cuts (the red line) are all shown in the (Fig. 5). More than 98% of the sample lies in the region below the cuts in each distribution.
The micro-tracks in the reference image shown in Fig. 6(a) were constructed by the algorithm of constructing the micro-tracks.  The result shown in Fig. 6(b) indicated that the segments of the tracks were constructed effectively by the algorithm. We chose the micro- track which included the reference grain Pr (xr, yr, zr) as the reference track.
3.2.Elongation of the reference track
The reference track was just a part of the entire proton track,and other micro-tracks belonging to the  same  track  were  in the images which were captured above and below the depth of the reference image. So we controlled the stage to move along the direction of the z-axis with each step 0.3 μm in order to obtain the image at the depth above that of the reference image. The variance count would plus 1 when the stage was moved once along the direction of the z-axis. The grains in the image captured were recognized by the method of recognizing the grains proposed in Ref. [23]. And we constructed the micro-tracks with the recog- nized grains by the algorithm described in Section 3.1.2.
If one of the constructed micro-tracks had a correlation with the reference track, the grains of the micro-track and those of the reference track could compose only a new micro-track by the algorithm in Section 3.1.2. In order to identify whether one micro- track had a correlation with the reference track, the grains belonging to the micro-track and the reference track were merged into a set and stored in descending order by the value of the y-axis.
One grain might be recognized in all the images of  four adjacent depths along the z-axis, because the size of the grain was about 1 μm and the step was 0.3 μm between two adjacent depths. The characteristic of those grains representing the same
grain was that their x-axis values and y-axis values of the coordinates were very close except the z-axis values. So the two grains were considered as one grain, when the coordinates of two grains in the set satisﬁed as
@4
where (xrp, yrp, zrp) represented the coordinate of the pth grain belonging to the reference track, and (xmq, ymq, zmq) represented The grain belonging to the micro-track in the obtained image was deleted from the set and stored in an array Replica. Never- theless, the grain belonging to the reference track was still retained in the set. We used the grains stored in the set to construct the micro-tracks by the method  described  in  Sect-  ion 3.1.2. If only one micro-track was constructed and the number of the grains of this micro-track was more than or equal to that of the reference track, the reference track was updated with this micro-track and the variance count was set to be zero. Otherwise, the reference track and the variance count did not change.
The area of the FOV is too small to observe a long proton track completely in one FOV. So it gradually disappeared from the FOV
when the reference track of the long proton track was elongated  only  with  the  movements  of  the  stage  along  the  direction  of  the z-axis. In order to avoid this situation, we set a rectangle region with a constant size limited by the green lines shown in Fig. 6(b) to identify whether the stage needed to be moved. The criterions of moving the stage were described in Fig. 7.
In Fig. 7, xrmax, xrmin, yrmax,and yrmin represented the  maximum and minimum of the x-axis and the y-axis of the coordinates of the grains in the micro-track in the captured image respectively and xmax, xmin, ymax, and ymin represented the maximum and minimum    of the x-axis and the y-axis of the coordinates of the set rectangle region respectively.
If the stage did not need to be moved along the x-axis or y-axis, we just needed to move the stage along the direction of the z-axis  to continue search the micro-track, which had a correlation with
Fig. 5. The distributions of these cuts; the red lines represent the values we chose as the cuts;(a) the distribution of the distance between two consecutive grains; (b) the distribution of angular deviations from a straight line, unit: radian; (c) the distribution of the spatial deviation from a straight line. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.)
Fig. 6. The result of the construction of the reference track (unit: pixel). (a) The reference image: the blue symbol ‘n’ represented the grain picked out. (b) The micro-tracks constructed: the micro-track consisting of the red empty circle points represented the reference track and the blue ﬁlled circle point represented the grain picked out. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.)
the reference track, in the image of the next depth. But if the stage needed to be moved, the distances of the movements along the x-axis and y-axis were set in order to make sure that an over- lapping region existed between the two images of the two
adjacent FOVs. Unfortunately, there were a large error, which caused the uncertainty of the relative location between adjacent FOVs and might result in the failure of tracing the track, between the real movement distance and the preset displacement of the
stage because of the hysteresis error and vibration of  the  stage [22]. So we obtained the real displacement of the stage by  the image mosaic method proposed in Ref.[22]. The coordinates of the grains in the image were transformed by the real displacement of the stage under the same coordinate frame (that of the ﬁrst FOV). Then the transformed coordinates of the grains were used to construct the micro-tracks and identify whether there was one micro-track which had a correlation with the reference track.
3.4.Reversed trace of the track
If the reference track was still not updated when the stage had been moved 20 times (count 20) along the direction of the z-axis,  we considered that the recognition of the part of the proton track above the depth of the reference image had been completed. We just needed to recognize another part of the proton track to realize the recognition of the entire track. Unfortunately, the hysteresis error and vibration of the stage resulted in the error between the real displacement and the preset distance. Although the error was reduced by the image mosaic method proposed in Ref. [22], it still
Fig. 7. Scheme of the criterion of moving the stage.
existed and would increase with the numbers of movements of the stage. So it was difﬁcult to move the stage back to the starting position accurately with many movements of the stage. In order to reduce the inﬂuence of the hysteresis error and vibration of the stage, we chose the last micro-track which had a correlation with the reference track as the reference track for reversed trace of the track to reduce the numbers of movements of the stage.  The  grains, of which the coordinate values of z-axis were smaller than the depth of the image including the new reference track, in the array Replica were deleted. On the basis of the reference track, the processes presented in Section 3.2 were repeated, except that the stage should be moved along the opposite direction of the z-axis with a step 0.3 μm. If the reference track was still not updated when the stage had been moved 20 times (count ¼ 20) along the opposite direction of the z-axis, we considered that the recogni- tion of the entire proton track was completed. The proton track consisted of the grains in the reference tracks and those in  the array Replica.
4.Results and discussions
A nuclear emulsion plate irradiated by 14.9 MeV neutron beam was used as a test sample for the automated system. We used the automated system to recognize some recoil proton tracks induced by the14.9 MeV neutron beam. Seven proton tracks traced and recorded by this system were shown in Fig. 8. In the duration of tracing the tracks, the operator just needed to pick out one grain as the reference grain, and the proton track recognition system controlled the movements of  the  stage  automatically  without  any interferences of the operator.
Moreover, we roughly compared the speed of recognize the tracks by the manual method with that by the automated tracking method proposed in this paper. It takes about 2–3 h to recognize all the grains of a track consisting of 300–400 grains by the manual method according to the experience of the operator, while the time taken is about 1–1.5 h to construct the same track by the method proposed in the paper.
The efﬁciency of the method is an important parameter for the automated tracking method. So we choose 600 tracks in the nuclear emulsion irradiated by the 14.9 MeV neutron beam as the sample. 531 tracks in the sample were constructed by the method proposed in this paper. Although the result indicates the efﬁciency of the method is not too high, the method can reduce
Fig. 8. Seven proton tracks recognized by the method described in this paper.
the burden of the operator and we will continue to optimize the method to improve the efﬁciency in the future.
The method of tracing proton tracks proposed in this paper can be used not only to the online recognition of the proton tracks, but also to the ofﬂine recognition of the proton tracks in several tomographic sequences of adjacent FOVs. We can pick out a reference grain from one image of the tomography of one  FOV  and construct the reference track by the method described in Section 3.1.  The elongation of  the reference track can be realized by searching for the micro-track, which has a correlation with the reference track, in the image of the depth above that of the image containing the reference grain to update the reference track. When the coordinates of the grains in the micro-track which has a correlation with the reference track are not in the set rectangle region, the images at the depth above that of the image where the micro-track is of the corresponding adjacent FOV chose by the criterion of moving the stage illustrated in Fig. 7 are used to continue the trace of the track. Finally, the reversed trace of the track is not needed, because the stored images are all  static  and  the position of the reference image can be accurately obtained. We just need to recognize another part of the track below the depth of the reference image by the processes mentioned above.
The automated method of tracing proton tacks can realize the automatic recognition of the proton tracks effectively and reduce the burden of the operator seriously. In the entire process of  tracing the proton track, the operator just need to pick out one grain belonging to one proton track, the system can automatically trace the entire the proton track without needing any interference of the operator. The system can do what the operator must to do in the manual recognition method, such as recording the coordinates of the grains belonging to the proton track, moving the stage along the x/y/z-axis and so on. So the speed of collecting data in the nuclear emulsion will be improved. This method will prompt the extensive applications of the nuclear emulsion in experiments of measuring neutron spectrum.
Acknowledgments
The project is supported by the National Natural Science Founda- tion of China (Grant nos. 11175141, 11275154 and 11275153). We thank Prof. Donghai Zhang (Institute of Modern Physics, Shanxi Normal University) for providing and processing the nuclear emulsion in this
study. We also thank the technical staff from the CPNG accelerator in the China Institute of Atomic Energy for supporting the experiment.
