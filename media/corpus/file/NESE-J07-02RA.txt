<title>Analysis of the performances of the CFD schemes used for coupling computation</title>
<author>1,GuangliangChen,2,HongweiJiang,3,HuilunKang,4,RuiMa,5,LeiLi,6,YangYu,7,XiaochangLi</author>
<Affiliation>1,Fundamental Science on Nuclear Safety and Simulation Technology Laboratory, Harbin Engineering University, Harbin, 150001, China;2,China Ship Development and Design Center, Wuhan, 430064, China;3,Nuclear Power Institute of China, Chengdu, 610213, China</Affiliation>
<year>2021</year>
<Jounral>Nuclear Engineering and Technology</Journal>
<Publishing_house>Elsevier</Publishing_house>
<Text_Collector>XiaFan，HEU</Text_Collector>
<DOI>10.1016/j.net.2021.01.006</DOI>
<URL>https://www.sciencedirect.com/science/article/pii/S1738573321000279</URL>
Analysis of the performances of the CFD schemes used for coupling computation
GuangliangChen,HongweiJiang,HuilunKang,RuiMa,LeiLi,YangYu,XiaochangLi
Fundamental Science on Nuclear Safety and Simulation Technology Laboratory, Harbin Engineering University, Harbin, 150001, China
China Ship Development and Design Center, Wuhan, 430064, China
Nuclear Power Institute of China, Chengdu, 610213, China
<Section>Abstract</Section>
In this paper, the coupling of fine-mesh computational fluid dynamics (CFD) thermal-hydraulics (TH) code and neutronics code is achieved using the Ansys Fluent User Defined Function (UDF) for code development, including parallel meshing mapping, data computation, and data transfer. Also, some CFD schemes are designed for mesh mapping and data transfer to guarantee physical conservation in the coupling computation. Because there is no rigorous research that gives robust guidance on the various CFD schemes that must be obtained before the fine-mesh coupling computation, this work presents a quantitative analysis of the CFD meshing and mapping schemes to improve the accuracy of the value and location of key physical prediction. Furthermore, the effect of the sub-pin scale coupling computation is also studied. It is observed that even the pin-resolved coupling computation can also create a large deviation in the maximum value and spatial locations, which also proves the significance of the research on mesh mapping and data transfer for CFD code in a coupling computation.
Keywords:Thermal hydraulics;CFD schemes;PWR
<Section>1. Introduction</Section>
The thermal-hydraulic (TH) status of a typical PWR core should be analyzed with a high-fidelity three-dimensional (3D) model and neutron physical feedback for a deep understanding of the fine TH process and principle. One reason is that there are numerous small & complex structures, such as mixing vane, spring, and dimple on the multi-layers of the spacer grid, which causes a complex 3D flow and heat transfer process in the PWR core. The other reason is that the strong coupling relationship exists between the thermal-hydraulics (TH) and neutronics, because the energy source of TH parameters comes from the neutronics, and the cross-section of neutronics is also affected by the core temperature and density.
Since 1960, after decades of research and development of the computing codes for each physical field of PWR core, the single physical field code, such as the thermal-hydraulics (TH) code or the neutronics code, has witnessed a lot of optimization for the single physical performance of reactor core. Currently, based on the previous decades of research, the coupling simulation of these physics, in particular the high-fidelity coupling simulation [1], has become one key research focus important to safety assessment [2], and to obtain further understanding of the detailed 3D effect in a reactor core.
Pin-resolved simulation for a single field has been the focus of most current researches [3]. As a representative code, subchannel TH code has been widely used in TH analysis [4] and the coupling computation [5]. Furthermore, many researchers now use the subchannel code for the coupling computation with fine-mesh neutronics codes such as the Monte Carlo neutron transport code in CASL program (Daniel et al., 2017). However, the subchannel code cannot be avoided to use the mean value of each TH parameter in every big control body, and it also could not directly monitor the viscous force which is the most important for the movement of coolant [6]. That is, the subchannel code is not fine enough to be coupled with the fine-mesh neutronics code.
In contrast, CFD code is a fine-mesh TH code. It can reflect the detailed flow and heat transfer using the small mesh size in a millimeter-scale or a micro-millimeter scale to realize sub-pin-resolved simulation, and it can properly take into consideration the viscous effect of the fluid using NS equations at 3D coordinates. In recent years, researchers have attempted to use CFD code coupled with fine-mesh neutronics code (such as MOC code) to obtain a better analysis of the status of nuclear reactors [7]. Though the neutronics MOC code utilizes a much coarse mesh than CFD code, its coupling computation still can obtain a sub-pin-resolved analysis. However, it is not possible with the coupling of subchannel code, because its minimal control body is only one fuel cell so that the results are at pin scale.
A literature survey is done to study the coupling computation between TH code and neutronics code. The study yields 71 scientific articles published in the last 5 years (since 2015). It is observed that only one-ninth of these articles carry out the coupling computations between CFD TH code and fine-mesh neutronics code. Also, these research works mainly focus on the introduction of the fine-mesh multi-physics project or the simulation tools [8,9]. Some of the articles are based on the same fine mesh for both physical fields [10], and some research works focus on the numerical coupling schemes using the coarse-mesh CFD [9,11]. However, a detailed analysis of the various CFD schemes, which must be clear before the fine-mesh coupling computation, has not to be discussed and there is no guidance on the coupling effect.
A great computing burden exists in the CFD analysis because of the complex geometry and flow condition in the reactor core [12] which needs a large number of mesh cells. From our previous analysis, it is observed that nearly 70 billion mesh cells are needed for a typical PWR core [13]. This is one reason why few coupling analyses use CFD code. The other reason is that, unlike the one-to-one mesh mapping and data transfer of the coupling codes, the fine-mesh analysis codes of TH and neutronics have different mesh size, mesh arrangement, mesh shape, and mesh cell number, which makes it difficult in the coupling computation.
The fine-mesh coupling analysis is an important approach to understand and improve the 3D complex phenomenon of a reactor. This kind of analysis will be widely done when the CFD computing technology is mature enough for the large domain of reactor core. Although no published research has completed the CFD computation of a whole typical reactor core, new CFD schemes are constantly being developed to resolve the CFD computing burden of the reactor core. As shown in Fig. 1, using the distributed-parallel CFD computation scheme [14], we have carried out a CFD computation using 11.0 billion cells to study a large part (not the whole) of the reactor core.
Fig. 1. The computing challenges on meshing cells and data processing.
Before carrying out the fine coupling computation of the large domain or even for the whole reactor core, understanding the fine-mesh coupling on various CFD schemes (meshing scheme, mapping scheme, and so on) is a valuable technique to improve computation. Moreover, the fine-mesh coupling using the CFD code also needs a guide for current and future engineering applications of fine-mesh coupling computation. To fulfill the objective, this paper carries out the study to analyze the coupling effect caused by various CFD schemes.
<Section>2. The fine-mesh coupling computation</Section>
In this paper, a CFD code ANSYS FLUENT is used for the fine-mesh TH computation, and an in-house developed transport code MOCHA_2D1D is selected for the fine-mesh neutronic computation. MOCHA_2D1D was developed in a cooperative project between Harbin Engineering University and Xi ‘an Jiaotong University. Details of the computational capability and fidelity of MOCHA_2D1D can be found in our previous work [15]. MOCHA_2D1D transforms the three-dimensional non-uniform neutron transport problem into the coupling radial two-dimensional neutronic process and axial one-dimensional neutronic process. By using the integration of the angular discrete transport equation on the axial and radial directions, to obtain the radial two-dimensional and the axial one-dimensional transport equations. The method of characteristics (MOC) is used to calculate the 2D transport equation, and the SN method is used to calculate the 1D transport equations. MOCHA_2D1D solves the 1D equations of all the rods to get axial leakage and provides it to 2D equations. Then it solves the 2D equations to get the radial leakage and provide to 1D equations. If the neutron flux convergence is achieved, then the computation will repeat and start with the solution of the 1D equation.
2.1. Design of mesh mapping
The mesh type, mesh size, mesh number, and mesh arrangement have obvious differences between the fine-mesh CFD code and MOCHA_2D1D code. CFD mesh is much complex, smaller, and it has various mesh types, sizes, arrangements, etc. Therefore, it is difficult to obtain mesh mapping for the coupling computation of these two kinds of codes. However, the mesh mapping is important, as it is the first step for the coupling computation. As shown in Fig. 2, some operating steps are used to obtain mesh mapping, and they are:
1)
The meshing index (Index B_i) is established for each mesh cell of physical field B which is with a larger mesh size;
2)
The meshes of physical field A, which are with smaller mesh sizes, are partitioned by taking the mesh boundary (the black line) of physical field B. Then a series of mesh groups are established for physical field A.
3)
The mesh group index IndexA_i is established for each mesh group of physical field A;
4)
The mapping relationship between the mesh groups of physical field A and the meshes of physical field B is established according to the corresponding relationship of the spatial position.
Fig. 2. Mesh mapping schematic diagram.
Based on the mesh size comparison, it is obvious that the CFD code uses the IndexA, and MOCHA_2D1D code uses the IndexB.
As shown in Fig. 3, the vertical and crosswise mapping is designed for spatial mapping using the above operating steps. In this figure, the typical 2D MOC mesh type also can be seen. In each fuel cell, f1∼f8 stand for the MOC mesh cells for the solid region, and c1∼c8 stand for the MOC mesh cells for the coolant region.
Fig. 3. Mesh mapping between MOCHA_2D1D and CFD.
Because MOCHA_2D1D code has a much bigger mesh size than the CFD code, it is observed that each MOCHA_2D1D mesh cell can match with numerous CFD mesh cells. CFD mesh cells are classified according to the edges of MOCHA_2D1D mesh, and the CFD mesh groups are created. Then one MOCHA_2D1D mesh cell is matched with one CFD mesh group, and one CFD mesh cell is matched with one MOCHA_2D1D mesh cell.
In the coupling computation, CFD mesh groups are indexed based on the mesh indexes of MOCHA_2D1D. As shown in Fig. 4, Z(n) is the vertical index of the mesh cells along the vertical direction, Ln is the line index of the mesh cells on the cross-section, Cn is the column index of the mesh cells on the cross-section, Rn is the ring index of the mesh cells in each fuel cell, and there are 8 indexes for the sectors of each ring index.
Fig. 4. Index of the fluid domains for CFD mesh groups.
2.2. Design of data transfer
A strong coupling effect exists between the thermal-hydraulics and neutronics in nuclear reactors. As shown in Fig. 5, the power calculated by neutronics physics can affect the TH status. Consequently, the temperatures and density, which are the main TH parameters, will affect the cross-section. The status of neutronics physics and power will also be successively affected.
Fig. 5. The data transfer in the coupling computation.
The physical conservation must be retained during the data transfer in the coupling computation. However, numerous CFD mesh cells (one CFD mesh group) are being mapped with one MOCHA_2D1D mesh cell. Also, complex features exist in the CFD meshing schemes and mesh mapping schemes between CFD code and MOCHA_2D1D code. That means the data from the much smaller CFD mesh cells must be pre-operated for each CFD mesh group, then the pre-operated data can be transferred to the relative MOCHA_2D1D cells based on the mesh mapping indexes.
Therefore the weighted-average method of mass and energy transfer is designed as Eq. (1)–(3) for the data transfer. In these equations, , , , and  stand for the volumetric power density (W/m3), coolant density (kg/m3), cell volume (m3), and the product of specific heat (J/(kg•K)) and temperature (K) of each CFD mesh group (or the relative MOCHA_2D1D mesh cell, because they correspond to the same spatial position). Also, Pi, , , and  stand for the volumetric power density (W/m3), coolant density (kg/m3), cell volume (m3), and the product of specific heat (J/(kg•K)) and temperature (K) of each single CFD mesh cell in the relative mesh group which is mapping with the relative MOCHA_2D1D mesh cell. Furthermore, ncell means the number of mesh cells in one mesh group.
Eq.(1) relates to the data transfer from neutronics physics to thermal-hydraulics. It means that the CFD mesh cells which belong to the same CFD mesh group obtain the same power from the MOCHA_2D1D mesh cell which is mapping with this CFD mesh group. Then the energy conservation can be retained.
@(1)
Eq. (2) relates to the data transfer from thermal-hydraulics to neutronics. In Eq. (2), mass conservation and energy conservation are established for the data transfer. Because the size of each CFD mesh group is in millimeter scale, and each CFD mesh group maps with one small MOC cell, the specific heat capacity of this kind of small domain (one CFD mesh group or one MOC cell) is set as constant. Therefore, the specific heat capacity is eliminated in Eq. (2). Then Eq. (3) can be derived.
The meaning of Eq (3) is that the volume-weighted average method should be used for the density transfer from CFD mesh group to MOCHA_2D1D cell, and the mass-weighted average method should be used for temperature transfer from CFD mesh group to MOCHA_2D1D cell. However, in some previous research works, the same weighted average method is used for these two kinds of parameters.
@(2)
@(3)
Because billions of CFD mesh cells are needed for the fine TH analysis of a typical PWR core [6], massively parallel computing resources have to be used. This presents a computational challenge on the conservation of physical parameters during the data transfer under the mapping relationship, because a single CFD mesh group (mapping with a MOC cell) may belong to several parallel computing nodes, as shown in Fig. 6 for instance. The average computing value of the sub-mesh group in any computing node cannot represent the average value of one whole mesh group.
Fig. 6. One mesh group separated into several computing nodes.
Therefore, the usage of parallel computing nodes should be considered and designed for coupling computation. In the computing loop of a CFD computation, each CFD cell should be analyzed and determined for both the mapped MOC cell and the computing node. Then the weighted average computation based on Eq. (4) should be done for parameters transferred from the CFD mesh group to MOCHA_2D1D cell. In Eq. (4), ncpu means the number of the cpu nodes in the parallel computation. Then the conservation of physical parameters under parallel computation can be guaranteed.
@(4)
2.3. Design of the programming approach
The mesh mapping and data transfer are established based on the procedure shown in Fig. 7, and the procedure was programmed with the UDF programming module using C code in ANSYS FLUENT. The main parts of the UDF code contain: 1) the establishment of the CFD mesh groups based on the edges and the indexes of MOCHA_2D1D mesh cells; 2) reading the power data from the output file of MOCHA_2D1D code and sending the power data to the respective CFD mesh groups; 3) volume or mass-weighted average computation of the temperature and density for each CFD mesh group; 4) output of the TH data of each CFD mesh group based on the indexes of MOCHA_2D1D mesh cells.
Fig. 7. Computing flow for the coupling computation.
In the first step of Fig. 7, it should be emphasized that the indexes of the vertical cells, lines, columns, rings, and sectors of MOCHA_2D1D mesh should be properly identified. These indexes will be used for the establishment of the CFD mesh groups. This is because the CFD mesh cells, which are relative to the same location [vertical index, sector index, ring index, line index, column index], should be classified to the same MOCHA_2D1D mesh cell.
During data transfer between MOCHA_2D1D code and CFD code, the coupling code loops through all the CFD mesh cells, and judge the mapping relationship based on the location of each MOCHA_2D1D index. Then the matching relation is established and the data transfer is established.
Furthermore, parallel programming UDF is developed for coupling computation. In UDF code, the parallel computing nodes include three categories: the host node, the zero node, and the common nodes (1∼N-1 nodes) respectively. The host node can only read and write data, while other nodes can perform computation but cannot read and write. The communication between the host node and the common nodes must be through the zero node. According to the characteristics of parallel computing in the UDF of Fluent ANSYS, this paper developed the corresponding parallel processing scheme. As shown in Fig. 8, the relevant steps include: 1) power data of the MOC mesh is transmitted to the host node; 2) the host node transmits power data to the zero node; 3) the zero node transmits power data to 1∼ N-1 nodes; 4) in 0∼ N-1 nodes, the code loop all CFD mesh cells and distribute power data to each CFD cell; 5) in 0∼ N-1 nodes, the code loop all CFD cells, calculates the volume, mass, and energy of CFD mesh group; 6) the 1∼N-1 nodes transmit the volume, mass, energy, and position of the corresponding CFD mesh group to node zero; 7) node zero calculate the volume, mass, and energy of the same CFD mesh group which has been separated into multiple computing nodes, then node zero calculate the average density and temperature of all CFD mesh groups; 8) node zero transmits the average density and temperature to the host node; 9) according to the distribution characteristics of the mesh cells of MOCHA_2D1D, the host node outputs the density and temperature.
Fig. 8. Data processing between parallel nodes.
2.4. Coupling computation
Based on the above coupling method, a coupling example was done using the boundary conditions in Table 1. As shown in Fig. 9, this case is a 5 × 5 rod bundle and the coolant surrounding the bundle. The vertical length of the object is 560 mm. The velocity inlet boundary is obtained from the cross-section which is 10 mm downstream of one AFA2G grid. Therefore, the inlet boundary and the research domain have the lateral velocity which can be seen in Fig. 10, and this kind of lateral velocity can induce the non-uniform lateral flow boundary for heat transfer and neutronics. The introduction of AFA2G grid can be found in our previous work [13].
Table 1. The boundary conditions for the coupling computation.
Fig. 9. The research object for the coupling computation.
Fig. 10. The contour of lateral velocity.
The results of the coupling example can be observed in Fig. 11. In the fine-mesh coupling computation between CFD and MOCHA_2D1D, the sub-pin power distribution is considered for the inner region of each fuel cell, which can replace the cross-section average computation of each fuel pin. This is a foundation of the high-fidelity analysis which needs high spatial resolution. Moreover, Fig. 11 also shows the importance of the high-fidelity coupling analysis which can distinguish the inner region of each fuel pin due to the various lateral TH boundaries.
Fig. 11. The power distribution on different cross-sections (W/m3).
<Section>3. Analysis of the effect of coupling computation</Section>
3.1. Sensitivity analysis and CFD meshing analysis
The effect of the CFD meshing scheme is analyzed in this part. Due to the structural similarity of the fuel cells in the PWR core, a typical fuel cell is used in the research. This case study is taken from Daya Bay nuclear power plant in China, and the lateral structure parameters are shown in Fig. 12 [16]. In this paper, the vertical research length is 560 mm.
Fig. 12. The fuel cell for the research.
To control the error source that does not emanate from the neutronics, the power boundary is derived from the analytic calculation, and the power boundary is designed as in Eq. (5)–(8). The power distributions are shown in Fig. 13 (ãd), which shows various non-uniform power distribution on the cross-section of the fuel pin to test the suitability of the research schemes. Meanwhile, the total power is the same for all the research objects, although their power distribution is different, and the mean power density is 1.6667 × 108 W/m3.
@(5)
@(6)
@(7)
@(8)
Fig. 13. Power distribution and different CFD meshing schemes for the fuel cell.
As shown in Fig.13 (e ∼ g), three kinds of CFD meshing schemes are considered for the cross-section of the fuel pin under each power distribution respectively. The meshing types are: pave type (P) mesh, O block type (O) mesh, and radial type (R) mesh. The sensitivity analysis and validation of the meshing schemes for the coolant domain have been carried out in our previous work [13]. It was observed that the hexahedral prism (used in the coolant domain of this paper) has a perfect effect on the CFD computation of coolant domain. Therefore, this mesh type is used for the coolant domain in this research and the mesh size satisfies the flow status under a mesh-independent analysis presented in our previous work [13]. In this work, the mesh-independent analysis is carried out together with the study on the coupling scheme for the fuel domain, as shown in the following section.
In the boundary setting of CFD computation, the inlet uses the velocity boundary of 2 m/s, and the outlet uses the outflow boundary. The turbulence model RNG k-ε and the standard wall function method are used, and the y+ is kept between 30 and 60. The second-order spatial discretization scheme is applied to pressure, momentum, and turbulence terms. The convergence criteria of each term are set to 1e-6.
Meanwhile, the TH properties are also programmed by UDF function for the fuel region, gas gap, fuel cladding, and coolant. In the UDF code, the density, specific heat, heat conductivity coefficient, and the viscosity coefficient of coolant are all based on IAPWS-IF97. The fuel density is 10431 kg/m3 for the research. The heat conductivity coefficient is computed by Eq. (9), and the specific heat is computed by Eq. (10).
@(9)
@(10)
The gas gap, occupied mainly by helium, is usually assumed at a constant specific heat [17], and its value in this research is 5200 J/kg•K [18]. The heat conductivity coefficient is computed using Eq. (11) [18].
@(11)
The cladding material is Zr-4. Its density is 6570 kg/m3 [19], the heat conductivity coefficient is computed with Eq. (12), and the specific heat is computed with Eq. (13) [13].
@(12)
@(13)
In Eq. (9)∼(13), the units are “°C” for temperature, “W/(m•K)” for heat conductivity coefficient, and “J/(kg•K)” for specific heat, respectively.
The mesh sensitivity analysis and the performance analysis of the meshing schemes are presented in Table 2 and Fig. 14. This enables the discovery of an optimal meshing scheme using the minimal mesh cells for the fine-scale coupling computation. In the analysis, the integral computation of each analytic equation is calculated for the total power source I, then the mean power density I can be obtained. The mean power density is 1.6667 × 108 W/m3. The total power II is computed as the power which is loaded on each CFD mesh cell (the power is based on the location (r, θ) and the analytic equation), then the mean power density II is obtained. The relative errors of these two kinds of power densities are listed in Table 2, for different meshing schemes with various mesh numbers. Furthermore, the CFD results are also analyzed in this research. The mean value and the maximum value of fuel temperature, and the location of the maximum temperature are calculated and listed in Fig. 14.
Table 2. The effect of various meshing schemes on the integrated-average-total power (W/m3).
Fig. 14. The temperature characteristic under the various non-uniform power distribution.
It is observed that the meshing schemes affect the accuracy of energy source in the coupling computation, and the accuracy has a relationship with the meshing type and cell number. Based on these observations, some regularities can be generalized as follows:
1)
According to the shaded area in Table 2, all kinds of meshing type have minor relative errors (better performance) when the cell number is large.
2)
Considering the accuracy from Table 2 (based on the comparison of the red box area) and Fig. 14, the O-type mesh, which uses the minimal cells, is the most effective. That is because O-type mesh is a kind of uniform and regular mesh type at any condition. Though P-type mesh is also uniform, it is not regular at some locations. Also, its quality is not better than O-type when the cell number is not large enough. However, the P-type mesh has better geometric adaptability, and the meshing operation is also easier.
3)
R-type mesh is not uniform, and a lot of smaller cells are located at the fuel center which can cause high skewness, and increase the computing errors and computing time. Moreover, outside the fuel center, the fuel domain has much fewer mesh cells compared to the distribution of P and O-type meshes.
Furthermore, the temperature distributions are significantly different under different power distributions, though the total power is the same for the pin region. That means the sub-pin spatial resolution of power is important for the accuracy of TH status which is the focus of the high-fidelity analysis.
3.2. Effect of the mapping scheme
The mesh mapping between CFD code and MOCHA_2D1D code is another important operation for the coupling computation, and the effect of the mapping scheme is one important research focus of this paper. As shown in Fig. 15 (b) and Fig. 15 (c), one scheme uses only one ring mapping, and the other one uses three-rings mapping to load the power data for the CFD mesh to analyze the performance of coupling computation. The number of rings for the mesh mapping is used to simulate the conditions using different sub-pin meshing schemes of neutronics code.
Fig. 15. The volume power density under different mesh mapping for various power types (W/m3).
In addition, as a comparison, the heat transfer performance of one reference scheme is evaluated. In this reference scheme, CFD standalone calculations are used with the fine-scale energy source as shown in Fig. 15 (a). The energy source is computed by the analytic equation of Eq. (5)–(8). Because the CFD computation depends on the mesh type, various mech types (P/R/O) are evaluated in the CFD computations using the various fine-scale energy sources as shown in Table 3. Meanwhile, the analysis of relative error is computed by the objective mapping scheme and the reference scheme using the same mesh type (P, R, O).
Table 3. The effect of mesh mapping under various power types.
In Fig.15 (b) and Fig.15 (c), the power for each CFD mesh group (which is represented by the indexes (Z, f, R, L, C) in Fig. 4) is computed and loaded by the integral computation of Eq. (5)–(8). That means the total energy is the same for all the 12 research objects of Fig. 15. Then the significance of the sub-pin mapping scheme and coupling computation can be observed in the obvious different distributions shown in Fig. 15. It shows that for the same power of one fuel pin, there will also be many kinds of different power distributions that need to be considered in the sub-pin analysis when different mesh mapping schemes are used.
Furthermore, another characteristic of the sub-pin mapping scheme and coupling computation can be observed in the scenario where Fig. 15 (b&d) and Fig. 15 (b&e) are the same, and Fig. 15 (b&f) and Fig. 15 (b&g) are also the same. Because the fine power distributions of Fig. 15 (a&d) and Fig. 15 (a&d) are significantly different, and the fine power distributions of Fig. 15 (a&f) and Fig. 15 (a&g) are also obviously different, then power distributions based on the mesh mapping should not be the same. That means one ring mapping scheme is not enough for the coupling computation though it is also a sub-pin analysis scheme.
In the CFD computation, considering the first conclusion in section 3.1, all kinds of meshing type have minor relative errors when the cell number is large. To reduce the relative errors from the CFD meshing type, the cell numbers of all mesh types are kept around 1.1 million as shown in the shaded area in Table 2. The detailed cell numbers are listed in Table 3. The TH CFD computing results using the above mesh mapping schemes and the relative errors compared with the reference schemes can be seen in Table 3.
It is observed again that the mapping scheme has an important effect on coupling computation based on the data analyzed in Table 3. Because the one ring mapping has obvious error compared with the three rings mapping no matter which meshing scheme (P/R/O) is used for the CFD code. Meanwhile, the three rings mapping scheme has very small errors compared to the computation using an analytic power source.
Furthermore, another quantitative discovery is that the key TH parameters are significantly different (even getting higher than 100 °C) though the total power is the same for any power distribution. This also proves that selecting an appropriate sub-pin mesh mapping and coupling computation is necessary for the high-fidelity analysis.
To give further evidence, a CFD computation using the uniform power of 1.67 × 108 W/m3 was carried out for the fuel pin. This power level is similar to the power used in the scenario above but at the pin level resolution, not at the sub-pin resolution. As shown in Fig. 16, the maximum and mean fuel temperatures are 811 K and 727 K respectively, and the maximum temperature is always at the fuel center. However, they are 976 K and 761 K under the type I power distribution, 812 K and 710 K under the type II power distribution, 755 K and 711 K under the type III power distribution, and 931 K and 761 K under the type IV power distribution. Furthermore, the maximum temperature is not always in the fuel center. That means the pin-resolved mesh mapping and coupling computation cannot produce highly credible results, and the sub-pin-resolved power distribution can induce a large temperature error (even nearly 200 K) which needs high-resolution analysis such as sub-pin-resolved analysis.
Fig. 16. The temperature characteristic under pin-resolved power source.
<Section>4. Conclusions</Section>
In this paper, we quantitatively analyzed the effect of different mapping and meshing schemes in the coupling of a CFD code (ANSYS FLUENT) and a neutron transport code (MOCHA_2D1D). First, we obtained the fine-mesh coupling computation between CFD code and MOCHA_2D1D code. Then we experimented with different meshing and mapping schemes to obtain the optimal scheme that guarantees the physical conservation and has the required accuracy and efficiency on the coupling performance. In the analysis of the resulting computation, it is observed that a good meshing scheme, such as the O-type meshing scheme, has both accuracy and efficiency advantages for the coupling computation considered. However, to reflect the real physical status for the coupling computation, the fine-mesh sub-pin mesh mapping such as the mapping with no less than three index rings is found to be of critical importance. One observation that needs to be emphasized is that even the pin-resolved mesh mapping and coupling computation cannot produce highly credible results.
Furthermore, the scenario demonstrated along with the principle of the design of the coupling schemes serves as an example for the optimal coupling computation of other fine-mesh, multi-physics codes. This is also applicable in engineering analysis where a general problem of mesh type, size, cell number, and mesh layout selection exists between different physical fields in the coupling computation.
<Section>Declaration of competing interest</Section>
The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.
<Section>Acknowledgments</Section>
This work was supported by the National Natural Science Foundation of China (Project No. 51909045, China); CNNC’s young talents research project (CNNC2019YTEP-HEU01, China); the Fundamental Research Funds for the Central Universities (GK2150260197); National Key Research and Development Program (2018YFB1900302); National Natural Science Foundation of China (Project No. 11805044, China); and Science and Technology on Reactor System Design Technology Laboratory (HT-KFKT-02-2020007, China).
<Section>References</Section>
[1]
Y. Ma, S. Liu, Z. Luo, S. Huang, K. Li, K. Wang, G. Yu, H. Yu
RMC/CTF multiphysics solutions to VERA core physics benchmark problem 9
Ann. Nucl. Energy, 133 (2019), pp. 837-852
ArticleDownload PDFView Record in ScopusGoogle Scholar
[2]
A.M. Ward, M. Wang, M.D. Neumann, M. Memmott, A. Manera, T.J. Downar
Simulated transient behavior of the I2S reactor design
Ann. Nucl. Energy, 145 (2020), p. 105421
ArticleDownload PDFView Record in ScopusGoogle Scholar
[3]
M. Daeubler, A. Ivanov, B.L. Sjenitzer, V. Sanchez, R. Stieglitz, R. Macian-Juan
High-fidelity coupled Monte Carlo neutron transport and thermal-hydraulics simulations using Serpent 2/SUBCHANFLOW
Ann. Nucl. Energy, 83 (2015), pp. 352-375
ArticleDownload PDFView Record in ScopusGoogle Scholar
[4]
J. Wang, W.X. Tian, Y.H. Tian, G.H. Su, S.Z. Qiu
A sub-channel analysis code for advanced lead bismuth fast reactor
Prog. Nucl. Energy, 63 (2013), pp. 34-48
ArticleDownload PDFView Record in ScopusGoogle Scholar
[5]
M. Daeubler, N. Trost, J. Jimenez, V. Sanchez, R. Stieglitz, R. Macian-Juan
Static and transient pin-by-pin simulations of a full PWR core with the extended coupled code system DYNSUB
Ann. Nucl. Energy, 84 (2015), pp. 31-44
ArticleDownload PDFView Record in ScopusGoogle Scholar
[6]
G. Chen, Z. Zhang, Z. Tian, T. Appah, L. Li, X. Dong, P. Hu
Research on the subchannel analysis method via CFD analysis for PWR
Nucl. Sci. Eng., 18 (2017), pp. 270-281
CrossRefView Record in ScopusGoogle Scholar
[7]
J. Ge, D. Zhang, W. Tian, K. Wang, S. Qiu, G.H. Su
Steady and transient solutions of neutronics problems based on finite volume method (FVM) with a CFD code
Prog. Nucl. Energy, 85 (2015), pp. 366-374
ArticleDownload PDFView Record in ScopusGoogle Scholar
[8]
J. Leppänen, V. Hovi, T. Ikonen, J. Kurki, M. Pusa, V. Valtavirta, T. Viitanen
The numerical multi-physics project (NUMPS) at VTT technical research centre of Finland
Ann. Nucl. Energy, 84 (2015), pp. 5-62
Google Scholar
[9]
R. Henry, I. Tiselj, L. Snoj
CFD/Monte-Carlo neutron transport coupling scheme, application to TRIGA reactor
Ann. Nucl. Energy, 110 (2017), pp. 36-47
ArticleDownload PDFView Record in ScopusGoogle Scholar
[10]
V. Vasconcelos, A. Santos, D. Campolina, G. Theler, C. Pereira
Coupled unstructured fine-mesh neutronics and thermal-hydraulics methodology using open software: a proof-of-concept
Ann. Nucl. Energy, 115 (2018), pp. 173-185
ArticleDownload PDFView Record in ScopusGoogle Scholar
[11]
M. Aufiero, M. Fratoni
A new approach to the stabilization and convergence acceleration in coupled Monte Carloe CFD calculations: the Newton method via Monte Carlo perturbation theory
Nucl. Eng. Technol., 49 (2017), pp. 1181-1188
ArticleDownload PDFView Record in ScopusGoogle Scholar
[12]
H. Yu, M. Wang, R. Cai, D. Zhang, W. Tian, S. Qiu, G.H. Su
Development and validation of boron diffusion model in nuclear reactor core subchannel analysis
Ann. Nucl. Energy, 130 (2019), pp. 208-217
ArticleDownload PDFView Record in ScopusGoogle Scholar
[13]
G. Chen, Z. Zhang, Z. Tian, L. Li, X. Dong
Challenge analysis and schemes design for the CFD simulation of PWR
Sci. Technol. Nucl. Install. (2017), pp. 1-15
2017
CrossRefView Record in ScopusGoogle Scholar
[14]
G. Chen, J. Wang, Z. Zhang, Z. Tian, L. Li, H. Kang, Y. Jin
Distributed-parallel CFD computation for all fuel assemblies in PWR core
Ann. Nucl. Energy, 141 (2020), p. 107340
ArticleDownload PDFView Record in ScopusGoogle Scholar
[15]
H. Kang, Z. Tian, L. Li, G. Chen, Y. Jin
Development of a coupled neutronics and thermal hydraulics code with an advanced spatial mapping mode
27th International Conference on Nuclear Engineering (2019)
May 19-24, 2019, Ibaraki, Japan
Google Scholar
[16]
J. Zhu, J. Shan, B. Zhang
Chinese Book of Operation of PWR Nuclear Power Plants
(second ed.), Atomic energy press, Beijing, China (2008), p. 17
View Record in ScopusGoogle Scholar
[17]
Q. Ren, X. Yang, Z. Huang, J. Wang
Thermophysical property of working fluid of high temperature gas-cooled reactor helium gas turbine cycle
Chin. J. Turbine Technol., 48 (2) (2006), pp. 93-94
126
View Record in ScopusGoogle Scholar
[18]
J. Yu, S. Wang, X. Zhang, W. Mao
Numerical simulation on scathe less measurement of helium pressure in fuel rod
Chin. J. Nucl. Sci. Eng., 27 (3) (2007), pp. 193-197
View Record in ScopusGoogle Scholar
[19]
X. Zhang, G. Li, L. Shi
Chinese Book of Thermal Fundamentals
(second ed.), Chinese higher education press, Beijing, China (2006), p. 390
View Record in ScopusGoogle Scholar