<title>Adaptive point kernel dose assessment method for cutting simulation on irregular geometries in nuclear facility decommissioning</title>
<Affiliation>a.Fundamental Science on Nuclear Safety and Simulation Technology Laboratory, Harbin Engineering University, Harbin 150001, China
b.Nuclear Power Plant Development Directorate, Nigeria Atomic Energy Commission, Abuja, Nigeria
c.College of Science, Harbin Engineering University, Harbin 150001, China</Affiliation>
<author>Nan Chaoa, Yong-kuo Liu, Hong Xia, Abiodun Ayodeji, Huan Yang</author>
<year>2017</year>
<Jounral>Radiation Physics and Chemistry</Journal>
<Publishing_house> Elsevier Ltd</Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.radphyschem.2018.04.035</DOI>
<URL>https://doi.org/10.1016/j.radphyschem.2018.04.035</URL>
ABSTRACT
Nuclear decommissioning tasks involve a large number of cutting activities and many irregular objects are produced. The objective of the paper is to propose a ﬂexible dose assessment method for the cutting of con- taminated structures with irregular geometries and radiation source. The method is based on virtual reality technology and Point-Kernel method. The initial geometry is designed with the three-dimensional computer- aided design tools. To simulate a cutting operation on an arbitrary structure, the cutting geometry and the approximate models of the products are built automatically with virtual reality technology. Point kernels are generated within the approximate models, and dose rates are calculated with the Point-Kernel method. In order  to improve the dose calculation eﬃciency while maintaining the accuracy, an adaptive point kernels generation technique that can deal with arbitrary geometries is developed, and the density and distribution of point kernels are adapted to the position of the detecting point. To account for radiation scattering eﬀects, buildup factors are calculated with the Geometric-Progression  formula in the ﬁtting function.  The eﬀectiveness and superiority of  the proposed method were veriﬁed by simulating diﬀerent geometries, and comparing the dose rate results with those derived from VRBM, CIDEC, and MCNP codes.
Keywords:
Dose assessment Cutting geometry Point kernel method Virtual reality
Nuclear facilities decommissioning
1.Introduction
The cutting or demolition works during the nuclear facility de- commissioning is characterized by high radioactivity and high risk. It is essential to perform the dose assessment and safety analysis to occu- pational workers in such radioactive environments before or during the task. However, because of the existence of radioactivity, it is diﬃcult to analyze the working process through practical experiments; especially as the structure and the radiation ﬁeld are frequently changing during cutting operation. To address the issue, researchers such as Mól et al. (2009), Jeong et al. (2014) used virtual reality (VR) technology to aid decommissioning of nuclear facilities, and the VR technique presents a more feasible and safe way to analyze the environment and train workers. In order to perform dose assessment and safety analysis during the cutting works, it is necessary to provide a ﬂexible gamma dose rates calculation method for cutting simulation on irregular geometries and radiation sources to improve the eﬃciency and accuracy of simulations.
The Monte Carlo and the Point-Kernel methods are commonly used for calculating radiation shield eﬀectiveness and dose rates. The Monte Carlo method is a probabilistic method with high-precision but suﬀers from long computing time. The typical program based on the Monte
Carlo method is the Monte Carlo Neutron and Photo Transport Code (MCNP) (Breismeister, 2000). By contrast, the Point-Kernel method is an analytical method with less computing time but lacks rigor. Com- monly used codes based on the Point-Kernel method are the QAD (Cain, 1977), the PUTZ (Ingersoll, 1986), and the Microshield. These codes build the geometric space manually by combining geometry technology and modeling, which makes it diﬃcult and ineﬃcient to describe large- scale complex environments, especially tasks in dynamic environments such as the cutting or demolition in a decommissioned nuclear facility. In order to model the complex geometries eﬃciently, Vela et al. (2006) took advantage of the geometric modeling capabilities of com- puter-aided design (CAD) tools to construct the geometry, and devel- oped a code based on point kernel method. The code is named CIDEC and can assess dose rate in complex geometries. However, the code cannot obtain the details of geometries, such as the volume, and has a
limitation in dealing with the cutting operation.
Caracena et al. (2013) presented an algorithm to calculate gamma dose rates for VR simulation applications in nuclear safeguards and security. The algorithm can cope with both accuracy and time re- quirements by calculating dose rates via a non-regular mesh model. Moreover, to improve the eﬃciency of the Point-Kernel method,
Caracena et al. (2017) developed a KD-tree based method for fast ra- diation source representation. However, geometries are restricted to parallelepipeds. Chao et al. (2018) proposed a VR-based method (VRBM) to assess dose rates on arbitrary geometries and radiation sources, with the capability to obtain the detail information of the objects. However, the proposed method could not handle the cutting operation. In this paper, based on the work of Chao et al. (2018), we intend to integrate the implementation method for the cutting opera- tion with diﬀerent geometries, and present a method to optimize the eﬃciency using the adaptive point kernel dose generation technique.
Many researchers have studied the application of virtual reality in nuclear facilities decommissioning such as the ALARA (as low as rea- sonably achievable) planning tool VISIPLAN (Vermeersch and Bosstraeten, 1998; Vermeersch, 2003), and the three-dimensional si- mulation tool VRdose Planner system (Szőke and Johnsen, 2013; Szőke et al., 2015). These codes were developed based on VR technology, and the dose rates are calculated with the Point-Kernel method, however, the scenarios were simpliﬁed with basic geometries. Park et al. (2007) studied a dismantling digital mock-up system to simulate the decom- missioning processes of nuclear facilities, while the cutting scenario is pre-designed and is unchangeable. In order to overcome this restriction, Kim et al. (2016) and Hyun et al. (2017) simulated the cutting process
spectively for the ﬂexible planning of nuclear facility decommissioning During the decommissioning of nuclear facilities, a large number of cutting activities are performed, which results in a frequent change in the environment and produce many irregular objects. The existing methods mainly combine the basic geometries (such as parallelepiped, cylinder, etc.) to approximate the radiation sources manually. In ad- dition, the model used for the dose assessment is separate from that used for the virtual reality, and the VR models are only used for vi- sualizing  the  simulation  results.  This  approach  is  less  accurate and makes the dose rate assessment ineﬃcient, especially in dynamic en-vironments that involve cutting operations.
Consequently, this paper proposed a ﬂexible gamma dose rate as- sessment method for cutting simulation on irregular geometries based on virtual reality and Point-Kernel method. The VR-based method for cutting (VRBMC) presented in this work is an extension of the VRBM, and it allows for the automatic modeling and dose assessment of complex cutting operation on irregular geometries and radiation sources. The initial geometric model is designed by computer-aided design (CAD) tools, such as 3dMax. After the initial geometric model is loaded, the original radiometric attributes are input. When the cutting procedure is performed, the geometric models of cutting products are generated automatically, and the approximate models used for dose assessment and their radiological attributes are determined auto- matically based on the generated products. Then a set of point kernels are adaptively distributed within the approximate models to improve the time eﬃciency while maintaining the accuracy. Ultimately, the dose rates are calculated with the Point-Kernel method. The method makes it possible to assess dose rates for complex cutting operation on irregular geometries and radiation sources eﬃciently during the nuclear facilities decommissioning.
The paper is organized as follows: Section 2 brieﬂy describes the Point-Kernel method and the VRBM method. Section 3 focuses on the implementation of the proposed method. Section 4 describes the ex- periments and results. Section 5 analyzes the results of experiments. Section 6 presents the concluding remarks.
2.Methods used for dose assessment
The two methods used in this paper are the Point-Kernel method and VRBM method. The following section provides a brief description of the methods.
2.1.Point kernel method
The Point-Kernel method is an approximate but eﬃcient approach for evaluating photon responses in shielding analyses. However, the method lacks rigor, and it has limitations in high precision cases. Nevertheless, the method is still successfully applied in design and safety analysis works. When the method is correctly applied, it can provide fairly good results for gamma radiation (Harima, 1993).
The main idea of Point-Kernel method is that a radiation source can be seen as consisting of a series of discrete elementary cells (point kernels), and the dose rate at the detecting point is composed of the contributions of all point kernels to the detecting point (Prokhorets     et al., 2007). The total dose rate from a point kernel isotropic with energy, E, to the detecting point is given by:
@1
where r is the distance from the point kernel to the detecting point, C is gamma ﬂux density to dose rate conversion factor, S is the strength of the point kernel, B is the buildup factor, which can be obtained from the ANSI/ANS-6.4.3 and the Geometric-Progression formula (ANSI/ANS-6. 4.3, 1991). The mean free paths (mfp), t, between the point kernel and he detecting point can be calculated by the following equation:
@2
where i is the index of the space region, n is the number of regions, μi is the linear attenuation factor for i-th region, and di is the section of the line between the detecting point and the point kernel in the i-th region. Therefore, the total dose rate at the detecting point can be calcu- lated by integration of Eq. (1) over the source volume V and summation
over the energies E of radiation spectrum
@3
2.2.VR-based method (VRBM) for geometric modeling
The geometric modeling of VRBM is shown in Fig. 1. The initial geometries of objects are designed in CAD tools. When geometric models are loaded, the cuboids (voxels) and split faces are used to approximate the object. In the two-dimension mode, it uses a set of segments that are generated by the intersections between the cuboids and the object to approximate the object's contour. For three-dimen- sional cases, these segments will have triangular faces. Ultimately, the geometric model is composed of the internal voxels and the parts of the
Fig. 1. A two-dimensional graph showing the geometric modeling process. The object's contour is shown with blue grid lines. The green, red and yellow areas are outside, inside and in contact with the object respectively. The intersections between the object and rectangles’ border are shown in red circles, and the connections of intersections are shown in red line, which is quite similar to the object's contour. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.).
Fig. 2. The structure of the dose assessment method for cutting on arbitrary  geometries  and gamma radiation sources.
boundary voxels inside the object. Then point kernels are generated by sampling within the approximate model uniformly, and dose rates can be calculated with the Point-Kernel method.
3.Methodology
The structure of dose assessment for cutting simulation on irregular geometries and gamma radiation sources during the decommissioning of nuclear facilities is shown in Fig. 2. First, the initial geometric model is obtained. When a cutting operation is performed, the approximate models of cutting products are built according to the cutting surface, and then the adaptive point kernels are generated to calculate dose rates. When the environment is changed, the above process is repeated to maintain the actual geometries.
3.1.Geometric modeling for cutting operation
Geometric modeling of objects is an integral part of dose assess- ment. The initial geometries of objects are designed in CAD tools, and the surface of the object is composed of triangular faces. When geo- metric models are loaded, the initial materials and radiological attri- butes are input. After the cutting procedure is performed, the shape, volume etc., of the object is changed, so cutting products are identiﬁed ﬁrst. The geometric modeling method of cutting product consists of the following stages: (A) Surface division and (B) Cutting proﬁle genera- tion.
3.1.1.Surface division
When the cutting operation is performed, the object's surface is divided into two parts by the cutting surface. Since the object's surface is made up of triangular faces, the surface of the cutting products can be obtained with the help of these triangular faces. The method of surface division is shown in Fig. 3.
In Fig. 3(a), the cutting surface intersects ΔABC at the point, D, and, E, and the line segment, DE, can be approximated as a partial cutting contour, and ΔABC is divided into two parts by DE. When a quad- rilateral is produced after a triangular face is split, the quadrilateral is
divided into two triangles by adding one edge to satisfy the consistency of the triangle, such as the quadrilateral, BCED, in Fig. 3(b). Therefore, triangles on the object's surface don’t intersect with the cutting surface and  those  generated  by  cutting  can  be  divided  into  two  sets  that correspond to the sides of the cutting surface, and the surfaces of cut- ting products can consist of these two triangle sets and the cutting proﬁle.
The method used to determine which side of the cutting surface should have a triangle is presented in Fig. 3(c). The cutting surface can be approximated by a series of rectangular faces. We opined that the positive normal of each rectangular face satisﬁes the right-hand rule along the cutting trajectory around the rectangle. First, a triangular face of the object is selected, and then a line is created by passing through the triangle's center, G, and a point on the cutting surface. The nearest intersection, F, of G and the corresponding rectangular face with the
normal n are selected to judge the relationship between the triangle and the cutting surface as shown in Fig.3(c). If the dot product of vector FG with n is larger than zero, that is, FG   n      0, then the triangular face is
on the upper side of the cutting surface; otherwise, it is on the lower side. Ultimately, the object's surface is divided into two parts, and the triangular faces on each part become the partial surface of the cutting products.
The discussion above is based on the assumption that the cutting surface has two intersections with the edges of the triangular face and each edge has at most on the intersection. However, this assumption is not always satisﬁed, for example in the case of curved cuts. In order to verify the above assumption, two triangular faces split cases are con- sidered as shown in Fig. 4. In one case, the edge of the rectangular face in the cutting surface passes through a point inside the triangular face as shown in Fig. 4(a), and then the point is chosen as the common vertex to divide the original triangle into three sub-triangles as shown in Fig. 4(b), the above steps are repeated until there is no intersection inside the new sub-triangle as shown in Fig. 4(c). Another case is that the triangle has multiple intersections with the cutting surface on the same edge as shown in Fig. 4(d), and then the vertex, B, of the triangle opposite the edge is chosen as the common vertex, and B is connected with the intersection to divide the original triangle into new sub-tri- angles. The above steps are repeated until each edge of the sub-triangle has at most one intersection with the  cutting  surface  as  shown  in Fig. 4(e). Ultimately, the above assumptions are all satisﬁed.
3.1.2.Cutting proﬁle generation
The intersections between the triangular faces of the object and the cutting surface are obtained during the process of surface division and form a point set denoted as P. The cutting proﬁle can be composed of
Fig. 3. Schematic diagram of the surface division. (a) The points, D, and, E, are the intersections between the cutting surface and the edge AB, and AC. (b) ΔABC is divided into two parts: Part 1 and Part 2, and a new edge, BE, is created to  divide  the  quadrilateral  area,  BCED,  into  ΔBCE  and
ΔBED. (c)  The cutting surface  is composed  of  rectangular
faces, and the triangle shown in red is a face of the object. The blue point, G, is the center of the red triangle. The line, GF, shown in dash intersects the cutting surface at the point, F, and F is the nearest intersection of G, so the
yellow area is the nearest face of G along GF. The  normal of the yellow area is n. If FG n      0, the red triangle is on
upper side of the cutting surface; otherwise, it is on the lower side. (For interpretation of the references to color in Fig. 4. Two-dimensional graph showing the method of triangular faces split. (a) The intersections between ΔABC and the edge of the rectangular  faces  that constituting the cutting surface are shown in red points. (b) ΔABC is divided into three sub-triangles ΔEAB, ΔEBC and ΔECA by taking E as the common vertex. (c) ΔECA is divided into three sub-triangles ΔFAE, ΔFEC and ΔFCA by selecting F as the common vertex. (d) The intersections between the edge, AC, and the cutting surface are shown in red points. (e) ΔABC is divided into three sub-triangles ΔBCE, ΔBED and ΔBDA by choosing B as the common vertex. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.).
Fig. 5. The schematic diagram of proﬁle generation under the ﬂat cutting. (a) The intersections between the cutting surface and the object's triangular faces are        shown in black points. (b) The blue point, A, is the center of ΔEFG. The dash lines with arrows are the rays along the edges of ΔEFG. The edges EF, FG, and GE are inside or on the surface of the object and there are no points in ΔEFG, so A is a starting point inside the object. The non-collision-connection points of A are shown in red, and the others are shown in black. (c) The non-collision-connection points of A constitute a set of non-overlapping triangular faces to make up a partial proﬁle by
taking A as the common vertex. (d) The green points are the center of FH and EJ respectively. The line segment, AI, doesn’t contact with the object, so EJ is an adjacent edge and I is a new starting point, and then E and J are put back to the point set, P. By contract, the dash line segment, AG, contacts with the object, so FH is on the object's surface and can’t be an adjacent edge. (e) A partial proﬁle is generated by taking I as the common vertex, and a new starting point, K, is obtained. (f) The complete proﬁle is obtained. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.).
non-overlapping triangular faces constituted by these intersections. Since the ﬂat cutting is the most basic cutting type, the complex cutting type can be expressed by a combination of ﬂat cutting. Therefore, the following section mainly introduces the method of proﬁle generation under the ﬂat cutting, and the schematic is shown in Fig. 5.
Initially, the point set, P, is unordered, it is necessary to connect the disordered points into triangles that don’t overlap. The main loop of the procedure of the cutting proﬁle generation under ﬂat cutting surface is shown in Fig. 6(b). First, a starting point, A, inside the object is selected on the cutting surface, and then A is used as a common vertex to con- struct a set of non-overlapping triangular faces, so A must be inside the object to avoid creating wrong faces, such as hollow areas in tubes. The procedure for the starting point determination is shown in Fig. 6(a).
Two vertexes, E, and, F, are selected from P randomly, and then two rays are generated in the direction of F and E, respectively, starting from E and F as shown in Fig. 5(b). If one of the rays intersects the object only at E and F, which means the line segment, EF, is inside or on the surface of the object, and then another point, G, is selected from P to
create a triangle ΔEFG. If edges of ΔEFG are all inside or on the surface of the object and there are no points in ΔEFG, that means the center of ΔEFG must be inside the object, so a starting point, A, is generated at the center of ΔEFG as shown in Fig. 5(b), and then the point A is added into a starting point set, PS. Initially, PS is empty.
Secondly,  if  the  PS  isn’t  empty,  a  starting  point,  pstart,  is  selected from PS and taken as the common vertex of a group of non-overlapping triangles  to  generate  a  partial  proﬁle.  It  is  deﬁned  that  if  the  line
Fig. 6. The procedure of the cutting proﬁle generation under the ﬂat cutting.
segment,  PstartB, formed  by  an  intersection,  B, and  pstart  intersects  the object only at B, then B is called the non-collision-connection point of pstart. Therefore, the partial proﬁle around pstart can be generated with the non-collision-connection points of pstart. After that, all non-collision- connection points of pstart are selected and removed from P, and these selected points form a point set, U, as the red points shown in Fig. 5(b). The rule for constructing  triangular faces of the partial proﬁle can be described  as follows:  (1) No overlap between  the triangular  faces. (2) The normal, Vn, of any triangular faces in the partial proﬁle should have Vn ∙n>0 p1 and p2 are two adjacent points in U, and p1 is product of @  and @ , that Vn   @@. The points in
U are sorted around pstart under the above rule and ultimately constitute the partial proﬁle as shown in Fig. 5(c).
After a partial proﬁle is obtained, it is necessary to judge the ad- jacent edges between the partial proﬁles. The method of adjacent edge determination is shown in Fig. 6(c). First, a triangle, ΔAEJ, is selected from the partial proﬁle, where the vertex, A, is the starting point and the midpoint of edge, EJ, is denoted as I. If the line segment, AI, con- tacts with the object's mesh, that means EJ is on the surface of the object and can’t be an adjacent edge; otherwise, EJ is inside the object and is an adjacent edge as shown in Fig. 5(d), so I is a new starting point and put into the starting point set, PS, and then E and J are put back into the point set, P, to be used to connect two partial proﬁles. The above process is repeated until P is empty. Ultimately, the complete cutting proﬁle is obtained as shown in Fig. 5(f).
The curved cutting surface can be represented as a set of the rec-
complished based on the ﬂat cutting method. First, a rectangular face,RF, and the intersections of the cutting contour inside RF are obtained so a partial proﬁle can be formed by these points inside RF using the method of cutting proﬁle generation under the ﬂat cutting, such as the partial proﬁle, IJKFGH, in Fig. 7. The above step is repeated until all the rectangular surfaces are processed, and all the partial proﬁles in each rectangular face form the complete cutting proﬁle. Ultimately, the geometries of the cutting product can be represented by triangular faces and the cutting proﬁle located on both side of the cutting surface.
Fig. 7. Schematic diagram of the cutting proﬁle generation under the curved cutting surface. The yellow area is a rectangular face. The intersections inside the yellow area are shown in black points. The blue point is a starting point. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.).
3.2.Dose calculation
Before calculating the dose rate, the point kernels are required to
represents the cutting product of the radiation source. The environ- ments change frequently due to the cutting operation, so there is a limit to the dose calculation time. In order to reduce the computation time
while  keeping  the  accuracy,  an  adaptive  point  kernel  generation
method for arbitrary geometries was developed based on VRBM as shown in Fig. 8. The method can automatically adjust the distribution density of the point kernels according to the position of the detecting point, so that the radiation source can be better represented by fewer point kernels.
When the geometric models of cutting products are produced, the detail information of these geometries can be obtained with the method of VRBM without considering the speciﬁc shape of the cutting products, and then the approximate models of VRBM are used to generate point kernels.  The  approximate  models  consist  of  boundary  voxels  and  in- ternal voxels, where the internal voxels are regular cuboids and the part of  the  boundary  voxels  inside  the  object  are  irregular  as  shown  in Fig. 8(a). Therefore, the point kernel generation in the boundary voxels and internal voxels respectively are described in the following section. A scale factor a    (0,1) is deﬁned. For a point, E, in space, the dis- tance between E and the detecting point, DP, is denoted as d. A voxel, VE, that contains E with any shape is applied, and the maximum size of VE is denoted as dE. It is deﬁned that when dE is less than or equal to the product of a with d, that is, d   ≤  a × d, the voxel, V  , can be seen as a point. The larger the scale factor, the less the number of point kernels to represent the radiation source, the less the calculating time, and the larger the error introduced. Hence, the scale factor can be selected based on accuracy and time requirements.
The procedure for adaptive point kernel generation in boundary voxels is shown in Fig. 9(a). First, the boundary voxels are scattered by sampling each voxel uniformly, and only the samples that are inside the object are eﬀective and form a point set, Q, so Q can be seen as a dis- crete representation of the irregular overlapping parts between the boundary voxels and the object. Secondly, the nearest point, A, of the
detecting point, DP, is selected from Q, and the distance between A and centered at A with a radius of r = a × d/is generated and divided DP is denoted as d as shown in Fig. 8(a). And then a spherical area, BF,
into eight sections (four sections in two-dimension) in the axial direc-
tion  as  shown  in  Fig.  8(b).  Therefore,  the  maximum  size,  l,  of  each section is equal to the product of the scalar factor, a, with the distance
, that  is, l      a     d, which  means each section  can be seen as  a point.
Therefore, the points within BF are selected and removed from Q, and a point kernel is generated at the center of all points within each section as shown in Fig. 8(c). The process above is repeated until the point set,
Fig. 8. Two-dimensional graph showing the method of adaptive point kernel generation. The scalar factor is a, and the distance between the detecting point to a point in the object is d. (a) The boundary voxels are shown in yellow. The part of the boundary voxels inside the object is scattered by sampling, and the samples are shown in blue points. The nearest point to the detection zone is shown in small red point, A, and the dashed circle is a spherical area in three-dimension. (b) The circle area is divided into four sections, and the maximum size, l, of each section is shown in green dash segment, that is, l      a     d. (c) A point kernel shown in green is generated at the center of the points within each section. (d) The point kernels generated in the boundary voxels. (e) An internal voxel shown in yellow is selected. (f) The selected voxel is divided into two rectangles (cuboids in three-dimension) with the same size. (g) A point kernel is generated at the center of the rectangle when the max size, l, of the rectangle satisﬁes the relationship l      a     d  or l less than or equal to a pre-designed threshold. (h) The point kernels generated in the internal voxels. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.).
Fig. 9. The procedure for the adaptive point kernel generation.
Q, is empty. Ultimately, the irregular part of the boundary voxels inside the object is simpliﬁed as a set of adaptive point kernels as shown in Fig. 8(d). When the radiation source is a surface, the source can be scatted by sampling on the surface, and the adaptive point kernels can be generated in the same way as the boundary voxels.
The procedure for adaptive point kernel generation in internal voxels  is  shown  in  Fig.  9(b).  Since  the  internal  voxels  are  regular  cu- boid,  an  internal  voxel,  q,  with  the  longest  diagonal  length  of  l  is  se- lected ﬁrst. If l is larger than the product of the scalar factor, a, with the l > a × d, which means the voxel, q, cannot been seen as a point, then q plane located at the center of the longest axis and perpendicular to the
longest axis as shown in Fig. 8(f). The new generated cuboids repeat the same process as q until their longest diagonal length, l, satisﬁes the relationship l a  d or less than or equal to a pre-designed threshold, then a point kernel is generated at its center as shown in Fig. 8(g). Si- milarly, the process above is repeated until all internal voxels are processed. Ultimately, the internal voxels are simpliﬁed as a set of adaptive point kernels as shown in Fig. 8(h).
It can be seen from the above process that the farther the area from the detecting point, the more sparsely distributed the point kernels. Taking into account the computational eﬃciency, the kd-tree is used to query the points within the spherical area. The kd-tree is a kind of data structure which can segment k-dimensional data space and can imple- ment the nearest neighbor search quickly and accurately.
In addition, when the approximate model of the cutting product is generated, the volume, Vq, of internal voxels and the volume, Vb, of the overlap between the boundary voxels and object are obtained. Suppose the distribution of radioactive concentrations is homogeneous, and the number of discrete points in boundary voxels is denoted as N, and the volume of the original source is V, then the averaged strength, sk, of the k-th point kernel in boundary voxels can be calculated using Eq. (4)
@4
where S is the strength of the original source, nk is the number of points
that make up the k-th point kernels.
The averaged strength, sq, of the q-th point kernel in internal voxels can be calculated using Eq. (5)
@5
Then Eq. (3) can be written approximately as follows
@6
where rd is the detecting point, n is the number of point kernels, si is the strength of the i-th point kernels, m is the number of energy E of ra- diation spectrum, P(Ej) is the probability that the source emits photons with energy Ej, C is gamma ﬂux density to dose rate conversion factor, B is the buildup factor, t is the mean free paths (mfp) between the point kernel and the detecting point, r is the distance from the point kernel to the detecting point.
4.Experiments and results
In  this  section,  we  present  the  experimental  study  of  the  dose  as- sessment  method  considered.  All  experiments  were  conducted  on  a Windows  operating  system  with  3.3 GHz  processor  and  8 GB  RAM.  In general, when the distance between the detecting point and the radia- tion source is 5 times larger than the maximum size of the source, the error introduced by considering the source as a point is small enough. Therefore, the scalar factor, a, is taken as 1/5 in the experiments, and the results were compared with those derived from VRBM, CIDEC and MCNP code. Unless otherwise stated, the density of point kernels used in VRBM is 1/cm3.
Fig. 10. Basic geometries modeling snapshots. The models are the original object, geometric models of cutting products generated by surface division and cutting proﬁle generation, the approximate models and the uniformly distributed point kernels of VRBM from left to right (from top to bottom in (i), (j)). The boundary voxels are shown in red wireframe, and the surfaces of the approximate models are shown in black. (a), (c), (e), (g) and (i) are ﬂat cutting. (b), (d), (f), (h) and (j) are curved cutting. (For interpretation of the references to color in this ﬁgure legend, the reader is referred to the web version of this article.).
4.1.Basic geometries modeling test
The ﬁrst set of experiments was used to illustrate the geometric modeling capability of the method. Since complex geometries and cutting types can be composed of basic geometries and basic cut types, ﬁve basic geometries were used in combination with ﬂat and curved cutting surface to test the geometric modeling capability of VRBMC. The geometries are semi-sphere, cylinder, tube, U-shaped tube and parallelepiped, where the convex surface, a concave surface, ﬂat surface and their combination were considered.
The modeling snapshots of the cutting product are shown in Fig. 10. It can be seen that the method presented in the paper generated the models of the cutting product successfully, and both of the approximate models and the uniform discrete results reﬂect the cutting boundary, and the combination of the cut products are also consistent with the original models.
To better analyze the accuracy of the obtained cutting products, the dimensions of the ﬁve basic geometries and the modeling results were shown in Table 1. It can be observed that the minimum relative de- viation of the total volume of VRBMC's models to original model is 0.3% for ﬂat cutting in parallelepiped, and the maximum relative de- viation is 1.12% for ﬂat cutting in the tube. Furthermore, most of the relative errors between the volume of the cutting products and the original volume are less than 1.0%, showing a good modeling capability of VRBMC in cutting situations.
4.2.Time eﬃciency of dose rate calculation test
The second sets of experiments aim to demonstrate the time eﬃ- ciency of dose rate calculation from VRBMC's models, especially in comparison with the VRBM's models. The basic geometries of the cu- boid (20 × 20 × 20 cm) and cylinder (radius = 50, height = 100 cm) are used in the test and positioned at the origin of coordinates aligned with the axis in a room ﬁlled with air.
Fig. 11 presents the snapshots of the adaptive point kernels gener- ated by VRBMC for the cylinder source at several detecting positions along x-axis. It can be seen that the density of the point kernel decreases as the distance between the detecting point and the radiation source increases, and so does the number of point kernels. Moreover, inside the source, the point kernels near the detecting point are densely dis- tributed, and the farther away from the detecting point, the more sparsely distributed, illustrating the eﬀectiveness of VRBMC in gen- erating the adaptive point kernels.
To compare the running time of VRBMC and VRBM, three basic cases with diﬀerent levels of complexity were considered in the ex- periment. First, we considered Cs137 source with energy 0.662 MeV. Secondly, Cs137 and Co60 sources with energies of 0.662, 1.17 and
1.33 MeV respectively are considered. The third is also the Cs137 and Co60, this time with the water shield (2 cm thick) placed in the x-axes,  2 cm away from the source surface. Table 2 shows the results of the point kernels’ number and running time of both methods averaged over 500 runs. It can be observed that only in the case of the cuboid source of Cs137 with the detecting point of (15,0,0) is the calculation time of VRBMC higher than that of VRBM. This phenomenon is because when the detecting point too close to the radiation source, VRBMC spends more time in generating point kernels than it can save by lowering the point kernels’ number in dose calculation, resulting in a longer com- putation time near the radiation source. However, the results improved as the complexity of the environment increases.
Furthermore, we observed that the number of point kernels de- creases rapidly with the increase in the distance between the detecting point and the source, so does the calculation time that includes the time of point kernels generation and dose calculation. By contrast, the VRBM's model uses a uniform point kernels generation, and once the point kernels are generated, the number is a constant, so in the same case, the diﬀerence between the dose calculation times for diﬀerent detecting point is not signiﬁcant. Moreover, under the same case and detecting point, most of the calculation time of VRBMC is less than that
Table 1
Dimensions and modeling results of basic shapes in cutting situations.
Fig. 11. Snapshots of the adaptive point kernel distribution with diﬀerent detecting points on the right.
of VRBM, the time radio of VRBMC to VRBM can reach 0.5%, proving a better time performance of VRBMC.
To better appreciate the trends of time results, the running time ratio of VRBMC to VRBM versus the distance to the center of the cuboid and cylinder source is shown in Fig. 12. It can be seen that within a certain distance from the radiation source, the time ratio of VRBMC to VRBM decreases with the increase in the distance between the detecting point and the source in a power function manner. Ultimately, the ratio converges to a constant value. The reason for the convergence to a constant value is that when the detecting point is far enough, all the
internal voxels that constitute the approximate model of the object don’t need to be subdivided, and each internal voxel generates a point kernel, and all the samples in the boundary voxels form a point kernel. Therefore, if there are N internal voxels, then N + 1 point kernels will be generated eventually, resulting in the time ratio eventually conver- ging to a constant value. In addition, we can see that compared with the way that VRBM generates constant-point-kernels by uniform sampling as shown in Fig. 10, as the environment becomes more and more complicated, the time advantage of VRBMC using adaptive kernels to calculate dose becomes more and more obvious.
Table 2
The number of point kernels and running time results of VRBMC and VRBM averaged over 500 runs.
Fig. 12. The running time ratio of VRBMC to VRBM versus the distance to the center of the cuboid and cylinder source. The dash line is the trend line.
4.3.Accuracy of dose rate calculation test
The third sets of experiments were designed to illustrate the accu- racy of VRBMC compared with VRBM, MCNP and the Point-Kernel code CIDEC. Two basis cases were considered in the experiment, including
(A) No shielding case, (B) shielding case, which was already used as benchmark cases in dose rate experiments in CIDEC (Vela, 2006). The results of MCNP were generated by running the code for two hours, and the number of point kernels for VRBMC and VRBM is the same as that in experiment 4.2.
4.3.1.No shielding case
The basis case is a 20 × 20 × 2 cm cube located in an empty room ﬁlled with air. Two kinds of sources positioned at the origin of co- ordinates aligned with the axis are considered in the experiment. The ﬁrst source is a 137Cs with the activity of 4.353 × 1010 Bq and only the 0.662 MeV emission line of the isotope was considered. The other source is a 60Co with the activity of 4.353 × 1010 Bq and only the energy of 1.17 MeV and 1.33 MeV emission line of the isotope were considered. The source material is water in both cases.
The results from VRBMC, VRBM, CIDEC, and MCNP are shown in Table 3, where the results of VRBMC and VRBM are averaged over 100 times. It can be observed that the maximum relative deviation of VRBMC to the result of VRBM and CIDEC is 0.37% and 0.18%
respectively, and all the deviations are less than 1.0%, proving the accuracy of the VRBMC. Because VRBMC, VRBM, and CIDEC are all based on the Point-Kernel method, they yield almost the same results. Furthermore, compared with MCNP, the maximum relative deviation is 11.61%, and most of the deviations are less than 10.0%.
4.3.2.Shielding case
To further assess the performance of VRBMC in shielding case, a 20
× 20 × 2 cm cubic source positioned at the origin of coordinates aligned with the axis and located in a room ﬁlled with air was used. The source is a 137Cs with the activity of 4.353 × 1010 Bq, and only the 0.662 MeV emission line of the isotope was considered. The source is distributed in the air. Both the thin  layer  (0.2 cm)  and  thick  layer (2.0 cm) were considered in the materials of water and lead. The shielding was placed in the x-axes, 5 cm away from the source surface. Table 4 presents the results of VRBMC, VRBM, CIDEC, and MCNP, and the results of VRBMC and VRBM are averaged over 100 times. It can be seen that the maximum relative deviation of VRBMC to the re- sult of VRBM and CIDEC is 0.53% and 2.28% respectively, and most of the deviations are less than 1.0%. In addition, the maximum relative deviation to MCNP is 12.0%, and most of the deviations are less than 10.0%.  The  results  from  VRBMC  acceptably  ﬁt  with  the  results   of
VRBM, CIDEC, and MCNP.
Table 3
Results from VRBMC, VRBM, CIDEC, and MCNP in no shielding case.
Table 4
Results from VRBMC, VRBM, CIDEC, and MCNP in shielding case.
5.Discussion
In this paper, we demonstrated the use of virtual reality technique for constructing the geometry in the process of cutting tasks to improve the graphical capabilities of dose assessment method during the de- commissioning of nuclear facilities. A ﬂexible dose assessment method for cutting operation was developed in the work. Compared with the existing methods, the advantage of the method is that it can generate the models of the cutting products automatically and in real time without relying on the manually pre-designed cutting models, so the dose assessment is not limited by the pre-designed cutting model li- braries. Moreover, the models used for dose assessment are built based on the VR models, and this capability make the dose assessment process more ﬂexible and eﬃcient. Furthermore, it shows a better performance in the modeling of cutting tasks for irregular geometries and gamma radiation sources, and the modeling process can still be performed without having the full knowledge of the speciﬁc shape of the object. In addition, the method can adaptively generate non-uniformly dis- tributed point kernels for arbitrary radiation sources according to the distance between the detecting point and the radiation source. This capability increases the computational eﬃciency while maintaining the dose calculation accuracy.
However, we can also see that the method presented in this paper is based  on  the  assumption  that  the  distribution  of  radioactive  con-
centrations is homogeneous, while the distribution is often not homo- geneous. Moreover，the number of point kernels is limited by the number of voxels that make up the cutting product. Consequently, our
next research work will focus on taking the non-homogeneous dis- tribution into account, and developing voxels simpliﬁed method to improve the computation accuracy and eﬃciency.
6.Conclusion
In this paper, we have presented a ﬂexible dose assessment method for cutting simulation on irregular geometries and gamma radiation sources during the decommissioning of nuclear facilities. This method, in combination with virtual reality and CAD tools, is called VRBMC, and has the ability to model the cutting products of irregular geometries automatically and in real time, and can generate adaptive point kernels for arbitrary radiation sources to increases the eﬃciency of dose cal- culation while keeping the accuracy.
The geometric modeling results of cutting operations were veriﬁed by simulating basic geometries with ﬂat and curved cutting surface. The simulation results show that the method presented has a superior per- formance in modeling for cutting operations on complex geometries and is more eﬀective and general. Moreover, it can provide detailed information on the irregular objects, such as the volume and contour,
and the relative errors of the modeling volume are all less than 1.0% in the experiments. The time eﬃciency of the method was compared with VRBM, and the results illustrate that within a certain distance, the time ratio of VRBMC to VRBM decreases with the increase in the distance between the detecting point and the source in a power function manner, and ultimately the ratio converges to a constant value. Furthermore, as the environment becomes more complex and the farther the detecting point, the time advantage of VRBMC is more signiﬁcant, and the time radio can reach 0.5%, proving a better time performance of the pre- sented method. Dose calculation results generated with this method were compared with those from VRBM, CIDEC code, MCNP code. The results show good correlations between our VR-based method for cut- ting and the results from VRBM, CIDEC, and MCNP, demonstrating the accuracy of the method. The work makes it possible to perform a ﬂexible and eﬃcient dose assessment in a dynamic environment of cutting operations during the decommissioning of nuclear facilities.
Acknowledgment
This research work was funded by Decommissioning of Nuclear Facilities and Radioactive Waste Management Research, Project sup- ported by the Natural Science Foundation of Heilongjiang Province, China (Grant NO. A2016002 and NO. E2015053), Nuclear Power Institute of China and the Foundation of Science and Technology on Reactor System Design Technology Laboratory (NO.HT-KFKT-14- 2017003), and the project of Research Institute of Nuclear Power Operation (NO.RIN180149-SCCG).
