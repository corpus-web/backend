<title>Characterization of the neutron spectra in three irradiation channels of the JSI TRIGA reactor using the GRUPINT spectrum adjustment code</title>
<Affiliation>1.Joˇzef  Stefan  Institute,  Ljubljana,  Slovenia;2.University of Ljubljana, Faculty of Mathematics and Physics, Ljubljana, Slovenia</Affiliation>
<author>V.  Radulovi´c,1, 2  R.  Ja´cimovi´c,1  A.  Pungerˇciˇc,1, 2  I.  Vavtar,1, 2  L.  Snoj,1, 2  and  A.  Trkov1, 2, </author>
<year>2020</year>
<Jounral>NUCLEAR DATA SHEETS</Journal>
<Publishing_house> Elsevier Inc.</Publishing_house>
<Text_Collector>田苗，BFSU</Text_Collector>
<DOI>10.1016/j.nds.2020.07.003  </DOI>
<URL>https://doi.org/10.1016/j.nds.2020.07.003  </URL>
Reference neutron ﬁelds in irradiation facilities are crucial for experimental research work in nuclear science and technology in general, and at the fundamental level for the measurement of neutron cross sections and validation of evaluated cross-section data. Monte Carlo particle transport techniques in conjunction with state-of-the-art nuclear data libraries are becoming the reference in the broad context of nuclear reactor analysis, and are extensively used for detailed computational characterization of irradiation facilities, including the calculation of neutron spectra. However, adjustment of the neutron spectra based on experimental data is still required.
In this work we present the characterization of the neutron spectra in the three most important irradiation channels of the JSI TRIGA reactor with diﬀerent spectral characteristics, as an important step in developing the experimental capabilities of the reactor for the purpose of nuclear data validation through activation dosimetry measurements. In the ﬁrst part of this work we performed detailed Monte Carlo calculations of the neutron spectra, comparing the results obtained using diﬀerent nuclear data libraries. In the main part of this work we employed the JSI developed GRUPINT spectrum adjustment code for the characterization of the neutron spectra, on the basis of the calculated neutron spectra and measured reaction rate ratios. A comprehensive overview of the methodology employed in the code and its abilities is given.
We observe that a positive compensation of up to 10 % in the thermal part of the spectrum is needed, while no compensation is needed in the epithermal and fast parts. Absolute neutron ﬂux levels were computed from the adjusted neutron spectra and absolute reaction rate measurements, and compared to the results of a previous analysis using only the Monte Carlo calculations. The work presented in this paper represents the basis for future experimental and analytical work, in particular extending the scope of the measured capture and threshold dosimetry nuclear reactions, to support a thorough characterization of the neutron spectra in the irradiation channels of the reactor. This eﬀort will enable the JSI TRIGA reactor to support a broad scope of experiments for fundamental research as well as development or testing activities at the highest level.
I.INTRODUCTION
Accurate knowledge on the neutron spectrum inside ir- radiation locations in nuclear reactors and irradiation fa- cilities based on neutron sources is necessary for the sup- port of experimental campaigns (primarily in research re- actors and neutron sources, in particular for experiments such as integral nuclear cross-section measurements and validation), and neutron ﬂuence determination (primar- ily in nuclear power plants). Moreover, it allows vali- dation of computational methods, in particular Monte Carlo particle transport codes (e.g. MCNP [1], SER- PENT [2] TRIPOLI [3], etc.), which are extensively used for the determination of the experimental conditions in irradiation facilities. Therefore, considerable eﬀort has been dedicated to the development of codes which ad-
just the neutron spectra based on a priori information, to sets of measurements like reaction rates or Bonner
sphere signals. There are numerous adjustment (unfold- ing) codes in existence, mostly based on Least Squares algorithms, e.g. [4], [5], [6]. A good review of the math- ematical methods used in these codes is given in [7]. In the last decade, adjustment codes based on genetic al- gorithms and neural networks have gained considerable popularity ([8], [9], [10], [11]). We identiﬁed three unfold- ing codes based on the parametrization of the neutron spectrum with an analytical function. FRUIT [12] is a code designed to unfold the neutron spectrum from mea- surements with Bonner spheres. The GRUPINT code, developed at the Joˇzef Stefan Institute (JSI) is based on classical dosimetry measurements, but is also applicable for measurements with Bonner spheres [13]. The LSL-M2 code, developed at the the Sandia National Laboratories, is a package of computer programs for the adjustment of neutron spectra in nuclear reactors based on the combi- nation of neutron transport calculations and radiometric or other integral dosimetry measurements and their un- certainties in the form of variances and correlations [14].
The motivation of this paper is to present the GRUPINT spectrum adjustment code and to give a com- prehensive overview of the process of characterization of the neutron spectra in the three most important irradi- ation channels in the JSI TRIGA reactor, the Central Channel (CC), the Pneumatic Tube (PT) and the IC40 irradiation channel.
Section 2 presents Monte Carlo Calculations of the a priori neutron spectra performed with the MCNP code and a detailed computational model of the JSI TRIGA
reactor. We investigated the eﬀect on the neutron spectra using diﬀerent cross-section libraries and thermal scatter- ing laws, including the most recent ENDF/B-VIII.0 nu- clear data library. Section 3 presents the activation mea- surements performed in the irradiation channels, which included the use of cadmium (Cd) ﬁlters. Section 4 de- tails the general features of the code, in particular the
implemented function used to parametrize the neutron spectrum and the code ﬁtting abilities. The process of ﬁtting a typical input neutron spectrum is presented for the spectrum in the Central Channel (CC) of the JSI TRIGA reactor.  The ability of accurate representation   of distortions in the neutron spectra, both between the thermal and epithermal and between the epithermal and fast energy ranges, and the typically encountered struc- ture in the neutron spectra due to resonances in the cross sections of the materials surrounding the irradiation loca- tion, are demonstrated. Section 5 focuses on the results of the characterization of the spectra in three irradia- tion channels of the JSI TRIGA reactor with diﬀerent spectral characteristics, based on measured reaction rate ratios. Absolute neutron ﬂux levels are derived from the adjusted neutron spectra and absolute reaction rate mea- surements. Section 6 presents the main conclusions.
II.MONTE CARLO CALCULATIONS
In the present work we performed detailed Monte Carlo calculations of the neutron spectra in diﬀerent irradiation channels of the JSI TRIGA Mark II research reactor. Calculations were performed with the MCNP code [1] using a detailed computational model of the JSI TRIGA reactor, based on the criticality benchmark experiment performed in 1991 [15] and later included in the Interna- tional Criticality Safety Benchmark Experiment Hand- book, published by the OECD/NEA [16]. Over the last two decades the computational model was updated [17], corrected and further validated against multiple experi- ments using activation foils [18], miniature ﬁssion cham- bers [19] and thermoluminescent detector (TLD) mea- surements [20]. Figure 1 presents a 3D schematic view of the reactor core in the computational model, including the irradiation channels related to this work, a polyethy- lene container (the ”rabbit tube”) used to perform irradi- ations, and a cadmium thermal neutron ﬁlter, also used in the experiments.
Reference neutron spectra for bare irradiations were calculated in the interior volume of the Cd ﬁlters, located inside the polyethylene rabbit tube, modelled in the Cen- tral Channel (CC), the Pneumatic Tube (PT) and the IC40 irradiation channel in the Carousel inside the re- ﬂector. In the calculations, only the Cd ﬁlter geometry was modelled but not the Cd material, corresponding to unperturbed conditions.
The neutron spectra were calculated in a standard 640 energy group structure, which is commonly used in neu- tron dosimetry [26]. The statistical uncertainty in the neutron ﬂux in the individual energy groups was below  2 % in the thermal and fast  peak,  and  below  5  % in the epithermal part of the spectrum. Simulations using the latest ENDF/B-VIII.0 [27] nuclear data library were taken as the reference for further analysis. Figure 2 dis- plays the neutron spectra for all three irradiation chan- nels, normalized to 1 at 1 eV. It can be observed that relative to the CC, neutron thermalization increases in the PT irradiation channel (core periphery) and further in the IC40 irradiation channel (graphite reﬂector).
FIG. 1. Computational model of the JSI TRIGA research reactor created using the MCNP code. Left: reactor core and graphite reﬂector. Right: closeup of the Central Channel, displaying a polyethylene rabbit tube and Cd ﬁlter. Neutron spectra corresponding to bare irradiations were calculated inside the ﬁlter volume, however, the ﬁlter material was not modelled (it consisted of air). The ﬁgures were plotted using the new ADVANTG Radiant software [22].
FIG. 2. Neutron lethargy spectra, normalized to 1 at 1 eV in three diﬀerent irradiation locations in the JSI TRIGA reactor. The bottom graph displays the statistical 1-σ uncertainty in
%.
In the present computational analysis we investigated the eﬀect of diﬀerent nuclear data libraries on the neu- tron  spectra. The  nuclear  data  library  ENDF/B-VIII.0
[27] was taken as the reference. We investigated the rel- ative diﬀerences compared to older libraries:   ENDF/B-
VII.1 [23] and ENDF/B-VI.8 [24]. Figure 3 displays the relative diﬀerences between the spectra calculated using the ENDF/B-VI.8 and ENDF/B-VII.1 libraries and the spectrum calculated with the ENDF/B-VIII.0 library.  We observed that the calculated neutron spectra were generally consistent, with a few discrepancies. A dis- crepancy of -3 % can be observed for the ENDF/B-VII.1 nuclear data library in the fast peak of the neutron spec- trum. This was further investigated by isolating the ther- mal scattering S(α, β), zirconium and oxygen cross sec- tion nuclear data. We can conclude that these three im- portant contributions are not responsible for the observed discrepancy. Spikes of up to 50 % can be observed for ENDF/B-VI.8 nuclear data library in the thermal part
FIG. 3. Relative diﬀerences between neutron spectra cal- culated with the ENDF/B-VII.1 and ENDF/B-VI.8 nuclear data libraries and the neutron spectrum calculated with the reference ENDF/B-VIII.0 nuclear data library in the Cen- tral Channel.  The relative diﬀerences are calculated as r =
(φE8 φEX )/φE8, where E8 represents the ENDF/B-VIII.0 library and EX  the ENDF/B-VII.1 or ENDF/B-VI.8 library.
of the spectrum. With further investigation we deter- mined that this is due to the thermal scattering S(α, β) cross sections. This is mainly due to the way the thermal scattering data were processed into ACE format for this library. The smaller discrepancy of 5 % in the fast peak of the spectrum is due to the zirconium cross sections.
The authors are aware that the ENDF/B-VI.8 nuclear data library could be considered obsolete. However it was included in the comparison due to signiﬁcant changes in the Zr cross sections from ENDF/B-VI.8 to ENDF/B-
VII.0.Namely, diﬀerences of around 600 pcm (parts per 100 000) in keﬀ were observed for the benchmark model of the TRIGA reactor, while there were practically no dif-
ferences in the k∞ of the fuel. Later analyses indicated that the multiplication factor is strongly correlated to the Zr scattering cross section and less to the capture cross section. A comparison of elemental thermal cross sections and resonance integrals indicated that higher elastic scat- tering resonance integral in ENDF/B-VII.1 causes an in- crease in the thermal neutron ﬂux by improving neutron thermalization, leading to higher ﬁssion rates in the ther- mal region, and consequently increasing keﬀ. The eﬀect is stronger in smaller systems with higher leakage, which is the case in TRIGA research reactors, where thermal- ization is most important [25].
III.ACTIVATION MEASUREMENTS
Activation measurements were carried out in the CC and IC40 irradiation channels in the framework of several experiments in the period from 2007 to 2009. Measure- ments in the PT channel were carried out in one extensive measurement campaign in 2011 [28].
In all the campaigns, the measurements were per- formed by irradiation of samples of certiﬁed reference materials in foil form and subsequent measurements us- ing absolutely calibrated high-purity germanium (HPGe) detectors. Bare and Cd-covered irradiations were per- formed to determine Cd-ratios, which were computed from the ﬁtted peak areas in the measured gamma spec- tra, the sample masses and certiﬁed element concentra- tions, and the timing information, using the SPCACT code (author A. Trkov, the code is available on request). The code calculates the combined uncertainties in the activities by propagation of the uncertainties in all the input data: the sample masses, the irradiation, cooling and measurement times, the ﬁtted peak areas and the detection eﬃciency.
In general the main source of uncertainty in the de- termination of reaction rates through gamma spectrome- try measurements is the uncertainty in the detection eﬃ- ciency. In principle, in the determination of Cd ratios, if samples of the same material composition (i.e. obtained from the same batch of certiﬁed reference material) and of similar geometry and mass are irradiated, and the mea- surements are performed at the same geometry, the un- certainty in the detection eﬃciency does not aﬀect the overall uncertainty in the measured ratios, typical uncer- tainties reaching the level of 1 % or lower. However, other sources of uncertainty in the experimental determination of Cd ratios are recognized, i.e. the uncertainties asso- ciated to the cadmium ﬁlter transmission function and uncertainties in the irradiation conditions, which, due to perturbation eﬀects, are not necessarily identical for the samples irradiated bare and inside Cd ﬁlters. A thor- ough evaluation of these uncertainties would require an extensive eﬀort which is outside the scope of the present work.
The uncertainties in all the reaction rate ratios in the present work were computed conservatively, by propagat- ing all the uncertainties in all the input data, including the uncertainties in the detection eﬃciency. Typically the uncertainties in the measured speciﬁc saturation ac-tivities are around 2 % - 3 %, therefore the typical un- certainties in the ratios amount to 3 % - 4 %.
Tables 1, 2 and 3 report the measured reaction rates per target atom, which were used in the neutron spec- trum adjustment procedures with the GRUPINT code.
TABLE 1. Experimental reaction rate ratios - JSI TRIGA CC. ”RCd” denotes cadmium ratios. ”Bare / Bare” indicates that both numerator and denominator reaction rates were measured with no ﬁlter, ”Cd / Cd” indicates that both nu- merator and denominator reaction rates were measured under Cd ﬁlter.IV.THE GRUPINT CODE
The GRUPINT neutron spectrum adjustment code, developed at the JSI, is a complex code package, its pri- mary purpose is the calculation of constants relevant to Neutron Activation Analysis (NAA) from input neutron spectra and cross-section libraries in 640-energy group structure.
TABLE 2. Experimental reaction rate ratios - JSI TRIGA PT. ”RCd” denotes cadmium ratios. ”Bare / Bare” indicates that both numerator and denominator reaction rates were measured with no ﬁlter, ”Cd / Cd” indicates that both nu- merator and denominator reaction rates were measured under Cd ﬁlter.
These constants are as follows:
σ0: cross section value at 0.0253 eV (which corre- sponds to an incident neutron speed of 2200 m/s)
•I: resonance integral
•FCd: cadmium transmission factor
•g: generalized Westcott g-factor
•σth:  thermal spectrum averaged cross section
•σf : ﬁssion spectrum averaged cross section
These capabilities of the GRUPINT code have been exploited in the past in the context of NAA and its k0 standardization [30] [31] for the assessment of capture cross-sections from evaluated nuclear data ﬁles [33]. In a particular study, the Q0 factor of the 27Al(n, γ) reaction
[34]was determined, introducing and taking into account the ﬁssion spectrum contribution to the reaction rate, made possible by speciﬁc capabilities of GRUPINT.
TABLE 3. Experimental reaction rate ratios - JSI TRIGA IC40. ”RCd” denotes cadmium ratios. ”Bare / Bare” indi- cates that both numerator and denominator reaction rates were measured with no ﬁlter, ”Cd / Cd” indicates that both numerator and denominator reaction rates were measured un- der Cd ﬁlter.
The ﬁrst version of the code dates to April 2000. Over time the code has been developed extensively and has become a versatile package which, in addition to its pri- mary purpose, allows the user to parametrize the neutron spectrum with an analytic function, deﬁned by 19 pos- sible parameters (according to the speciﬁc case), ﬁt the analytic function parameters to general input neutron spectra (e.g. obtained by Monte Carlo calculations) by the Least-Squares method, adjust the neutron spectrum parameters in order to best reproduce a set of measured reaction rate ratios (or cadmium ratios), by the Least- Squares method and to generate neutron spectrum co- variance matrices by the Monte Carlo method.
A.Neutron spectrum parametrization
The neutron spectrum is parametrized by an analytic function, deﬁned by 19 possible parameters. The func- tion consists of three terms: the thermal (Ψt), epithermal (Ψe) and fast term (Ψf ). The thermal term Ψt is deﬁned as:
@1
where Ct is a normalization constant, which ensures con- tinuity and k is the Boltzmann constant. The term is a superposition of three Maxwellian distributions, the main Maxwellian around temperature T and two distributions around temperatures T1 and T2, usually of far lesser mag- nitude (controlled by the constants Ct1 and Ct2), which allow for an adequate representation of possible distor- tions in the upper thermal region. The superposition is multiplied by an El term, where l is the thermal slowing- down parameter.
The epithermal term Ψe is deﬁned by three slope pa- rameters, as:
@2
where α0 gives the general deviation of the spectrum from pure 1/E behaviour, the higher order terms multiplied by α1 and α2 account for distortions of the epithermal spectrum.
The fast part can be modelled either by a Watt dis- tribution (with parameters Wa and Wb), multiplied by a slowing-down term or a Maxwellian distribution around the energy Wa, again multiplied by a slowing-down term:
@3
where Cf is a normalization constant which ensures con- tinuity. The complete spectrum is a weighted sum of the three terms:
@4
where the parameters Kt, Ke and Kf are ”overlap” pa- rameters deﬁned as follows:
@5
@6@7
The parameters Et and Ef are the thermal and fast region energy breakpoints, Ot and Of are the thermal and the fast overlap parameters, which determine the fractions of the thermal and fast contributions above Et and below Ef , respectively; these two parameters aﬀect the smoothness of transition between the thermal, the epithermal and the fast portion of the spectrum.
The ﬁtting algorithm in the GRUPINT code is based on a direct search for a minimum of a functional by a systematic variation of parameters, one at a time, one after another. The parameters which can be ﬁtted in the GRUPINT code are:
@
The normalization constants Ct and Cf , which ensure continuity between the diﬀerent energy regions of the spectrum are computed automatically by GRUPINT.
It is worth pointing out that some of the parameters are strongly correlated and should not be used simul- taneously in an automatic adjustment process. They merely oﬀer ﬂexibility to the user to ﬁne-tune the an- alytical function in a variety of situations. For example, parameters Ot and Et both control the strength of the thermal peak, the diﬀerence being that Ot results in a smoother transition. The user has to ﬁx one and ﬁt the other. Similarly, Ef and Of both control the strength of the fast peak.
In a typical spectrum ﬁtting sequence, only a subset of all the parameters is used, which govern the main charac- teristics of the neutron spectrum. In the fast region the parametrization function itself can be selected (either us-
scribe typical reactor spectra are:
•Ot, Et, T for the thermal part
•α0 for the epithermal part
Of , Ef , Wa for the fast part (and Wb if a Watt function is selected instead of a Maxwellian).
The other parameters enable more accurate represen- tation of detailed features or distortions seen in neutron spectra  and  are  typically  activated  later  in  ﬁtting   se-
quences, once a spectrum shape consistent with the a priori information is reached.
B.Fitting the spectrum parameters
This section serves as an illustration of the mean- ing of the parameters of the analytical function used to parametrize the neutron spectrum and to demon- strate the ﬁtting capabilities of GRUPINT. The start- ing point is an input neutron spectrum, typically ob- tained by Monte Carlo calculations (e.g. with the MCNP code). In the present case, the neutron spectrum in the Central Channel (CC) of the JSI TRIGA reactor is con- sidered. Figure 4 displays the input neutron spectrum and four analytically deﬁned neutron spectra, three of which are labelled ”User deﬁned” and consist of a ther- mal Maxwellian at temperature T = 352 K, a pure 1/E epithermal component and a fast Maxwellian at mean en- ergy Wa = 2.2 MeV, the thermal and fast energy break- points being Et = 0.05 eV and Ef = 2 MeV. The spectra are deﬁned with diﬀerent values of the thermal and fast overlap parameters Ot and Of ; all other parameter val- ues are default. The Ot and Of parameters determine the relative magnitudes of the thermal and fast component. Typically the ﬁtting procedure is started with the ther- mal component parameters Ot, T . The spectrum in Fig- ure 4 labelled ”Fit-1” was obtained by ﬁtting these two parameters simultaneously, while leaving all others de- fault. The ﬁtted spectrum describes very well only the
thermal part.
Figure 5 displays the ﬁtting of the epithermal slope pa- rameters. The two spectra labelled ”User deﬁned” have α0 parameters of -0.03 and 0.03 respectively, the remain- ing parameters are the same as in the spectrum labelled ”Fit-1”, also shown in Figure 5. It is important to note that in addition to the slope, varying the α0 parameter aﬀects the strength of the thermal component. Therefore several ﬁtting runs of the thermal and epithermal spec- trum parameters are required to converge to an accurate ﬁt of the spectrum. The spectrum in Figure 5 labelled ”Fit-2” was obtained by ﬁtting the α0 parameter. Over- all this spectrum describes well the thermal part and the epithermal slope. The α1 and α2 parameters are meant for ﬁne-tuning the slope in the epithermal region and in most cases are not required (i.e. they are left default).
Figure 6 displays  the ﬁnal  steps in  the GRUPINT ﬁt-
ting sequence.  As seen previously in Figures 4 and 5  and indicated in Figure 6, there is a distortion in the spectrum between the thermal and epithermal regions (from around 0.1 eV to around 1 eV), which is common. The spectrum labelled ”Fit-3” was obtained by  ﬁtting the parameters Ot, CT1 and CT2 ; the  latter  two  govern the strengths of two additional Maxwellian distributions in the spectrum, at preset temperatures of 700 K and 1000 K. These temperatures can be ﬁtted automatically by  GRUPINT,  however  as  a  general  rule,  if  too many
made in which the main spectrum parameters Ot, α0 and Of and additionally the fast slowing-down parameter m0 are ﬁtted. The ﬁnal result of the analytic function ﬁtting labelled ”Fit-5”.
C.Resonance eﬀects, form function
It is common for neutron spectra to exhibit dips and peaks, usually in the epithermal region, which are due to strong resonances in the cross sections of the materials which surround the irradiation location. An example of this is the clearly visible structure in the calculated neu- tron spectrum in Figure 6, starting from around 1 keV   to around 1 MeV. The irradiation channel in the present case is a dry aluminium tube, surrounded by water and standard TRIGA fuel elements. Figure 7 displays the to- tal cross-sections for the isotopes 27Al and 16O. Strong resonances are clearly seen in both cross section in the 1 keV to 1 MeV energy range.
A form function option is built into GRUPINT to take into account the structure in the spectra. The form function is deﬁned as the ratio of the input spectrum (obtained from Monte Carlo calculations) to the ﬁnal (smooth) ﬁtted spectrum. The energy range in which  the form function takes eﬀect is user-deﬁned, to allow for exclusion of energy regions where there is typically signif- icant noise in the calculated neutron spectra (e.g. the low and high-energy tails of the spectra). After the deﬁnition of the form function, it is applied throughout the subse- quent GRUPINT procedure, where the spectrum param- eters are ﬁtted to measured reaction rate ratios, detailed in the following section. Figure 8 displays the original input spectrum, the ﬁnal ﬁtted spectrum, labelled ”Fit- 5”, and the ﬁnal ﬁtted spectrum with the form function applied, between 0.5 eV and 4 MeV, labelled ”Fit-5, form function applied”.
D.Neutron spectrum adjustment
1. Reaction rate ratios, neutron spectrum ﬁlters
Once the analytic parameter ﬁtting is performed and   a good representation of the input spectrum is obtained, the parameters of the neutron spectrum can be adjusted to best reproduce a set of measured reaction rate ratios. GRUPINT was conceived to perform neutron spectrum adjustment on the basis of measured reaction rate ra- tios. These can be ratios for the same nuclear reaction, measured with and without neutron spectrum ﬁlters:
@8
where A denotes the measured speciﬁc saturation activity
(i.e. the reaction rate),  and typical ﬁlter materials can  be cadmium, boron nitride, boron carbide, gadolinium, etc. Alternatively,  these  can  be ratios  of  reaction  rates
FIG. 6. Illustration of the fast slowing-down parameters.
for diﬀerent nuclear reactions deﬁned as:
@9
where again A denotes the measured speciﬁc saturation activity, and i and j denote two diﬀerent nuclear reac- tions.GRUPINT performs calculations with group-averaged neutron spectra and cross-sections in ﬁne-group struc- ture such as the extended SAND-II group structure with 640 groups. It reads cross section libraries and spectra in ENDF format, which can be generated with nuclear data processing code packages (e.g. NJOY [35] or PREPRO [36]). There are two options in GRUPINT to calculate the activities for samples irradiated using neutron spec- trum ﬁlters. The ﬁrst option consists of applying a lower energy limit to the integral by which the activity is cal- culated:
@10
where Ecutoﬀ is the user-deﬁned energy limit. If this op- tion is employed, the ﬁlter properties are idealized, mean- ing 100 % absorption below Ecutoﬀ and no absorption above Ecutoﬀ. Cadmium, the most widely used neutron spectrum ﬁlter, has a transmission function which closely matches the ideal case; the cutoﬀ energy for cadmium ﬁlter of 1 mm thickness is around 0.55 eV, which is the
FIG. 7. Total cross-sections for 27Al and  16O; data  plotted from the ENDF/B-VII.1 library.
default energy cutoﬀ value in GRUPINT.
The second option is the calculation of the ﬁlter trans- mission function in GRUPINT directly from the cross- section data, assuming exponential attenuation, using the following expression:
@11
where n is the atom/isotope number density of the ﬁlter material, d is the eﬀective ﬁlter thickness and σa(E) and σs(E) are the atom/isotope absorption and scattering cross-sections, respectively, and ξ is the eﬀective scatter- ing fraction. The values n and d and ξ are user input.
The eﬀective ﬁlter thickness is the thickness of material seen by the ”average” neutron traversing the ﬁlter and interacting with the sample within. It is usually larger than the actual ﬁlter wall thickness; this eﬀect is more pronounced for ﬁlters of bulkier dimensions.
The cross sections σa(E) and σs(E) used for the cal- culation of the transmission function T (E) may be either cross sections of one particular isotope or mixture cross sections, in case there are several absorbing isotopes in the ﬁlter material, which is practically always true. The parameter ξ deﬁnes the fraction of the scattering cross section which is used in the calculation of the transmis- sion function: if ξ = 1 then eﬀectively the total cross section is used, if ξ = 0 then only the absorption cross section takes eﬀect. This corresponds to two limiting cases for sample irradiations:  ξ  = 1 corresponds to e.g.  a conﬁguration where a collimated neutron beam is ﬁl- tered by a thin, plate shaped ﬁlter and the samples are irradiated far away from it (where both absorption and scattering ﬁlter oﬀ the neutrons), ξ = 0 corresponds to
e.g. a very thick ﬁlter which completely contains the sam- ple, placed in an isotropic neutron ﬁeld (only absorption eﬀectively ﬁlters oﬀ the neutrons). In real experiments the situation is somewhere in between these two limiting cases.
The parameters d and ξ of a particular spectrum ﬁlter can be ﬁtted manually using GRUPINT by comparison to a Monte Carlo calculation, applying a simple bisection
where x is a vector composed of the reaction rate ra-   tios R and the neutron spectrum φ in 640 energy group structure.
V.CHARACTERIZATION OF THE SPECTRA IN THE JSI TRIGA REACTOR
A.JSI TRIGA reactor
The JSI TRIGA research reactor is used as  a  neu- tron and gamma radiation  source  for  the  irradiation  of samples (biological and geological samples, materials for fusion reactors, semiconductor radiation detectors, dosimeters, etc), development and testing of detectors for neutron instrumentation [38] and other applications [39], testing and validation of nuclear data and computer codes and for education and training [40]. The reactor core is composed of fuel elements, four control rods and 5 irradiation channels. A triangular irradiation channel (TIC) into which larger objects can be irradiated at high neutron ﬂuxes, can be positioned into special triangular cutouts in the top aluminium grid plate. The reactor  core is surrounded by a graphite reﬂector which contains the Carousel, a rotary irradiation device which enables simultaneous irradiation of up to 40 samples.
This section describes the adjustment procedure car- ried out with GRUPINT for three regularly used irra- diation channels in the JSI TRIGA reactor, namely the Central Channel (CC), located in the centre of the reac- tor core, the Pneumatic Tube (PT), located in the outer ring of fuel element positions and the IC40 irradiation position, part of the carousel. Figure 9 displays a pho- tograph of the JSI TRIGA reactor core at full reactor FIG. 8. Illustration of the form function implemented in GRUPINT. The bottom graph displays the ratios of all the plotted functions vs. the function labelled ”Fit-5: Overall - Ot, a0, Of, m0”.
power (250 kW) and a schematic drawing of the core conﬁguration with the irradiation channels indicated.
B.Neutron spectrum adjustment
In the ﬁtting of the neutron spectrum  parameters,  the following Cd-ratios and reaction rate ratios were used:   197Au(n, γ)198Au   RCd,    238U(n, γ)239U   RCd, 238U(n, γ)239U vs. 197Au(n, γ)198Au, 27Al(n, p)27Mg
vs.	197Au(n, γ)198Au  and  27Al(n, α)24Na   vs. 197Au(n, γ)198Au, on account of the  well-known  re- action cross sections. Nuclear data from the latest neutron dosimetry library IRDFF-II [37], released in 2020, were used.
Figures 10, 11 and 12 display the input neutron spectra for the three irradiation channels considered in this work (CC, PT and IC40) obtained from Monte Carlo calcu- lations, the ﬁtted analytic functions, the ﬁtted analytic functions with the form functions applied, to accurately represent the structure in the spectra due to neutron res- onances, the ﬁnal spectra, obtained by ﬁtting the main spectrum parameters to the measured reaction rate ra- tios and Cd-ratios. In order to visualize the diﬀerences  in the spectra (which are often quite small), the bottom part of the ﬁgures displays the ratios of all the displayed spectra vs. the ﬁtted analytic functions.
In all cases the analytic functions with the form func- tion applied describe the input spectra obtained with Monte Carlo calculations very well. The ﬁnal ﬁtted spec- tra were obtained by ﬁtting the main spectrum parame- ters, which govern the strengths of the thermal and fast peaks and the slope in the epithermal region. Addition- ally for the CC the parameter m1, and for the PT the parameter m0, both of which govern the slowing-down of the fast neutrons between the epithermal and fast region, were ﬁtted.
A positive correction in the thermal region is observed in all the adjusted neutron spectra. The magnitude of  the thermal peak is increased by around  10  %  in the CC, 10 % in the PT and 3 % in the IC40.   The spec-     tral shapes in the epithermal and fast energy regions re- main practically unaltered. The goodness-of-ﬁt can be judged on the basis of the relative diﬀerences between the measured and calculated reaction rate ratios, which are written by GRUPINT into a separate output ﬁle. Figures 13, 14 and 15 show the comparison between the
calculated and measured values for the reaction rate ra- tios used in the spectrum adjustment process for the CC, PT and IC40 irradiation channels, respectively. For the adjusted spectra, the best achievable result was in agree- ment within 5 % for the 197Au(n, γ)198Au cadmium ra- tios, the 238U(n, γ)239U cadmium ratios and/or ratios to the 197Au(n, γ)198Au reaction, and agreement generally within 10% for the reaction rate  ratios  27Al(n, p)27Mg and 27Al(n, α)24Na to 197Au(n, γ)198Au.
Diﬀerent nuclear reactions are sensitive to diﬀerent and more or less broad neutron energy ranges; the use of neu- tron ﬁlters, e.g. Cd or boron based ﬁlters enables addi- tional energy selectivity in the induced response. The neutron spectrum adjustment results presented in this work are based on measurements of four nuclear reac- tions (two (n, γ) and two threshold reactions), addition- ally using Cd ﬁlters. In order to comprehensively charac- terize and qualify the neutron spectra in the JSI TRIGA irradiation channels, a more extensive set (typically of the order of 10 or more) of measured dosimetry reac- tions is required to better cover the entire energy range. In our case, additional threshold dosimetry reactions are required in particular.
C.Absolute neutron ﬂux levels
The GRUPINT code package was designed and writ- ten having in mind applications such as the determina- tion and evaluation of nuclear constants and validation of nuclear data. In this context an accurately character- ized neutron spectrum shape is of particular importance, in contrast with accurately known absolute neutron ﬂux levels. These are subject to uncertainties in the reactor power level, due e.g. to uncertainties in the reactor in- strumentation used for the determination of the reactor power level, or to neutron ﬂux (re)distribution eﬀects, which are in turn due to varying control rod positions or fuel burn-up.
However, in order to support the use of the neutron ﬁelds in the JSI TRIGA reactor for general applications,
e.g.material irradiation, neutron detector development and testing, etc., it is useful to provide information on the absolute neutron ﬂux levels, based on experimental measurements. In previous work [17] the neutron ﬂux levels were determined computationally.
FIG. 9. JSI TRIGA reactor core. Left: photograph of the reactor core at full power (250 kW). Right: schematic representation of the core conﬁguration. The irradiation channels characterized in this work are indicated in red.
FIG. 10. Characterization of the neutron spectrum in the CC. Top graph: Spectrum obtained from Monte Carlo simulation (labelled ”MCNP (pointwise)”), ﬁtted analytic function (labelled ”Analytic ﬁt - read in”), ﬁtted analytic function multiplied by the form function (labelled ”Modulated ﬁtting function”) and ﬁnal result of the adjustment procedure (labelled ”Final ﬁtted spectrum”). Bottom graph: ratios of all the spectra vs. the ﬁtted analytic function.
FIG. 11. Characterization of the neutron spectrum in the PT. Top graph: Spectrum obtained from Monte Carlo simulation (labelled ”MCNP (pointwise)”), ﬁtted analytic function (labelled ”Analytic ﬁt - read in”), ﬁtted analytic function multiplied by the form function (labelled ”Modulated ﬁtting function”) and ﬁnal result of the adjustment procedure (labelled ”Final ﬁtted spectrum”). Bottom graph: ratios of all the spectra vs. the ﬁtted analytic function.
FIG. 12. Characterization of the neutron spectrum in the IC40 channel. Top graph: Spectrum obtained from Monte Carlo simulation (labelled ”MCNP (pointwise)”), ﬁtted analytic function (labelled ”Analytic ﬁt - read in”), ﬁtted analytic function multiplied by the form function (labelled ”Modulated ﬁtting function”) and ﬁnal result of the adjustment procedure (labelled ”Final ﬁtted spectrum”). Bottom graph: ratios of all the spectra vs. the ﬁtted analytic function.
FIG. 13. Relative diﬀerences between measured and calcu- lated reaction rate ratios - CC.FIG. 14. Relative diﬀerences between measured and calcu- lated reaction rate ratios - PT.
Table 4 reports the neutron ﬂux levels derived using
1.the result of the spectrum adjustment procedure described in this work, based on measured reaction rate ratios (RCd values and ratios of reaction rates versus the 197Au(n, γ) reaction rate) and
Table 4 reports the total and 3-group neutron ﬂux lev- els, with the following energy boundaries: 0 - 0.625 eV (thermal), 0.625 eV - 100 keV (epithermal) and 100  keV
- 20 MeV (fast). Table  4 also reports the values  from  the previous computational analysis [17]. The quoted uncertainties in the absolute neutron ﬂux levels derived in this work correspond to the experimental uncertain- ties of the absolute 197Au(n, γ) reaction rates used for normalization. The uncertainties in the values obtained computationally are generally aﬀected by statistical com- putational uncertainties (which can be reduced to negli- gible levels), modelling uncertainties and uncertainties in the normalization factor. The uncertainties in the total ﬂux values quoted in our previous computational analysis
[17] correspond to the statistical uncertainties only, the contribution of other sources was not evaluated. Based on subsequent work [18] we ﬁnd that a realistic estimate of the overall uncertainty in the calculated results (in- cluding the normalization to the reactor power level) is  5 %, which is the level we quote in this work.
VI.CONCLUSIONS
2.the average absolute reaction rate for the
197Au(n, γ) reaction.
FIG. 15. Relative diﬀerences between measured and calcu- lated reaction rate ratios - IC40 channel.
In general, despite signiﬁcant improvements in the pre- dictive capabilities of state-of-the-art Monte Carlo parti- cle transport codes used in conjunction with up-to-date nuclear data libraries, neutron spectrum adjustment is still required. This paper presents the GRUPINT neu- tron spectrum adjustment code package, developed at the Joˇzef Stefan Institute in Ljubljana, Slovenia, and demon- strates its abilities for the neutron spectra in three irra- diation channels with diﬀerent spectral characteristics in the JSI TRIGA reactor.
The capabilities of the GRUPINT code enable research in a wide area in nuclear science and technology and en- able users to deﬁne representative analytical descriptions of typical neutron spectra and perform neutron spec- trum ”unfolding” from only a few experimental data- points. GRUPINT is also able to to support neutron spectrum unfolding from measured Bonner sphere sig- nals [13], based on response functions determined before-hand, the latter playing an analogous role to nuclear reac- tion cross-sections in neutron spectrum unfolding based on activation measurements. At a more advanced level, in contrast to neutron spectrum ”unfolding”, GRUPINT is able to support comprehensive characterization of the neutron spectra in irradiation facilities by taking into ac- count detailed features in the neutron spectra (distor- tions between the energy ranges and structure caused by neutron resonances) and accurately describing the eﬀect of neutron ﬁlters which are often used.
GRUPINT also implements automatic calculation of reaction rates (and their ratios) from evaluated nuclear cross-section libraries in ENDF-6 format, and activation constants. These capabilities strongly support nuclear data veriﬁcation and validation activities, which are crit- ical for further improvement of dosimetry nuclear data [26].
The capabilities of GRUPINT applied in conjunction with constant reﬁnements in Monte Carlo particle trans- port models, techniques and underlying nuclear data, as well as carefully controlled experimental measurements in irradiation facilities, will enable the JSI TRIGA reac- tor to support a broad scope of irradiation experiments
for research, development or testing, at the highest level.
VII.ACKNOWLEDGEMENT
The authors would like to acknowledge the assis- tance   provided   by   Gilles   Gr´egoire   (CEA   Cadarache, DEN/DER/SPEx/LDCI) in the collaborative eﬀorts in the experimental campaign conducted in 2011. The au- thors acknowledge the ﬁnancial support from the Slove- nian Research Agency (research core funding No. P2- 0073 - Reactor Physics and P1-0143 - Environmental Sci- ences) and the Metrology Institute of the Republic of Slovenia (MIRS) under contract No. 6401-5/2009/27 for activities and obligations performed as a Designate In- stitute. The authors acknowledge the following projects (BI-FR/CEA/10-12-005, contract no. 1000-10-340005,
Development of an improved database for neutron spec- trum characterisation in irradiation facilities of research reactors and BI-FR/CEA/17-19-005, contract no. 1000- 17-0106, Epithermal neutron ﬂux determination and val- idation of nuclear cross-sections and through activation measurements employing neutron spectrum ﬁlters) that were ﬁnancially supported by the Slovenian Research Agency.
